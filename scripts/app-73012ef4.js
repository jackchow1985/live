"use strict";angular.module("inspinia",["ngAnimate","ngCookies","ngTouch","ngSanitize","ngResource","ui.router","ui.bootstrap","highcharts-ng","ui.select","angular-venn","angularMoment","smart-table"]).config(["$stateProvider","$urlRouterProvider",function(e,t){e.state("login",{"abstract":!0,url:"/login",templateUrl:"components/login/login.html"}).state("index",{"abstract":!0,url:"/index",templateUrl:"components/common/content.html"}).state("index.main",{url:"/main",templateUrl:"app/main/main.html"}).state("index.school",{url:"/school",templateUrl:"components/school/school.html",data:{pageTitle:"School Analytics"}}).state("index.user",{url:"/userScore",templateUrl:"components/user/user_score.html",data:{pageTitle:"User Analytics"}}).state("index.profile",{url:"/profile/:userID/:region/:app",templateUrl:"components/user/user_profile.html",data:{pageTitle:"User Profile"}}).state("index.search",{url:"/profileSearch",templateUrl:"components/user/user_profile.html",data:{pageTitle:"User Profile"}}).state("index.incu",{url:"/incubatee",templateUrl:"components/incu/user_list.html",data:{pageTitle:"User List"}}).state("index.seed",{url:"/seed",templateUrl:"components/seed/user_list.html",data:{pageTitle:"Seed"}}).state("index.cmb",{url:"/cmb",templateUrl:"components/user/cmb_score.html",data:{pageTitle:"cmb"}}).state("index.core",{url:"/core",templateUrl:"components/user/core_user.html",data:{pageTitle:"core"}}).state("index.beta",{url:"/profile/:userID/:region/:app/:beta",templateUrl:"components/user/user_profile.html",data:{pageTitle:"User Profile Beta"}}).state("index.quant",{url:"/quant",templateUrl:"components/school/quant.html",data:{pageTitle:"User Profile Beta"}}),t.otherwise("/index/main")}]).run(["$http","$rootScope",function(e,t){e.get("getSession").success(function(e){var a=e.role;t.roleRegion=e.region,t.roleSchool=e.school,t.userNick=e.nick,a&&(a=a.toString().split(""),t.dashboardShow="1"==a[0]?!0:!1,!t.firstAvailablePage&&t.dashboardShow&&(t.firstAvailablePage="#/index/main"),t.schoolShow="1"==a[1]?!0:!1,!t.firstAvailablePage&&t.schoolShow&&(t.firstAvailablePage="#/index/school"),t.incuShow="1"==a[2]?!0:!1,!t.firstAvailablePage&&t.incuShow&&(t.firstAvailablePage="#/index/incubatee"),t.seedShow="1"==a[3]?!0:!1,!t.firstAvailablePage&&t.seedShow&&(t.firstAvailablePage="#/index/seed"),t.simShow="1"==a[4]?!0:!1,!t.firstAvailablePage&&t.simShow&&(t.firstAvailablePage="#/index/profileSearch"),t.exportShow="1"==a[5]?!0:!1,"#/index/main"==location.hash&&(location.href=t.firstAvailablePage))})}]),angular.module("inspinia").controller("UserScoreCtrl",["$scope","$rootScope","$http",function(e,t,a){function i(){for(var t=0;t<e.userList.length;t++)a.get("getUserInfo?app=FC&db=CN&userID="+e.userList[t].userId).success(function(t){if(t&&t.length>0){var a=t[0];e.usersMap[a.USERID]=a}})}e.changeFt=function(){var t="Top"==e.sortTypeSelected?!0:!1,n="Random"==e.sortTypeSelected?!0:!1;a.get("getUserScoreList?ft="+e.featureSelected+"&desc="+t+(n?"&random=true":"")+"&limit="+e.limitList+"&logincnt="+e.loginCount+"&tradecnt="+e.tradeCount).success(function(t){e.userList=t,i()})},e.limitList=10,e.loginCount=0,e.tradeCount=0,e.features=["fdtScore","riskCtrlScore","riskPrefScore","consistencyScore","activityScore","profitabilityScore","ft_fc_bgl","ft_mdd","ft_avg_max_op","ft_avg_nt_op","ft_std_neg_pnlr","ft_fc_df_qty","ft_fc_avg_dr","ft_avg_max_op","ft_up","ft_fc_bgw","ft_fc_std_op_qty","ft_fc_std_op_dr","ft_login_cnt","ft_trade_cnt"],e.sortTypes=["Top","Tail","Random"],e.usersMap={},e.featureSelected=e.features[0],e.sortTypeSelected=e.sortTypes[0],e.compute=function(){a.get("triggerFeatureJob?action=compute").success(function(e){alert(e)})},e.save=function(){a.get("triggerFeatureJob?action=save").success(function(e){alert(e)})}}]),angular.module("inspinia").controller("UserProfileCtrl",["$scope","$rootScope","$http","$stateParams",function(e,t,a,i){function n(t){console.info(t),e.filteredList=[];for(var a=0;a<e.closedList.length;a++)moment(e.closedList[a].TRADE_DATE).format("YYYY-MM-DD")==t&&e.filteredList.push(e.closedList[a]);e.userClosedList=e.filteredList}function o(t,i){for(var n=0;n<e.closedList.length;n++)a.get("getTradeSide?objId="+e.closedList[n].ObjId+"&app="+t+"&db="+i).success(function(t){t&&(e.sideMap[t.OBJECT_ID]={side:"Buy"==t.SIDE?"Long":"Short",ts:Date.parse(t.CREATED)/6e4})})}e.products=[{name:"FX",id:"1"},{name:"FC",id:"2"},{name:"SC",id:"3"}],e.userClosedList=[],"All"==t.roleRegion?e.regions=[{name:"Global",id:"Global"},{name:"CN",id:"CN"}]:"CN"==t.roleRegion?e.regions=[{name:"CN",id:"CN"}]:"CN"!=t.roleRegion&&(e.regions=[{name:t.roleRegion,id:t.roleRegion}]),e.productSelected=e.products[0],e.regionSelected=e.regions[0],e.closedList=[],e.loadMore=function(){e.userClosedList=e.closedList},e.sideMap={},e.filteredList=[],e.loadData=function(){e.loadProfolioData();var t=i.userID||e.inputUserId,n=i.region||e.regionSelected.name,s=i.app||e.productSelected.name;e.beta=i.beta,e.region=i.region,e.historyFilePath="getClosedTrades?format=csv&userID="+t+"&db="+n+"&app="+s,e.historyFileName=t+".csv",a.get("getClosedTrades?userID="+t+"&db="+n+"&app="+s).success(function(t){for(var a in t)t[a].ObjId=t[a].POSITION_ID.split("_")[0],t[a].CREATED=Date.parse(t[a].CREATED)/6e4;t=t.reverse(),e.closedList=t,e.rankListLoading=!1,e.userClosedList=t.slice(0,5),o(s,n)}),"SEED"!=n&&"INC"!=n&&a.get("getContestByApp?userID="+t+"&db="+n+"&app="+s).success(function(t){e.contestList=t}),a.get("getUserInfo?userID="+t+"&db="+n).success(function(t){e.user=t[0]}),a.get("getUserLastLogin?userID="+t+"&db="+n+"&app="+s).success(function(t){e.userLastLogin=t[0]}),a.get("getUserAccountSetting?userID="+t+"&db="+n+"&app="+s).success(function(t){e.userSetting=t[0]}),a.get("getUserAccDaily?userID="+t+"&db="+n+"&app="+s).success(function(t){var a=[],i=[],n=[],o=[];e.chartConfig.series=[],e.chartValueConfig.series=[],e.chartRankingConfig.series=[];for(var s=0;s<t.length;s++)a.push([Date.parse(t[s].TRADE_DATE),100*(parseFloat(t[s].UNIT_PRICE)-1)]),n.push([Date.parse(t[s].TRADE_DATE),parseFloat(t[s].CASH)]),i.push([Date.parse(t[s].TRADE_DATE),parseFloat(t[s].UNIT_PRICE)*parseFloat(t[s].CASH_DEPOSITED)]),o.push([Date.parse(t[s].TRADE_DATE),parseInt(t[s].Ranking)]);t&&t.length>0&&(e.acc=t[0]),e.chartConfig.series.push({type:"area",name:"ROI",data:a}),e.chartRankingConfig.series.push({type:"line",name:"Ranking",data:o}),e.chartValueConfig.series.push({type:"line",name:"Account Value",data:i},{type:"line",name:"Cach Value",data:n})}),a.get("getDailyLogin?userID="+t+"&db="+n+"&app="+s).success(function(t){var a=[];e.chartLoginConfig.series=[];for(var i=0;i<t.length;i++)a.push([Date.parse(t[i].date),t[i].count]);e.chartLoginConfig.series.push({type:"column",name:"App Open Times",data:a})}),a.get("getDailyTrades?userID="+t+"&db="+n+"&app="+s).success(function(t){var a=[],i=[];e.chartTradesConfig.series=[];for(var n=0;n<t.length;n++)a.push([Date.parse(t[n].trade_date),parseInt(t[n].tradeCount)-parseInt(t[n].fillCount)]),i.push([Date.parse(t[n].trade_date),parseInt(t[n].fillCount)]);e.chartTradesConfig.series.push({name:"New/Cancel",data:a},{name:"Filled",data:i})}),e.chartRadarConfig.series=[],e.chartRadarProfitConfig.series=[],a.get("users/getUserFt?userID="+t).success(function(t){var a=[],i=[];a.push(t.features.ft_avg_ngt_op?{y:t.features.ft_avg_ngt_op.normalized,ori:t.features.ft_avg_ngt_op.original}:0),a.push(t.features.ft_avg_max_op?{y:t.features.ft_avg_max_op.normalized,ori:t.features.ft_avg_max_op.original}:0),a.push(t.features.ft_mdd?{y:t.features.ft_mdd.normalized,ori:t.features.ft_mdd.original}:0),a.push(t.features.ft_std_neg_pnlr?{y:t.features.ft_std_neg_pnlr.normalized,ori:t.features.ft_std_neg_pnlr.original}:0),a.push(t.features.ft_fc_bgl?{y:t.features.ft_fc_bgl.normalized,ori:t.features.ft_fc_bgl.original}:0),e.chartRadarFDTScoreConfig.subtitle={text:"FDT Score: "+t.fdtScore},e.chartRadarConfig.series.push({type:"area",name:"Risk Control Score",data:a,pointPlacement:"on"}),i.push(t.features.ft_fc_bgw?{y:t.features.ft_fc_bgw.normalized,ori:t.features.ft_fc_bgw.original}:0),i.push(t.features.ft_up?{y:t.features.ft_up.normalized,ori:t.features.ft_up.original}:0),i.push(t.features.ft_streak?{y:t.features.ft_streak.normalized,ori:t.features.ft_streak.original}:0),e.chartRadarProfitConfig.subtitle={text:"Profitability Score: "+t.profitScore},e.chartRadarProfitConfig.series.push({type:"area",name:"Profitability Score",data:i,pointPlacement:"on"}),e.chartRadarRiskPreferenceConfig.series=[];var a=[];a.push(t.features.ft_fc_avg_dr?{y:t.features.ft_fc_avg_dr.normalized,ori:t.features.ft_fc_avg_dr.original}:0),a.push(t.features.ft_fc_df_qty?{y:t.features.ft_fc_df_qty.normalized,ori:t.features.ft_fc_df_qty.original}:0),a.push(t.features.ft_avg_max_op_pos?{y:t.features.ft_avg_max_op_pos.normalized,ori:t.features.ft_avg_max_op_pos.original}:0),a.push(t.features.ft_avg_ngt_op_pos?{y:t.features.ft_avg_ngt_op_pos.normalized,ori:t.features.ft_avg_ngt_op_pos.original}:0),e.chartRadarRiskPreferenceConfig.series.push({type:"area",name:"Risk Preference Score",data:a,pointPlacement:"on"}),e.chartRadarFDTScoreConfig.series=[];var a=[];a.push(t.scores.riskCtrl),a.push(t.scores.profitability),a.push(t.scores.consistency),a.push(t.scores.activity),e.chartRadarFDTScoreConfig.subtitle={text:"FDT Score: "+t.scores.fdt},e.chartRadarFDTScoreConfig.series.push({type:"area",name:"FDT Score",data:a,pointPlacement:"on"})}),setTimeout(function(){window.dispatchEvent(new Event("resize"))},100)},e.chartConfig={options:{colors:["#1ab394"],plotOptions:{series:{cursor:"pointer",point:{events:{click:function(e){console.info(e);var t=moment(e.x).format("YYYY-MM-DD");n(t)}}}}},chart:{backgroundColor:"rgba(255, 255, 255, 0.1)",zoomType:"x"},legend:{enabled:!1}},title:{text:"ROI Trend"},xAxis:{type:"datetime",dateTimeLabelFormats:{month:"%b. %e",year:"%b"},title:{text:"Date"}},yAxis:{labels:{enabled:!0},title:{text:null}},tooltip:{headerFormat:"<b>{series.name}</b><br>",pointFormat:"{point.x:%e. %b}: {point.y:.f} users"},plotOptions:{area:{color:"#0038ff",marker:{enabled:null},lineWidth:1,states:{hover:{lineWidth:1}},threshold:null}},credits:{enabled:!1},series:e.chartSeries},e.chartValueConfig={options:{colors:["#1ab394","#f8ac59"],chart:{backgroundColor:"rgba(255, 255, 255, 0.1)",zoomType:"x"},legend:{enabled:!0}},title:{text:"Account & Cash Value Trend"},xAxis:{type:"datetime",dateTimeLabelFormats:{month:"%b. %e",year:"%b"},title:{text:"Date"}},yAxis:{labels:{enabled:!0},title:{text:null}},tooltip:{headerFormat:"<b>{series.name}</b><br>",pointFormat:"{point.x:%e. %b}: {point.y:.f} users"},plotOptions:{area:{color:"#0038ff",marker:{enabled:null},lineWidth:1,states:{hover:{lineWidth:1}},threshold:null}},credits:{enabled:!1},series:e.chartSeries},e.chartLoginConfig={options:{colors:["#1ab394"],chart:{backgroundColor:"rgba(255, 255, 255, 0.1)",zoomType:"x"},legend:{enabled:!1}},title:{text:"Login Activities"},xAxis:{type:"datetime",dateTimeLabelFormats:{month:"%b. %e",year:"%b"},title:{text:"Date"}},yAxis:{labels:{enabled:!0},title:{text:null}},tooltip:{headerFormat:"<b>{series.name}</b><br>",pointFormat:"{point.x:%e. %b}: {point.y:.f} users"},plotOptions:{area:{color:"#0038ff",marker:{enabled:null},lineWidth:1,states:{hover:{lineWidth:1}},threshold:null}},credits:{enabled:!1}},e.chartTradesConfig={options:{colors:["#1ab394","#127E68"],chart:{backgroundColor:"rgba(255, 255, 255, 0.1)",zoomType:"x",type:"column",options3d:{enabled:!0,alpha:0,beta:0,viewDistance:25,depth:40}},plotOptions:{column:{stacking:"normal",depth:10}},tooltip:{headerFormat:"<b>{point.key}</b><br>",pointFormat:'<span style="color:{series.color}">●</span> {series.name}: {point.y} / {point.stackTotal}'}},title:{text:"Daily Trades"},xAxis:{type:"datetime",dateTimeLabelFormats:{month:"%b. %e",year:"%b"},title:{text:"Date"}},yAxis:{title:{text:"Trades"}},tooltip:{headerFormat:"<b>{series.name}</b><br>",pointFormat:"{point.x:%e. %b}: {point.y:.f} users"},legend:{enabled:!0},credits:{enabled:!1}},e.chartRankingConfig={options:{colors:["#1ab394"],chart:{backgroundColor:"rgba(255, 255, 255, 0.1)",zoomType:"x",type:"line"}},title:{text:"Daily Ranking"},xAxis:{type:"datetime",dateTimeLabelFormats:{month:"%b. %e",year:"%b"},title:{text:"Date"}},yAxis:{reversed:!0,title:{text:"Trades"}},tooltip:{headerFormat:"<b>{series.name}</b><br>",pointFormat:"{point.x:%e. %b}: {point.y:.f} users"},legend:{enabled:!0},credits:{enabled:!1}},e.loadProfolioData=function(){var t=i.userID||e.inputUserId,n=i.region||e.regionSelected.name,o=i.app||e.productSelected.name;e.chartPieConfig.series=[],a.get("getUserOpenPositions?userID="+t+"&db="+n+"&app="+o).success(function(t){var a=[];for(var i in t)a.push({name:t[i].SYMBOL,y:Math.abs(t[i].qty),sign:t[i].qty>=0?"":"-"});console.info(a),e.chartPieConfig.series.push({type:"pie",name:"User Profolio",data:a,pointPlacement:"on"})})},e.chartPieConfig={options:{colors:["#1ab394","#90ee7e","#f45b5b","#7798BF","#aaeeee","#ff0066","#eeaaee","#55BF3B","#DF5353","#7798BF","#aaeeee"],chart:{backgroundColor:"rgba(255, 255, 255, 0.1)",style:{fontFamily:"'Unica One', sans-serif"},legend:{enabled:!0},plotBorderColor:"#606063",type:"pie",options3d:{enabled:!0,alpha:45,beta:0}},tooltip:{pointFormat:"Qty: <b>{point.sign}{point.y}</b> <br> {point.percentage:.1f} %"},plotOptions:{pie:{allowPointSelect:!0,cursor:"pointer",depth:35,dataLabels:{enabled:!0,format:"{point.name}"}}},rangeSelector:{buttonTheme:{fill:"white",stroke:"#C0C0C8","stroke-width":1,states:{select:{fill:"#D0D0D8"}}}},scrollbar:{trackBorderColor:"#C0C0C8"}},title:{text:"Portfolio"}},e.chartRadarConfig={options:{colors:["#1ab394"],chart:{backgroundColor:"rgba(255, 255, 255, 0.1)",polar:!0,type:"line"},pane:{size:"80%"},tooltip:{shared:!0,pointFormat:'<span style="color:{series.color}">{series.name}: <b>{point.y:,.0f}</b><br/><span style="color:{series.color}">Origin: <b>{point.ori:,.2f}</b>'}},title:{text:""},pane:{size:"80%"},xAxis:{categories:["Overnight open-position (隔夜仓位控制)","Max open-position (最大仓位控制)","Draw-down (收益回撤控制)","Loss variance (损失波动控制)","Order loss (单笔损失控制)"],tickmarkPlacement:"on",lineWidth:0},yAxis:{gridLineInterpolation:"polygon",lineWidth:0,min:0,max:100},tooltip:{shared:!0,pointFormat:'<span style="color:{series.color}">{series.name}: <b>${point.y:,.0f}</b><br/>'},legend:{align:"right",verticalAlign:"top",y:70,layout:"vertical"}},e.chartRadarRiskPreferenceConfig={options:{colors:["#1ab394"],chart:{backgroundColor:"rgba(255, 255, 255, 0.1)",polar:!0,type:"line"},pane:{size:"80%"},tooltip:{shared:!0,pointFormat:'<span style="color:{series.color}">{series.name}: <b>{point.y:,.0f}</b><br/><span style="color:{series.color}">Origin: <b>{point.ori:,.2f}</b>'}},title:{text:""},pane:{size:"80%"},xAxis:{categories:["Open Position Duration(持仓时间)","Default Qty Ratio(默认交易量比例)","Max Open Position(最大仓位)","Overnight Open Position(隔夜仓位)"],tickmarkPlacement:"on",lineWidth:0},yAxis:{gridLineInterpolation:"polygon",lineWidth:0,min:0,max:100},legend:{align:"right",verticalAlign:"top",y:70,layout:"vertical"}},e.chartRadarProfitConfig={options:{colors:["#1ab394"],chart:{backgroundColor:"rgba(255, 255, 255, 0.1)",polar:!0,type:"line"},pane:{size:"80%"},tooltip:{shared:!0,pointFormat:'<span style="color:{series.color}">{series.name}: <b>{point.y:,.0f}</b><br/><span style="color:{series.color}">Origin: <b>{point.ori:,.2f}</b>'}},title:{text:""},pane:{size:"80%"},xAxis:{categories:["Biggest Win(最大獲利)","ROI(回報率)","Streak(連續盈利天數)"],tickmarkPlacement:"on",lineWidth:0},yAxis:{gridLineInterpolation:"polygon",lineWidth:0,min:0,max:100},legend:{align:"right",verticalAlign:"top",y:70,layout:"vertical"}},e.chartRadarFDTScoreConfig={options:{colors:["#1ab394"],chart:{backgroundColor:"rgba(255, 255, 255, 0.1)",polar:!0,type:"line"},pane:{size:"80%"},tooltip:{shared:!0,pointFormat:'<span style="color:{series.color}">{series.name}: <b>{point.y:,.2f}</b><br/>'}},title:{text:""},pane:{size:"80%"},xAxis:{categories:["Risk Control(风险控制能力 )","Profitability(盈利能力)","Consistency(行为一致性)","Activity(活跃度)"],tickmarkPlacement:"on",lineWidth:0},yAxis:{gridLineInterpolation:"polygon",lineWidth:0,min:0,max:100},legend:{align:"right",verticalAlign:"top",y:70,layout:"vertical"}},i.userID&&(e.loadData(),e.hasUserId=!0)}]),angular.module("inspinia").controller("CoreUserCtrl",["$scope","$rootScope","$http",function(e,t,a){function i(){for(var t=0;t<e.userList.length;t++)a.get("getUserInfo?app="+e.appSelected+"&db="+e.regionSelected+"&userID="+e.userList[t].user_id).success(function(t){if(t&&t.length>0){var a=t[0];e.usersMap[a.USERID]=a}})}var n=[{name:"台灣大學",key:501,region:"TW"},{name:"政治大學",key:502,region:"TW"},{name:"清華大學",key:505,region:"TW"},{name:"中山大學",key:508,region:"TW"},{name:"台灣師範大學",key:506,region:"TW"},{name:"中央大學",key:507,region:"TW"},{name:"交通大學",key:503,region:"TW"},{name:"中興大學",key:520,region:"TW"},{name:"輔仁大學",key:511,region:"TW"},{name:"東吳大學",key:518,region:"TW"},{name:"淡江大學",key:509,region:"TW"},{name:"東海大學",key:514,region:"TW"},{name:"逢甲大學",key:529,region:"TW"},{name:"實踐大學",key:566,region:"TW"},{name:"台北商業大學",key:538,region:"TW"},{name:"中正",key:513,region:"TW"},{name:"暨南大學",key:516,region:"TW"},{name:"銘傳大學",key:517,region:"TW"}],o=[{name:"北京大学",key:82,region:"CN"},{name:"清华大学",key:129,region:"CN"},{name:"人民大学",key:73,region:"CN"},{name:"北京师范大学",key:104,region:"CN"},{name:"北京航空航天大学",key:78,region:"CN"},{name:"对外贸易大学",key:77,region:"CN"},{name:"中央财经大学",key:50,region:"CN"},{name:"南开大学",key:"IN0102",region:"CN"},{name:"上海交通大学",key:"IN0061",region:"CN"},{name:"复旦大学",key:202,region:"CN"},{name:"上海财经大学",key:208,region:"CN"},{name:"南京大学",key:201,region:"CN"},{name:"浙江大学",key:231,region:"CN"},{name:"中山大学",key:205,region:"CN"},{name:"西南财经大学",key:228,region:"CN"},{name:"武汉大学",key:601,region:"CN"}];e.appTypes=["FX","FC","SC"],e.regions=["TW","IN","CN","US","AU","HK","GB","KE","ID","SG","PK","NZ","TR","CO","GR","FR","SE","PT","CZ","JP","CA","RU","MO","NO","IE","MY","BR","ZA","VE","AE","IQ","KZ","NP","UA","HR","GH","NG","AT","VN","EG","MC","IT","BE","KR","AZ","DE","AF","LT","KH","PH","SA","ES","ME","IL","KW","NL","PL","RO","AM","BT","KG","YE","JA","TH","AR","BD","MX","NI","SY","SR","ZW","null","SD","BN","IO","LR"],e.appSelected=e.appTypes[0],e.regionSelected=e.regions[0],e.limitList=20,e.usersMap={},e.active=30,e.setActive=function(t){e.active=t},e.isActive=function(t){return t===e.active},e.changeRegion=function(){"TW"==e.regionSelected?e.schools=n:"CN"==e.regionSelected&&(e.schools=o),e.schools.unshift({name:"All",key:"all",region:"All"}),e.schoolSelected=e.schools[0],e.changeSelect()},e.changeSelect=function(t){t&&(e.active=t),e.userList=[],e.totalUser=0,a.get("getCoreUserBySchool?app="+e.appSelected+"&db="+e.regionSelected+"&school_key="+(e.schoolSelected?e.schoolSelected.key:"all")).success(function(t){var a=[];for(var n in t)t[n].life>=e.active&&a.push(t[n]);e.totalUser=a.length,e.userList=a.slice(0,e.limitList),i()})}}]),angular.module("inspinia").controller("CMBCtrl",["$scope","$rootScope","$http",function(e,t,a){function i(){for(var t=0;t<e.userList.length;t++)a.get("getUserInfo?app=FC&db=CN&userID="+e.userList[t].userId).success(function(t){if(t&&t.length>0){var a=t[0];e.usersMap[a.USERID]=a}})}e.changeFt=function(){var t="Top"==e.sortTypeSelected?!0:!1,n="Random"==e.sortTypeSelected?!0:!1;a.get("getFinlinkList?type="+e.featureSelected.key+"&desc="+t+(n?"&random=true":"")+"&limit="+e.limitList+"&logincnt="+e.loginCount+"&tradecnt="+e.tradeCount+"&unitPrice="+e.unitPrice+"&mdd="+e.mdd).success(function(t){e.userList=t,i()})},e.limitList=10,e.loginCount=0,e.tradeCount=0,e.unitPrice=.95,e.mdd=-.15,e.features=[{key:"banker_trader_steady",name:"稳健交易型"},{key:"banker_trader_active",name:"积极交易型"},{key:"banker_trader_balanced",name:"平衡交易型"},{key:"banker_investor_steady",name:"稳健投资型"},{key:"banker_investor_active",name:"积极投资型"},{key:"banker_investor_balanced",name:"平衡投资型"},{key:"banker_risk_control",name:"风险控制型"},{key:"banker_marketing",name:"市场营销型"}],e.sortTypes=["Top","Tail","Random"],e.usersMap={},e.featureSelected=e.features[0],e.sortTypeSelected=e.sortTypes[0]}]),angular.module("inspinia").controller("TabsDemoCtrl",["$scope","$rootScope","$window",function(e){e.tabs=[{title:"Global",content:"Dynamic content 1"},{title:"China",content:"Dynamic content 2",disabled:!0}],e.click=function(){setTimeout(function(){window.dispatchEvent(new Event("resize"))},100)}}]),angular.module("inspinia").controller("SeedUserListCrol",["$scope","$rootScope","$http","$filter",function(e,t,a,i){e.rowCollection=[],e.historyFilePath="getSeedList?format=csv",e.historyFileName=i("date")(new Date,"yyyy-MM-dd")+"_seed.csv",e.loadSeedData=function(){a.get("getSeedList").success(function(t){e.userList=t}),a.get("getSeedSummary").success(function(t){e.summaryList=t;var a=[];for(var i in t)a.push({name:t[i].SYMBOL,y:t[i].QTY,pnl:t[i].PNL});e.chartPieConfig.series=[{type:"pie",name:"",data:a,pointPlacement:"on"}]}),a.get("getSeedCount").success(function(t){e.summaryObj=t})},e.loadSeedData(),e.chartPieConfig={options:{colors:["#1ab394","#90ee7e","#f45b5b","#7798BF","#aaeeee","#ff0066","#eeaaee","#55BF3B","#DF5353","#7798BF","#aaeeee"],chart:{backgroundColor:"rgba(255, 255, 255, 0.1)",style:{fontFamily:"'Unica One', sans-serif"},legend:{enabled:!0},plotBorderColor:"#606063",type:"pie",options3d:{enabled:!0,alpha:45,beta:0}},tooltip:{pointFormat:"Qty: <b>{point.y}</b> <br> PNL: <b>{point.pnl}</b> <br> {point.percentage:.1f} %"},plotOptions:{pie:{allowPointSelect:!0,cursor:"pointer",depth:35,dataLabels:{enabled:!0,format:"{point.name}"}}},rangeSelector:{buttonTheme:{fill:"white",stroke:"#C0C0C8","stroke-width":1,states:{select:{fill:"#D0D0D8"}}}},scrollbar:{trackBorderColor:"#C0C0C8"}},title:{text:"Symbols"}}}]),angular.module("inspinia").controller("UserRankingCrol",["$scope","$rootScope","$http",function(e,t,a){var i=[{name:"FX",id:"1"},{name:"FC",id:"2"},{name:"SC",id:"3"}],n=[];e.$watch(function(){return t.selectedSchool},function(){t.selectedSchool&&(e.products="CN"==t.regionSelected?i:[i[0]],e.selected=e.products[0],e.loadSchoolData(t.selectedSchool))},!0),e.loadSchoolData=function(i){e.loaded=!1,e.userRankList=[],e.rankListLoading=!0,a.get("getUserRanking?school_key="+i+"&app="+e.selected.name+"&db="+t.regionSelected).success(function(t){n=t,e.rankListLoading=!1,e.userRankList=t.slice(0,10)})},e.loadMore=function(){e.userRankList=n},e.changeProduct=function(){e.loadSchoolData(t.selectedSchool)}}]),angular.module("inspinia").controller("SchoolCtrl",["$scope","$rootScope","$http",function(e,t,a){function i(i){a.get("getSchools?db="+i).success(function(a){for(var n in a)if(a[n].school_name&&(a[n].school_region&&e.regions.indexOf(a[n].school_region)<0&&(t.roleRegion==a[n].school_region||"All"==t.roleRegion||"Overseas"==t.roleRegion&&"CN"!=a[n].school_region)&&e.regions.push(a[n].school_region),o.indexOf(a[n].school_key)<0&&"INOTHER"!=a[n].school_key&&"825"!=a[n].school_key&&"672"!=a[n].school_key)){if("CN"==i&&"CN"!=a[n].school_region)continue;(a[n].school_key==t.roleSchool||"All"==t.roleSchool)&&(e.schoolsList.push(a[n]),o.push(a[n].school_key))}console.info(e.regions)})}function n(){e.totalUser=0,e.monthUserFX=0,e.weekUserFX=0,e.monthUserFC=0,e.weekUserFC=0,e.monthUserSC=0,e.weekUserSC=0,e.school.selected=void 0,e.core30='<i class="fa fa-spinner fa-spin"></i>',e.core60='<i class="fa fa-spinner fa-spin"></i>',e.core90='<i class="fa fa-spinner fa-spin"></i>',e.coreFC30=0,e.coreFX30=0,e.coreSC30=0,e.coreFC60=0,e.coreFX60=0,e.coreSC60=0,e.coreFC90=0,e.coreFX90=0,e.coreSC90=0}e.regions=[],e.schoolsList=[];var o=[];e.schools=[],e.school={},e.compareList=[],i(),i("CN"),e.addSchool=function(){e.school.selected="Please select a school to compare ...",e.isCompard=!0},e.loadSchoolData=function(t){a.get("getSchoolUserGrowth?school_key="+t.school_key+"&db="+t.school_region).success(function(a){e.isCompard||(e.chartConfig.series=[]);for(var i=[],n=0;n<a.length;n++)i.push([Date.parse(a[n].date),a[n].total_user_num]);e.chartConfig.series.push({type:"spline",name:t.school_name,data:i})})},e.onSearch=function(){},e.loadCountData=function(t){n(),a.get("getSchoolUserCountByApp?app=FX&school_key="+t.school_key+"&db="+t.school_region).success(function(t){var a=t;e.totalUser=a.totalUser,e.monthUserFX=a.monthlyActiveUser,e.weekUserFX=a.weeklyActiveUser}),"CN"==t.school_region?(e.isChina=!0,a.get("getSchoolUserCountByApp?app=SC&school_key="+t.school_key+"&db="+t.school_region).success(function(t){var a=t;e.monthUserSC=a.monthlyActiveUser,e.weekUserSC=a.weeklyActiveUser}),a.get("getSchoolUserCountByApp?app=FC&school_key="+t.school_key+"&db="+t.school_region).success(function(t){var a=t;e.totalUser=a.totalUser,e.monthUserFC=a.monthlyActiveUser,e.weekUserFC=a.weeklyActiveUser}),a.get("getCoreUserBySchool?app=FC&school_key="+t.school_key+"&db="+t.school_region).success(function(t){var a=0,i=0,n=0;for(var o in t)t[o].life>30&&a++,t[o].life>60&&i++,t[o].life>90&&n++;e.coreFC30=a,e.coreFC60=i,e.coreFC90=n}),a.get("getCoreUserBySchool?app=FX&school_key="+t.school_key+"&db="+t.school_region).success(function(t){var a=0,i=0,n=0;for(var o in t)t[o].life>30&&a++,t[o].life>60&&i++,t[o].life>90&&n++;e.coreFX30=a,e.coreFX60=i,e.coreFX90=n}),a.get("getCoreUserBySchool?app=SC&school_key="+t.school_key+"&db="+t.school_region).success(function(t){var a=0,i=0,n=0;for(var o in t)t[o].life>30&&a++,t[o].life>60&&i++,t[o].life>90&&n++;e.coreSC30=a,e.coreSC60=i,e.coreSC90=n})):(e.isChina=!1,a.get("getCoreUserBySchool?app=FX&school_key="+t.school_key+"&db="+t.school_region).success(function(t){var a=0,i=0,n=0;for(var o in t)t[o].life>30&&a++,t[o].life>60&&i++,t[o].life>90&&n++;e.core30=a,e.core60=i,e.core90=n}))},e.onSchoolSelect=function(a){e.count_show=!0,e.loadSchoolData(a),e.loadCountData(a),t.selectedSchool=a.school_key},e.onRegionSelect=function(a){if(n(),e.schools=[],t.regionSelected=a,e.school_show=!0,e.schoolsList.length>0){"All"==t.roleSchool&&e.schools.push({school_key:"all",school_name:"All schools"});for(var i in e.schoolsList)e.schoolsList[i].school_region&&e.schoolsList[i].school_region==a&&(e.schools.push(e.schoolsList[i]),e.schools[0].school_region=e.schoolsList[i].school_region)}},e.chartConfig={chart:{backgroundColor:null,zoomType:"x"},title:{text:"User Growth"},xAxis:{type:"datetime",dateTimeLabelFormats:{month:"%b. %e",year:"%b"},title:{text:"Date"}},yAxis:{title:{text:"Users"},min:0},tooltip:{headerFormat:"<b>{series.name}</b><br>",pointFormat:"{point.x:%e. %b}: {point.y:.f} users"},legend:{enabled:!0},plotOptions:{area:{color:"#0038ff",marker:{enabled:null},lineWidth:1,states:{hover:{lineWidth:1}},threshold:null}},credits:{enabled:!1},series:e.chartSeries}}]),angular.module("inspinia").controller("QuantCrol",["$scope","$rootScope","$http",function(e,t,a){e.chartConfig={options:{chart:{backgroundColor:null,zoomType:"x"},title:{text:"User Growth"},xAxis:{type:"datetime",dateTimeLabelFormats:{month:"%b. %e",year:"%b"},title:{text:"Date"}},yAxis:{title:{text:"Users"},min:0},tooltip:{headerFormat:"<b>{series.name}</b><br>",pointFormat:"{point.x:%e. %b}: {point.y:.f} users"}},legend:{enabled:!0},plotOptions:{area:{color:"#0038ff",marker:{enabled:null},lineWidth:1,states:{hover:{lineWidth:1}},threshold:null}},credits:{enabled:!1}},e.chartConfig.series=[],console.info("quant..."),a.get("getSymbol?symbol=EURJPY").success(function(t){for(var a=[],i=[],n=[],o=19;o<t.length;o++)a.push([Date.parse(t[o].KEYTIME),t[o].CLOSE_PRICE-130]),i.push([Date.parse(t[o].KEYTIME),t[o].max20-130]),n.push([Date.parse(t[o].KEYTIME),t[o].min10-130]);e.chartConfig.series.push({type:"spline",name:"Close Price",data:a},{type:"spline",name:"Max 20",data:i},{type:"spline",name:"Min10",data:n})})}]),angular.module("inspinia").controller("ContestCrol",["$scope","$rootScope","$http",function(e,t,a){var i=[{name:"FX",id:"1"},{name:"FC",id:"2"},{name:"SC",id:"3"}];e.$watch(function(){return t.selectedSchool},function(){t.selectedSchool&&(e.products="CN"==t.regionSelected?i:[i[0]],e.selected=e.products[0],e.loadContentData(t.selectedSchool))},!0),e.loadContentData=function(i){e.contestList=[],a.get("getContestByApp?school_key="+i+"&app="+e.selected.name+"&db="+t.regionSelected).success(function(t){e.contestList=t})},e.changeProduct=function(){e.loadContentData(t.selectedSchool)}}]);var app=angular.module("inspinia");app.controller("MapCtrl",["$scope","$location","$http",function(e,t,a){e.data=function(){a.get("getRegionDist?file=Global_Country_TU").success(function(t){t=t.data.Global_Country_TU;var a={};e.markers=[];for(var i=0;i<t.length;i++)t[i].Country&&(a[t[i].Country]=parseInt(t[i]["Total Users"])),"HK"==t[i].Country&&e.markers.push({latLng:[22.15,114.1],name:"Hong Kong",values:parseInt(t[i]["Total Users"])});e.datamap=a})}}]),app.directive("map",function(){return{restrict:"EAC",link:function(e,t){var a=null;e.$watch("datamap",function(){console.log(a),e.datamap&&($(t).width("auto"),$(t).height(400),a=$(t).vectorMap({onRegionClick:function(e,t){console.info(t)},map:"world_mill_en",backgroundColor:"transparent",regionStyle:{initial:{fill:"#e4e4e4","fill-opacity":1,stroke:"none","stroke-width":0,"stroke-opacity":0}},series:{regions:[{values:e.datamap,scale:["#1ab394","#ED5565"],normalizeFunction:"polynomial"}]},onMarkerTipShow:function(t,a,i){a.html(a.html()+": "+(e.markers[i]?e.markers[i].values:""))},onRegionTipShow:function(t,a,i){a.html(a.html()+": "+(e.datamap[i]?e.datamap[i]:""))},markers:e.markers,markerStyle:{initial:{fill:"#F8E23B",stroke:"#383f47"}}}))})}}}),angular.module("inspinia").controller("IncUserListCrol",["$scope","$rootScope","$http","$filter",function(e,t,a,i){e.rowCollection=[],e.historyFilePath="getIncuList?format=csv",e.historyFileName=i("date")(new Date,"yyyy-MM-dd")+"_incubatee.csv",e.loadIncuData=function(){a.get("getIncuList").success(function(t){e.userList=t}),a.get("getIncuSummary").success(function(t){e.summaryList=t;var a=[];for(var i in t)a.push({name:t[i].SYMBOL,y:t[i].QTY,pnl:t[i].PNL});e.chartPieConfig.series=[{type:"pie",name:"",data:a,pointPlacement:"on"}]}),a.get("getIncuCount").success(function(t){e.summaryObj=t})},e.loadIncuData(),e.chartPieConfig={options:{colors:["#1ab394","#90ee7e","#f45b5b","#7798BF","#aaeeee","#ff0066","#eeaaee","#55BF3B","#DF5353","#7798BF","#aaeeee"],chart:{backgroundColor:"rgba(255, 255, 255, 0.1)",style:{fontFamily:"'Unica One', sans-serif"},legend:{enabled:!0},plotBorderColor:"#606063",type:"pie",options3d:{enabled:!0,alpha:45,beta:0}},tooltip:{pointFormat:"Qty: <b>{point.y}</b> <br> PNL: <b>{point.pnl}</b> <br> {point.percentage:.1f} %"},plotOptions:{pie:{allowPointSelect:!0,cursor:"pointer",depth:35,dataLabels:{enabled:!0,format:"{point.name}"}}},rangeSelector:{buttonTheme:{fill:"white",stroke:"#C0C0C8","stroke-width":1,states:{select:{fill:"#D0D0D8"}}}},scrollbar:{trackBorderColor:"#C0C0C8"}},title:{text:"Symbols"}}}]),angular.module("inspinia").controller("VennCtrl",["$scope","$http","$rootScope",function(e,t,a){e.loadData=function(i){t.get("getDataFromFile?file="+i).success(function(t){t=t.data;var i=[{sets:["Mainland_FX"],size:t.China_FX_FC_SC_TU[0].China_FX},{sets:["Mainland_FC"],size:t.China_FX_FC_SC_TU[0].China_FC},{sets:["Mainland_SC"],size:t.China_FX_FC_SC_TU[0].China_SC},{sets:["Mainland_FX","Mainland_FC"],size:t.China_FX_FC_SC_TU[0].China_FX_FC},{sets:["Mainland_FX","Mainland_SC"],size:t.China_FX_FC_SC_TU[0].China_FX_SC},{sets:["Mainland_FC","Mainland_SC"],size:t.China_FX_FC_SC_TU[0].China_FC_SC},{sets:["Mainland_FX","Mainland_FC","Mainland_SC"],size:t.China_FX_FC_SC_TU[0].China_FX_FC_SC}];a.overlapUsers=t.China_FX_FC_SC_TU[0].China_FX_FC_SC,e.vennData=i,setTimeout(function(){var e=d3.select("#venn"),t=d3.select("body").append("div").attr("class","venntooltip");e.selectAll("g").on("mouseover",function(a){venn.sortAreas(e,a),t.transition().duration(400).style("opacity",.9),t.text(a.size+" users");var i=d3.select(this).transition("tooltip").duration(400);i.select("path").style("stroke-width",3).style("fill-opacity",1==a.sets.length?.4:.1).style("stroke-opacity",1)}).on("mousemove",function(){t.style("left",d3.event.pageX+"px").style("top",d3.event.pageY-28+"px")
}).on("mouseout",function(e){t.transition().duration(400).style("opacity",0);var a=d3.select(this).transition("tooltip").duration(400);a.select("path").style("stroke-width",0).style("fill-opacity",1==e.sets.length?.25:0).style("stroke-opacity",0)})},300)})}}]),angular.module("inspinia").controller("ChartCtrl",["$scope","$http","$rootScope",function(e,t,a){e.$on("changeSelector",function(e,t){console.info(t)}),a.TotalGlobalTrendObj={},a.TotalChinaTrendObj={},e.loadData=function(i){t.get("getDataFromFile?file="+i).success(function(t){t=t.data;var n=i.split("|");e.chartConfig.series=[];for(var o=0;o<n.length;o++){for(var s=[],r=0;r<t[n[o]].length;r++)s.push([Date.parse(t[n[o]][r].date),parseInt(t[n[o]][r][e.valueName])]),"Date_TU_Global"==n[o]&&(a.TotalGlobalTrendObj[t[n[o]][r].date]=parseFloat(t[n[o]][r][e.valueName])),"Date_TU_China"==n[o]&&(a.TotalChinaTrendObj[t[n[o]][r].date]=parseFloat(t[n[o]][r][e.valueName]));"All"==a.roleRegion?e.chartConfig.series.push({type:"area",name:e[n[o]],data:s}):"CN"==a.roleRegion&&(n[o].indexOf("China")>=0||n[o].indexOf("Overlap")>=0)?e.chartConfig.series.push({type:"area",name:e[n[o]],data:s}):"CN"!=a.roleRegion&&n[o].indexOf("Global")>=0&&e.chartConfig.series.push({type:"area",name:e[n[o]],data:s})}if("Date_TU_Global|Date_TU_China"==i){var l=t.Date_TU_Global,c=t.Date_TU_China;a.totalUsersChina=parseInt(c[c.length-1][e.valueName]),a.totalUsersGlobal=parseInt(l[l.length-1][e.valueName])}})},e.chartConfig={options:{},xAxis:{type:"datetime",dateTimeLabelFormats:{month:"%b. %e",year:"%b"},title:{text:"Date"}},yAxis:{title:{text:"Users"},min:0},tooltip:{headerFormat:"<b>{series.name}</b><br>",pointFormat:"{point.x:%e. %b}: {point.y:.f} users"},legend:{enabled:!0},plotOptions:{area:{color:"#0038ff",marker:{enabled:null},lineWidth:1,states:{hover:{lineWidth:1}},threshold:null}},credits:{enabled:!1},series:e.chartSeries}}]),angular.module("inspinia").controller("ChartComLineCtrl",["$scope","$http",function(e,t){e.loadData=function(a){t.get("getDataFromFile?file="+a).success(function(t){t=t.data;var a=[],i=[],n={};n={Others:0};for(var o={},s=0;s<t.Global_Country_TU.length&&5>s;s++)a.push(t.Global_Country_TU[s]),i.push(t.Global_Country_TU[s].Country),n[t.Global_Country_TU[s].Country]=0;for(var s=0;s<t.Date_Global_Country_TU.length;s++)if(i.indexOf(t.Date_Global_Country_TU[s].country)>=0){"TW"==t.Date_Global_Country_TU[s].country&&console.info(t.Date_Global_Country_TU[s]);var r=n[t.Date_Global_Country_TU[s].country]+parseInt(t.Date_Global_Country_TU[s]["Total Users"]);n[t.Date_Global_Country_TU[s].country]=r;var l=[Date.parse(t.Date_Global_Country_TU[s].date),r];o[t.Date_Global_Country_TU[s].country]&&o[t.Date_Global_Country_TU[s].country].length>0?o[t.Date_Global_Country_TU[s].country].push(l):(o[t.Date_Global_Country_TU[s].country]=[],o[t.Date_Global_Country_TU[s].country].push(l))}else{var r=n.Others+parseInt(t.Date_Global_Country_TU[s]["Total Users"]);n.Others=r;var l=[Date.parse(t.Date_Global_Country_TU[s].date),r];o.Others&&o.Others.length>0?o.Others.push(l):(o.Others=[],o.Others.push(l))}var c=[];i.push("Others");for(var d in i)c.push({name:i[d],data:o[i[d]]});e.chartConfig.series=c})},e.chartConfig={chart:{backgroundColor:null,zoomType:"x"},xAxis:{type:"datetime",dateTimeLabelFormats:{month:"%b. %e",year:"%b"},title:{text:"Date"}},yAxis:{title:{text:"Users"},min:0},tooltip:{headerFormat:"<b>{series.name}</b><br>",pointFormat:"{point.x:%e. %b}: {point.y:.f} users"},legend:{enabled:!0},plotOptions:{area:{color:"#0038ff",marker:{enabled:null},lineWidth:1,states:{hover:{lineWidth:1}},threshold:null}},credits:{enabled:!1},series:e.chartSeries}}]),angular.module("inspinia").controller("ChartAreaCtrl",["$scope","$http","$rootScope",function(e,t,a){a.activeGlobalTrendObj={},a.activeChinaTrendObj={},e.loadData=function(i){t.get("getDataFromFile?file="+i).success(function(t){t=t.data;var n=i.split("|");e.chartConfig.series=[];for(var o=0;o<n.length;o++){for(var s=[],r=0;r<t[n[o]].length;r++)"Date_AU_Global_FX"==i&&a.lastUpdate==t[n[o]][r].date&&(a.activeGlobalFXUsers=parseInt(t[n[o]][r][e.valueName])),"Date_AU_China_FX"==i&&a.lastUpdate==t[n[o]][r].date&&(a.activeChinaFXUsers=parseInt(t[n[o]][r][e.valueName])),"Date_AU_China_FC"==i&&a.lastUpdate==t[n[o]][r].date&&(a.activeChinaFCUsers=parseInt(t[n[o]][r][e.valueName])),"Date_AU_China_SC"==i&&a.lastUpdate==t[n[o]][r].date&&(a.activeChinaSCUsers=parseInt(t[n[o]][r][e.valueName])),"Date_NU_China"==i&&a.lastUpdate==t[n[o]][r].date&&(a.newChinaUsers=parseInt(t[n[o]][r][e.valueName])),"Date_NU_Global"==i&&a.lastUpdate==t[n[o]][r].date&&(a.newGlobalUsers=parseInt(t[n[o]][r][e.valueName])),"Date_AU_Global_FX"==i&&a.previousDate==t[n[o]][r].date&&(a.activeGlobalPreFXUsers=parseInt(t[n[o]][r][e.valueName])),"Date_AU_China_FX"==i&&a.previousDate==t[n[o]][r].date&&(a.activeChinaPreFXUsers=parseInt(t[n[o]][r][e.valueName])),"Date_AU_China_FC"==i&&a.previousDate==t[n[o]][r].date&&(a.activeChinaPreFCUsers=parseInt(t[n[o]][r][e.valueName])),"Date_AU_China_SC"==i&&a.previousDate==t[n[o]][r].date&&(a.activeChinaPreSCUsers=parseInt(t[n[o]][r][e.valueName])),"Date_NU_China"==i&&a.previousDate==t[n[o]][r].date&&(a.newChinaPreUsers=parseInt(t[n[o]][r][e.valueName])),"Date_NU_Global"==i&&a.previousDate==t[n[o]][r].date&&(a.newGlobaPrelUsers=parseInt(t[n[o]][r][e.valueName])),s.push([Date.parse(t[n[o]][r].date),parseInt(t[n[o]][r][e.valueName])]),a.activeGlobalTrendObj[t[n[o]][r].date]||(a.activeGlobalTrendObj[t[n[o]][r].date]=parseFloat(t[n[o]][r][e.valueName])),("Date_AU_China_SC"==i||"Date_AU_China_FC"==i||"Date_AU_China_FX"==i)&&(a[i]||(a[i]={}),a[i][t[n[o]][r].date]=parseFloat(t[n[o]][r][e.valueName]));e.chartConfig.series.push({type:"area",name:e[n[o]],data:s})}})},e.chartConfig={chart:{backgroundColor:null,zoomType:"x"},options:{plotOptions:{area:{fillColor:{linearGradient:{x1:0,y1:0,x2:0,y2:1},stops:[[0,Highcharts.getOptions().colors[0]],[1,Highcharts.Color(Highcharts.getOptions().colors[0]).setOpacity(0).get("rgba")]]},marker:{radius:2},lineWidth:1,states:{hover:{lineWidth:1}},threshold:null}}},xAxis:{type:"datetime",dateTimeLabelFormats:{month:"%b. %e",year:"%b"},title:{text:"Date"}},yAxis:{title:{text:"Users"},min:0},tooltip:{headerFormat:"<b>{series.name}</b><br>",pointFormat:"{point.x:%e. %b}: {point.y:.f} users"},legend:{enabled:!0},plotOptions:{area:{color:"#0038ff",marker:{enabled:null},lineWidth:1,states:{hover:{lineWidth:1}},threshold:null}},credits:{enabled:!1},series:e.chartSeries}}]),angular.module("inspinia").controller("ChartActiveCtrl",["$scope","$http","$rootScope",function(e,t,a){e.loadData=function(){t.get("getActiveUserPer").success(function(t){for(var i=[],n=[],o=0;o<t.global.length;o++)i.push([Date.parse(t.global[o].date),t.global[o].Percentage]);for(var o=0;o<t.china.length;o++)n.push([Date.parse(t.china[o].date),t.china[o].Percentage]);"All"==a.roleRegion?e.chartConfig.series=[{type:"area",name:"Mainland %",data:n},{type:"area",name:"Overseas %",data:i}]:"CN"==a.roleRegion?e.chartConfig.series=[{type:"area",name:"Mainland %",data:n}]:"CN"!=a.roleRegion&&(e.chartConfig.series=[{type:"area",name:"Overseas %",data:i}])})},e.chartConfig={options:{colors:["#1ab394","#127E68"],chart:{backgroundColor:null,zoomType:"x"},tooltip:{headerFormat:"<b>{series.name}</b><br>",pointFormat:"{point.x:%e. %b}: {point.y:.f} %"}},xAxis:{type:"datetime",dateTimeLabelFormats:{month:"%b. %e",year:"%b"},title:{text:"Date"},floor:Date.UTC(2015,4,17)},yAxis:{title:{text:"Active Users%"},min:0},tooltip:{headerFormat:"<b>{series.name}</b><br>",pointFormat:"{point.x:%e. %b}: {point.y:.f} users"},legend:{enabled:!0},credits:{enabled:!1},series:e.chartSeries}}]),angular.module("inspinia").controller("BoxCtrl",["$scope","$http","$rootScope","$filter","$cookieStore",function(e,t,a,i,n){a.lastUpdate=moment().subtract(1,"days").format("YYYY-MM-DD"),a.previousDate=moment().subtract(2,"days").format("YYYY-MM-DD"),e.loadContestCount=function(){t.get("getContestCount").success(function(t){e.contentCount=t[0].count}),t.get("getCoreUserTotal?app=FX&db=TW").success(function(t){e.cuGlobal=t.length}),t.get("getCoreUserTotal?app=FX&db=CN").success(function(t){e.cuChinaFX=t.length}),t.get("getCoreUserTotal?app=FC&db=CN").success(function(t){e.cuChinaFC=t.length}),t.get("getCoreUserTotal?app=SC&db=CN").success(function(t){e.cuChinaSC=t.length})},a.logout=function(){n.remove("connect.sid"),location.href="logout"}}]),$(document).ready(function(){function e(){var e=$("body > #wrapper").height()-61;$(".sidebard-panel").css("min-height",e+"px");var t=$("nav.navbar-default").height(),a=$("#page-wrapper").height();t>a&&$("#page-wrapper").css("min-height",t+"px"),a>t&&$("#page-wrapper").css("min-height",$(window).height()+"px"),$("body").hasClass("fixed-nav")&&$("#page-wrapper").css("min-height",$(window).height()-60+"px")}$(window).bind("load resize scroll",function(){$("body").hasClass("body-small")||e()}),setTimeout(function(){e()})}),$(function(){$(window).bind("load resize",function(){$(this).width()<769?$("body").addClass("body-small"):$("body").removeClass("body-small")})}),angular.module("inspinia").directive("sideNavigation",["$timeout",function(e){return{restrict:"A",link:function(t,a){t.$watch("authentication.user",function(){e(function(){a.metisMenu()})})}}}]).directive("minimalizaSidebar",["$timeout",function(e){return{restrict:"A",template:'<a class="navbar-minimalize minimalize-styl-2 btn btn-primary " href="" ng-init="minimalize()" ng-click="minimalize()"><i class="fa fa-bars"></i></a>',controller:["$scope","$element",function(t){t.minimalize=function(){angular.element("body").toggleClass("mini-navbar"),!angular.element("body").hasClass("mini-navbar")||angular.element("body").hasClass("body-small")?(angular.element("#side-menu").hide(),e(function(){angular.element("#side-menu").fadeIn(500)},100)):angular.element("#side-menu").removeAttr("style")}}]}}]),angular.module("inspinia").run(["$templateCache",function(e){e.put("components/box/sumbox.html",'<div class="row" ng-controller="BoxCtrl"><div class="col-lg-2"><div class="ibox float-e-margins"><div class="ibox-title"><span class="label label-success pull-right">All Apps</span><h5>Total Users</h5></div><div class="ibox-content"><h1 class="no-margins" ng-bind="(($root.totalUsersChina + $root.totalUsersGlobal)|number)">0</h1><small>Users</small></div></div></div><div class="col-lg-2"><a href="#/index/core"><div class="ibox float-e-margins"><div class="ibox-title"><h5>Mainland</h5></div><div class="ibox-content"><h1 class="no-margins" ng-bind="((cuChinaFX + $cuChinaFX + cuChinaSC)|number)"><i class="fa fa-spinner fa-spin"></i></h1><small>Core Users</small> <span class="stat-percent font-bold text-success ng-binding" ng-bind="((cuChinaFX + $cuChinaFX + cuChinaSC)/ ($root.totalUsersChina + $root.totalUsersGlobal) * 100|number:2) + \'%\'"></span></div></div></a></div><div class="col-lg-2"><a href="#/index/core"><div class="ibox float-e-margins"><div class="ibox-title"><h5>Overseas</h5></div><div class="ibox-content"><h1 class="no-margins" ng-bind="(cuGlobal|number)"><i class="fa fa-spinner fa-spin"></i></h1><small>Core Users</small> <span class="stat-percent font-bold text-success ng-binding" ng-bind="(cuGlobal/ ($root.totalUsersChina + $root.totalUsersGlobal) * 100|number:2) + \'%\'"></span></div></div></a></div><div class="col-lg-2"><div class="ibox float-e-margins"><div class="ibox-title"><span class="label label-info pull-right">Daily</span><h5>Active User</h5></div><div class="ibox-content"><h1 class="no-margins" ng-bind="(($root.activeChinaFXUsers + $root.activeChinaSCUsers + $root.activeChinaFCUsers + $root.activeGlobalFXUsers ) |number) || \'Calculating...\'">0</h1><span class="stat-percent font-bold text-success" ng-bind="(($root.activeChinaFXUsers + $root.activeChinaSCUsers + $root.activeChinaFCUsers + $root.activeGlobalFXUsers ) / ($root.totalUsersChina + $root.totalUsersGlobal) * 100|number:2) + \'%\'"></span> <span class="font-bold" ng-class="($root.activeChinaFXUsers + $root.activeChinaSCUsers + $root.activeChinaFCUsers + $root.activeGlobalFXUsers - ($root.activeChinaPreFXUsers + $root.activeChinaPreSCUsers + $root.activeChinaPreFCUsers + $root.activeGlobalPreFXUsers)) > 0?\'text-danger\':\'text-navy\'">{{($root.activeChinaFXUsers + $root.activeChinaSCUsers + $root.activeChinaFCUsers + $root.activeGlobalFXUsers - ($root.activeChinaPreFXUsers + $root.activeChinaPreSCUsers + $root.activeChinaPreFCUsers + $root.activeGlobalPreFXUsers)) / ($root.activeChinaPreFXUsers + $root.activeChinaPreSCUsers + $root.activeChinaPreFCUsers + $root.activeGlobalPreFXUsers )|number:2}}% <i class="fa" ng-class="($root.activeChinaFXUsers + $root.activeChinaSCUsers + $root.activeChinaFCUsers + $root.activeGlobalFXUsers - ($root.activeChinaPreFXUsers + $root.activeChinaPreSCUsers + $root.activeChinaPreFCUsers + $root.activeGlobalPreFXUsers)) > 0?\'fa-level-up\':\'fa-level-down\'"></i></span></div></div></div><div class="col-lg-2"><div class="ibox float-e-margins"><div class="ibox-title"><span class="label label-primary pull-right">Daily</span><h5>New Users</h5></div><div class="ibox-content"><h1 class="no-margins" ng-bind="(($root.newChinaUsers + $root.newGlobalUsers ) |number) || \'Calculating...\'">0</h1><span class="stat-percent font-bold text-navy" ng-bind="(($root.newChinaUsers + $root.newGlobalUsers ) / ($root.totalUsersChina + $root.totalUsersGlobal) * 100|number:2) + \'%\'"><i class="fa fa-bolt"></i></span> <span class="font-bold" ng-class="($root.newChinaUsers + $root.newGlobalUsers - ($root.newChinaPreUsers + $root.newGlobalPreUsers)) >0?\'text-danger\':\'text-navy\'">{{($root.newChinaUsers + $root.newGlobalUsers - ($root.newChinaPreUsers + $root.newGlobalPreUsers)) / ($root.newChinaPreUsers + $root.newGlobalPreUsers) |number:2}}% <i class="fa" ng-class="($root.newChinaUsers + $root.newGlobalUsers - ($root.newChinaPreUsers + $root.newGlobalPreUsers)) >0?\'fa-level-up\':\'fa-level-down\'"></i></span></div></div></div><div class="col-lg-2"><div class="ibox float-e-margins"><div class="ibox-title"><span class="label label-danger pull-right">Overseas</span><h5>Contest</h5></div><div class="ibox-content"><h1 class="no-margins" ng-init="loadContestCount()" ng-bind="(contentCount |number)">0</h1><small>Contests Held</small></div></div></div></div>'),e.put("components/chart/chart_cn_au_fc.html",'<div class="col-md-4" ng-controller="ChartAreaCtrl"><highchart ng-init="loadData(\'Date_AU_China_FC\')" config="chartConfig"></highchart><input type="hidden" ng-init="chartConfig.title.text=\'Daily Active Users\'"> <input type="hidden" ng-init="chartConfig.subtitle.text=\'Mainland\'"> <input type="hidden" ng-init="valueName=\'Active Users\'"> <input type="hidden" ng-init="Date_AU_China_FC=\'Mainland Daily Active Users\'"></div><div class="col-md-4" ng-controller="ChartAreaCtrl"><highchart ng-init="loadData(\'Week_AU_China_FC\')" config="chartConfig"></highchart><input type="hidden" ng-init="chartConfig.title.text=\'Weekly Active Users\'"> <input type="hidden" ng-init="chartConfig.subtitle.text=\'Mainland\'"> <input type="hidden" ng-init="valueName=\'Active Users\'"> <input type="hidden" ng-init="Week_AU_China_FC=\'Mainland Weekly Active Users\'"></div><div class="col-md-4" ng-controller="ChartAreaCtrl"><highchart ng-init="loadData(\'Month_AU_China_FC\')" config="chartConfig"></highchart><input type="hidden" ng-init="chartConfig.title.text=\'Monthly Active Users\'"> <input type="hidden" ng-init="chartConfig.subtitle.text=\'Mainland\'"> <input type="hidden" ng-init="valueName=\'Active Users\'"> <input type="hidden" ng-init="Month_AU_China_FC=\'Mainland Monthly Active Users\'"></div>'),e.put("components/chart/chart_cn_au_fx.html",'<div class="col-md-4" ng-controller="ChartAreaCtrl"><highchart ng-init="loadData(\'Date_AU_China_FX\')" config="chartConfig"></highchart><input type="hidden" ng-init="chartConfig.title.text=\'Daily Active Users\'"> <input type="hidden" ng-init="chartConfig.subtitle.text=\'Mainland\'"> <input type="hidden" ng-init="valueName=\'Active Users\'"> <input type="hidden" ng-init="Date_AU_China_FX=\'Mainland Daily Active Users\'"></div><div class="col-md-4" ng-controller="ChartAreaCtrl"><highchart ng-init="loadData(\'Week_AU_China_FX\')" config="chartConfig"></highchart><input type="hidden" ng-init="chartConfig.title.text=\'Weekly Active Users\'"> <input type="hidden" ng-init="chartConfig.subtitle.text=\'Mainland\'"> <input type="hidden" ng-init="valueName=\'Active Users\'"> <input type="hidden" ng-init="Week_AU_China_FX=\'Mainland Weekly Active Users\'"></div><div class="col-md-4" ng-controller="ChartAreaCtrl"><highchart ng-init="loadData(\'Month_AU_China_FX\')" config="chartConfig"></highchart><input type="hidden" ng-init="chartConfig.title.text=\'Monthly Active Users\'"> <input type="hidden" ng-init="chartConfig.subtitle.text=\'Mainland\'"> <input type="hidden" ng-init="valueName=\'Active Users\'"> <input type="hidden" ng-init="Month_AU_China_FX=\'Mainland Monthly Active Users\'"></div>'),e.put("components/chart/chart_cn_au_sc.html",'<div class="col-md-4" ng-controller="ChartAreaCtrl"><highchart ng-init="loadData(\'Date_AU_China_SC\')" config="chartConfig"></highchart><input type="hidden" ng-init="chartConfig.title.text=\'Daily Active Users\'"> <input type="hidden" ng-init="chartConfig.subtitle.text=\'Mainland\'"> <input type="hidden" ng-init="valueName=\'Active Users\'"> <input type="hidden" ng-init="Date_AU_China_SC=\'Mainland Daily Active Users\'"></div><div class="col-md-4" ng-controller="ChartAreaCtrl"><highchart ng-init="loadData(\'Week_AU_China_SC\')" config="chartConfig"></highchart><input type="hidden" ng-init="chartConfig.title.text=\'Weekly Active Users\'"> <input type="hidden" ng-init="chartConfig.subtitle.text=\'Mainland\'"> <input type="hidden" ng-init="valueName=\'Active Users\'"> <input type="hidden" ng-init="Week_AU_China_SC=\'Mainland Weekly Active Users\'"></div><div class="col-md-4" ng-controller="ChartAreaCtrl"><highchart ng-init="loadData(\'Month_AU_China_SC\')" config="chartConfig"></highchart><input type="hidden" ng-init="chartConfig.title.text=\'Monthly Active Users\'"> <input type="hidden" ng-init="chartConfig.subtitle.text=\'Mainland\'"> <input type="hidden" ng-init="valueName=\'Active Users\'"> <input type="hidden" ng-init="Month_AU_China_SC=\'Mainland Monthly Active Users\'"></div>'),e.put("components/chart/chart_cn_nu.html",'<div class="col-md-4" ng-controller="ChartAreaCtrl"><highchart ng-init="loadData(\'Date_NU_China\')" config="chartConfig"></highchart><input type="hidden" ng-init="chartConfig.title.text=\'Daily New Users\'"> <input type="hidden" ng-init="valueName=\'New Users\'"> <input type="hidden" ng-init="Date_NU_China=\'Mainland Daily New Users\'"></div><div class="col-md-4" ng-controller="ChartAreaCtrl"><highchart ng-init="loadData(\'Week_NU_China\')" config="chartConfig"></highchart><input type="hidden" ng-init="chartConfig.title.text=\'Weekly New Users\'"> <input type="hidden" ng-init="valueName=\'New Users\'"> <input type="hidden" ng-init="Week_NU_China=\'Mainland Weekly New Users\'"></div><div class="col-md-4" ng-controller="ChartAreaCtrl"><highchart ng-init="loadData(\'Month_NU_China\')" config="chartConfig"></highchart><input type="hidden" ng-init="chartConfig.title.text=\'Monthly New Users\'"> <input type="hidden" ng-init="valueName=\'New Users\'"> <input type="hidden" ng-init="Month_NU_China=\'Mainland Monthly New Users\'"></div>'),e.put("components/chart/chart_fx_fc_sc.html",'<div class="col-md-12" ng-controller="ChartCtrl"><highchart ng-init="loadData(\'Date_TU_China_FX|Date_TU_China_FC|Date_TU_China_SC\')" config="chartConfig"></highchart><input type="hidden" ng-init="chartConfig.title.text=\'Mainland FX FC SC\'"> <input type="hidden" ng-init="valueName=\'Total Users\'"> <input type="hidden" ng-init="Date_TU_China_FX=\'Mainland FX\'"> <input type="hidden" ng-init="Date_TU_China_FC=\'Mainland FC\'"> <input type="hidden" ng-init="Date_TU_China_SC=\'Mainland SC\'"></div>'),e.put("components/chart/chart_gb_au.html",'<div class="col-md-4" ng-controller="ChartAreaCtrl"><highchart ng-init="loadData(\'Date_AU_Global_FX\')" config="chartConfig"></highchart><input type="hidden" ng-init="chartConfig.title.text=\'Daily Active Users\'"> <input type="hidden" ng-init="chartConfig.subtitle.text=\'Overseas\'"> <input type="hidden" ng-init="valueName=\'Active Users\'"> <input type="hidden" ng-init="Date_AU_Global_FX=\'Overseas Daily Active Users\'"></div><div class="col-md-4" ng-controller="ChartAreaCtrl"><highchart ng-init="loadData(\'Week_AU_Global_FX\')" config="chartConfig"></highchart><input type="hidden" ng-init="chartConfig.title.text=\'Weekly Active Users\'"> <input type="hidden" ng-init="chartConfig.subtitle.text=\'Overseas\'"> <input type="hidden" ng-init="valueName=\'Active Users\'"> <input type="hidden" ng-init="Week_AU_Global_FX=\'Overseas Weekly Active Users\'"></div><div class="col-md-4" ng-controller="ChartAreaCtrl"><highchart ng-init="loadData(\'Month_AU_Global_FX\')" config="chartConfig"></highchart><input type="hidden" ng-init="chartConfig.title.text=\'Monthly Active Users\'"> <input type="hidden" ng-init="chartConfig.subtitle.text=\'Overseas\'"> <input type="hidden" ng-init="valueName=\'Active Users\'"> <input type="hidden" ng-init="Month_AU_Global_FX=\'Overseas Monthly Active Users\'"></div>'),e.put("components/chart/chart_gb_nu.html",'<div class="col-md-4" ng-controller="ChartAreaCtrl"><highchart ng-init="loadData(\'Date_NU_Global\')" config="chartConfig"></highchart><input type="hidden" ng-init="chartConfig.title.text=\'Daily New Users\'"> <input type="hidden" ng-init="chartConfig.subtitle.text=\'Overseas\'"> <input type="hidden" ng-init="valueName=\'New Users\'"> <input type="hidden" ng-init="Date_NU_Global=\'Overseas Daily New Users\'"></div><div class="col-md-4" ng-controller="ChartAreaCtrl"><highchart ng-init="loadData(\'Week_NU_Global\')" config="chartConfig"></highchart><input type="hidden" ng-init="chartConfig.title.text=\'Weekly New Users\'"> <input type="hidden" ng-init="chartConfig.subtitle.text=\'Overseas\'"> <input type="hidden" ng-init="valueName=\'New Users\'"> <input type="hidden" ng-init="Week_NU_Global=\'Overseas Weekly New Users\'"></div><div class="col-md-4" ng-controller="ChartAreaCtrl"><highchart ng-init="loadData(\'Month_NU_Global\')" config="chartConfig"></highchart><input type="hidden" ng-init="chartConfig.title.text=\'Monthly New Users\'"> <input type="hidden" ng-init="chartConfig.subtitle.text=\'Overseas\'"> <input type="hidden" ng-init="valueName=\'New Users\'"> <input type="hidden" ng-init="Month_NU_Global=\'Overseas Monthly New Users\'"></div>'),e.put("components/chart/chart_global_dist.html",'<div ng-controller="ChartComLineCtrl"><div class="col-md-6"><highchart ng-init="loadData(\'Date_Global_Country_TU|Global_Country_TU\')" config="chartConfig"></highchart><input type="hidden" ng-init="chartConfig.title.text=\'Global Distribution\'"></div></div>'),e.put("components/chart/chart_tu.html",'<div class="row"><div class="col-lg-6" ng-controller="ChartCtrl"><highchart ng-init="loadData(\'Date_TU_Global|Date_TU_China\')" config="chartConfig" class="span9"></highchart><input type="hidden" ng-init="chartConfig.title.text=\'Total User Growth\'"> <input type="hidden" ng-init="valueName=\'Total Users\'"> <input type="hidden" ng-init="Date_TU_Global=\'Overseas\'"> <input type="hidden" ng-init="Date_TU_China=\'Mainland\'"> <input type="hidden" ng-init="chartType=\'area\'"> <input type="hidden" ng-init="chartConfig.colors=[\'#0000ff\',\'ff0066\',\'2b908f\']"></div><div class="col-lg-6" ng-controller="ChartActiveCtrl"><highchart ng-init="loadData()" config="chartConfig" class="span9"></highchart><input type="hidden" ng-init="chartConfig.title.text=\'Active User Percentage\'"></div></div>'),e.put("components/chart/overlap.html",'<div class="col-md-6" ng-controller="ChartCtrl"><highchart ng-init="loadData(\'FX_FC_Overlap|FX_SC_Overlap|FC_SC_Overlap|FX_FC_SC_Overlap\')" config="chartConfig"></highchart><input type="hidden" ng-init="chartConfig.title.text=\'FX FC SC Users\'"> <input type="hidden" ng-init="chartConfig.subtitle.text=\'Overlaping Users\'"> <input type="hidden" ng-init="valueName=\'Common Users\'"> <input type="hidden" ng-init="FX_FC_Overlap=\'FX&FC\'"> <input type="hidden" ng-init="FX_SC_Overlap=\'FX&SC\'"> <input type="hidden" ng-init="FC_SC_Overlap=\'FC&SC\'"> <input type="hidden" ng-init="FX_FC_SC_Overlap=\'FX&FC&SC\'"></div>'),e.put("components/chart/venn.html",'<div class="col-md-6 venn-panel" ng-controller="VennCtrl"><div id="venn" venn="vennData" ng-init="loadData(\'China_FX_FC_SC_TU\')"></div></div>'),e.put("components/common/content.html",'<div id="wrapper"><div ng-include="\'components/common/navigation.html\'"></div><div id="page-wrapper" class="gray-bg {{$state.current.name}}"><div ng-include="\'components/common/topnavbar.html\'"></div><div ui-view=""></div><div ng-include="\'components/common/footer.html\'"></div></div></div>'),e.put("components/common/footer.html",'<div class="footer"><div class="pull-right">FDT Dashboard v0.5</div><div><strong>Copyright</strong> FDT &copy; 2014-2015</div></div>'),e.put("components/common/ibox_tools.html",'<div class="ibox-tools dropdown" dropdown=""><a ng-click="showhide()"><i class="fa fa-chevron-up"></i></a> <a class="dropdown-toggle" href="" dropdown-toggle=""><i class="fa fa-wrench"></i></a><ul class="dropdown-menu dropdown-user"><li><a href="">Config option 1</a></li><li><a href="">Config option 2</a></li></ul><a ng-click="closebox()"><i class="fa fa-times"></i></a></div>'),e.put("components/common/navigation.html",'<nav class="navbar-default navbar-static-side" role="navigation"><div class="sidebar-collapse"><ul side-navigation="" class="nav metismenu" id="side-menu"><li class="nav-header"><div class="dropdown profile-element open"><span><img alt="image" style="width:80px" src="assets/images/fdt_bull.png"></span> <a data-toggle="dropdown" class="dropdown-toggle" href="#" aria-expanded="false"><span class="clear"><span class="block m-t-xs"><strong class="font-bold">{{$root.userNick}}</strong></span> <span class="text-muted text-xs block"><b class="caret"></b></span></span></a></div><div class="logo-element"><img alt="image" class="" src="assets/images/fdt_bull.png" style="width: 40px;"></div></li><li ui-sref-active="active" ng-if="$root.dashboardShow"><a ui-sref="index.main"><i class="fa fa-dashboard"></i> <span class="nav-label">Dashboard</span></a></li><li ui-sref-active="active" ng-if="$root.schoolShow"><a ui-sref="index.school"><i class="fa fa-graduation-cap"></i> <span class="nav-label">School</span></a></li><li ui-sref-active="active" ng-if="$root.simShow || $root.incuShow || $root.seedShow"><a href="mailbox.html"><i class="fa fa-user"></i> <span class="nav-label">Users</span></a><ul class="nav nav-second-level collapse"><li><a ui-sref="index.search" ng-if="$root.simShow">Sim Users</a></li><li><a ui-sref="index.incu" ng-if="$root.incuShow">Incubatee</a></li><li><a ui-sref="index.seed" ng-if="$root.seedShow">Seed</a></li></ul></li></ul></div></nav>'),e.put("components/common/topnavbar.html",'<div class="row border-bottom" ng-controller="BoxCtrl"><nav class="navbar navbar-static-top white-bg" role="navigation" style="margin-bottom: 0"><div class="navbar-header"><span minimaliza-sidebar=""></span><form role="search" class="navbar-form-custom" method="post" action=""><div class="form-group"><input type="text" placeholder="" class="form-control" name="top-search" id="top-search"></div></form></div><ul class="nav navbar-top-links navbar-right"><li><span class="m-r-sm text-muted welcome-message" ng-bind="\'Last Updated Time : \' + $root.lastUpdate"></span></li><li><i class="fa fa-user"></i> <span class="m-r-sm text-muted welcome-message" ng-bind="$root.userNick"></span></li><li><a href="#" ng-click="logout()"><i class="fa fa-sign-out"></i> Log out</a></li></ul></nav></div>'),e.put("components/map/map.html",'<div class="col-md-6 chartPanel" ng-controller="MapCtrl"><h3>Global Distribution on Map</h3><div id="map" map="" ng-init="data()"></div></div>'),e.put("components/seed/user_list.html",'<div class="wrapper wrapper-content animated fadeInRight" ng-hide="$root.seedShow"><h3>No access for this account</h3></div><div class="wrapper wrapper-content animated fadeInRight" ng-if="$root.seedShow"><div class="row" ng-controller="SeedUserListCrol"><div class="col-lg-6"><div class="col-xs-8 text-left"><span>Daily Total P&L (including fee&commisions)</span><h1 class="font-bold">${{summaryObj.pnl | number:2}}</h1></div><div class="col-xs-4 text-left"><span>Daily Total QTY</span><h1 class="font-bold">{{summaryObj.qty | number}}</h1></div><div class="col-lg-12"><highchart config="chartPieConfig"></highchart></div></div><div class="col-lg-6"><div class="ibox float-e-margins"><div class="ibox-title"><h5>Daily Summary</h5><div class="ibox-tools"></div></div><div class="ibox-content"><div class="table-responsive"><table st-safe-src="summaryList" st-table="displayedSummary" class="table table-striped"><thead><tr><th>Trade Date</th><th>Symbol</th><th st-sort="ACCOUNT_VALUE" st-sort-default="reverse">QTY</th><th st-sort="PNL">P&L</th></tr></thead><tbody><tr ng-repeat="sum in displayedSummary"><td>{{sum["@TRADE_DATE"]}}</td><td>{{sum.SYMBOL}}</td><td>{{sum.QTY|number}}</td><td>{{sum.PNL|number:2}}</td></tr></tbody></table></div></div></div></div><div class="col-lg-12"><div class="ibox float-e-margins"><div class="ibox-title"><h5>Seed Daily Performance</h5><div class="ibox-tools" ng-if="$root.exportShow"><a type="button" class="btn btn-sm btn-primary" href="{{historyFilePath}}" download="{{historyFileName}}">Export</a></div></div><div class="ibox-content"><div class="table-responsive"><table st-safe-src="userList" st-table="displayed" class="table table-striped"><thead><tr><th colspan="5"><div class="input-group"><input st-search="USER_ID" class="form-control" placeholder="Search User ID ..." type="text"> <span class="input-group-btn"><button type="button" class="btn btn-sm btn-primary">Go!</button></span></div></th></tr><tr><th>Trade Date</th><th>User Id</th><th st-sort="ACCOUNT_VALUE" st-sort-default="reverse">Account Value</th><th st-sort="PNL">P&L</th><th st-sort="UR_PNL">UR_P&L</th><th st-sort="ALL_TIME_PNL">All Time P&L</th><th st-sort="SUMQTY">Total Qty</th><th st-sort="CNTQTY"># Qty</th><th st-sort="CASH">Cash</th><th st-sort="Ranking">Ranking</th><th st-sort="WinRatio">Win Ratio</th><th st-sort="BiggestWin">Biggest Win</th><th st-sort="BiggestLoss">Biggest Loss</th><th st-sort="AllTimeSharpRatio">All Time Sharp Ratio</th></tr></thead><tbody><tr ng-repeat="userInfo in displayed"><td>{{userInfo["@TRADE_DATE"]}}</td><td><a href="#/index/profile/{{userInfo.USER_ID}}/SEED/FX">{{userInfo.USER_ID}}</a></td><td>{{userInfo.ACCOUNT_VALUE|number:2}}</td><td>{{userInfo.PNL|number:2}}</td><td>{{userInfo.UR_PNL|number:2}}</td><td>{{userInfo.ALL_TIME_PNL|number:2}}</td><td>{{userInfo.SUMQTY}}</td><td>{{userInfo.CNTQTY}}</td><td>{{userInfo.CASH|number:2}}</td><td>{{userInfo.Ranking}}</td><td>{{userInfo.WinRatio}}%</td><td>{{userInfo.BiggestWin|number:2}}</td><td>{{userInfo.BiggestLoss|number:2}}</td><td>{{userInfo.AllTimeSharpRatio|number:2}}%</td></tr></tbody><tfoot><tr><td colspan="5" class="text-center"><div st-pagination="" st-items-by-page="itemsByPage" st-displayed-pages="7"></div></td></tr></tfoot></table></div></div></div></div></div></div>'),e.put("components/user/cmb_list.html",'<div class="col-lg-2" ng-repeat="user in userList"><div class="contact-box center-version"><a href="#/index/profile/{{user.userId}}/CN/FC/beta"><img alt="image" class="img-circle" src="{{usersMap[user.userId].serving_url ||\'http://www.hkfdt.cn/favicon.ico\'}}"><h3 class="m-b-xs"><strong>{{usersMap[user.userId].USERNAME}}</strong></h3><address class="m-t-md"><strong>{{usersMap[user.userId].school_name}}</strong><br><abbr title="Phone">Score:</abbr> {{user["scoresMap"]["feature"][featureSelected.key]["scores"].fdt}}</address></a></div></div>'),e.put("components/user/cmb_score.html",'<div class="row" ng-controller="CMBCtrl"><div class="wrapper wrapper-content animated fadeInRight"><div class="row filterBar" ng-init="changeFt()"><div class="col-md-2"><select class="input-sm form-control input-s-sm inline product-option" ng-options="feature.name for feature in features" ng-model="featureSelected" ng-change="changeFt()"></select></div><div class="col-md-1"><input ng-model="limitList" value="10" ng-model-options="{debounce: 1000}" class="userScorelimit" ng-change="changeFt()"> Limit</div><div class="col-md-2"><input ng-model="tradeCount" value="0" class="countFilter" ng-model-options="{debounce: 1000}" ng-change="changeFt()"> Trade Count</div><div class="col-md-2"><input ng-model="loginCount" value="0" class="countFilter" ng-model-options="{debounce: 1000}" ng-change="changeFt()"> Login Count</div><div class="col-md-2"><input ng-model="unitPrice" value="0.95" class="countFilter" ng-model-options="{debounce: 1000}" ng-change="changeFt()"> Unit Price</div><div class="col-md-2"><input ng-model="mdd" value="-0.15" class="countFilter" ng-model-options="{debounce: 1000}" ng-change="changeFt()"> MDD</div></div><div ng-include="\'components/user/cmb_list.html\'"></div></div></div>'),e.put("components/user/core_user.html",'<div class="row" ng-controller="CoreUserCtrl"><div class="wrapper wrapper-content animated fadeInRight"><div class="row filterBar" ng-init="changeRegion()"><div class="col-md-2"><select class="input-sm form-control input-s-sm inline product-option" ng-options="app for app in appTypes" ng-model="appSelected" ng-change="changeSelect()"></select></div><div class="col-md-1"><select class="input-sm form-control input-s-sm inline product-option" ng-options="region for region in regions" ng-model="regionSelected" ng-change="changeRegion()"></select></div><div class="col-md-1"><select class="input-sm form-control input-s-sm inline product-option" ng-options="school.name for school in schools" ng-model="schoolSelected" ng-change="changeSelect()"></select></div><div class="col-md-1"><input ng-model="limitList" value="20" ng-model-options="{debounce: 1000}" class="userScorelimit" ng-change="changeSelect()"> Limit</div><div class="col-md-1"><a class="btn btn-white btn-bitbucket"><i class="fa fa-user-md"></i> {{totalUser}}</a></div><div class="col-md-2 btn-group pull-right"><button class="btn" ng-class="{\'btn-primary\': isActive(30), \'btn-white\': !isActive(30)}" type="button" ng-click="changeSelect(30)">30 Day</button> <button class="btn" ng-class="{\'btn-primary\': isActive(60), \'btn-white\': !isActive(60)}" type="button" ng-click="changeSelect(60)">60 Day</button> <button class="btn" ng-class="{\'btn-primary\': isActive(90), \'btn-white\': !isActive(90)}" type="button" ng-click="changeSelect(90)">90 Day</button></div></div><div ng-include="\'components/user/core_user_list.html\'"></div></div></div>'),e.put("components/user/core_user_list.html",'<div class="col-lg-2" ng-repeat="user in userList"><div class="contact-box center-version"><a href="#/index/profile/{{user.user_id}}/{{regionSelected}}/{{appSelected}}"><img alt="image" class="img-circle" src="{{usersMap[user.user_id].serving_url ||\'http://www.hkfdt.cn/favicon.ico\'}}"><h3 class="m-b-xs"><strong>{{usersMap[user.user_id].USERNAME}}</strong></h3><address class="m-t-md"><strong>{{usersMap[user.user_id].school_name|limitTo:10}}</strong><br><abbr title="Phone">Trade Life :</abbr> {{user.life}}</address></a></div></div>'),e.put("components/user/user_closed_list.html",'<div class="col-lg-12"><div class="ibox float-e-margins"><div class="ibox-title"><h5>Trade History</h5><div class="ibox-tools" ng-if="$root.exportShow"><a type="button" class="btn btn-sm btn-primary" href="{{historyFilePath}}" download="{{historyFileName}}">Export</a></div></div><div class="ibox-content"><div class="table-responsive"><table class="table table-striped"><thead><tr><th>Trade Date</th><th>Symbol</th><th>SIDE</th><th>Duration</th><th class="hidden-xs">QTY</th><th class="hidden-xs">Buy Price</th><th class="hidden-xs">Sell Price</th><th>P&L</th></tr></thead><tbody><tr ng-repeat="trade in userClosedList"><td>{{trade.TRADE_DATE|date:\'yyyy-MM-dd\'}}</td><td>{{trade.SYMBOL}}</td><td>{{sideMap[trade.ObjId]["side"]}}</td><td><span ng-if="sideMap[trade.ObjId]">{{(trade.CREATED - sideMap[trade.ObjId]["ts"]) | amDurationFormat : \'minutes\'}}</span></td><td class="hidden-xs">{{trade.QTY}}</td><td class="hidden-xs">{{trade.BUY_PRICE}}</td><td class="neg-number">{{trade.SELL_PRICE}}</td><td>{{trade.AC_PNL|number:2}}</td></tr></tbody></table><div class="text-center"><div ng-show="closeListLoading"><i class="fa fa-spinner fa-spin"></i></div><button type="button" class="btn btn-sm btn-info" ng-class="userClosedList.length>0?\'\':\'disabled\'" ng-click="loaded=true;loadMore()" ng-hide="loaded">Load More</button></div></div></div></div></div>'),e.put("components/user/user_profile.html",'<div class="wrapper wrapper-content animated fadeInRight" ng-hide="$root.simShow"><h3>No access for this account</h3></div><div class="wrapper wrapper-content animated fadeInRight" ng-controller="UserProfileCtrl" ng-if="$root.simShow"><div class="row" ng-hide="hasUserId"><div class="col-md-3"><div class="input-group"><input type="text" class="form-control" ng-model="inputUserId" placeholder="Please enter a user id"> <span class="input-group-btn"><button type="button" class="btn btn-primary" ng-click="loadData()">Go!</button></span></div></div><div class="col-md-1"><select class="input-sm form-control input-s-sm inline product-option" ng-options="product.name for product in products" ng-model="productSelected"></select></div><div class="col-md-1"><select class="input-sm form-control input-s-sm inline product-option" ng-options="region.name for region in regions" ng-model="regionSelected"></select></div></div><div class="row m-b-lg m-t-lg"><div class="col-md-4"><div class="profile-image"><img src="{{user.serving_url || \'http://www.hkfdt.cn/favicon.ico\'}}" class="img-circle circle-border m-b-md" alt="profile"></div><div class="profile-info"><div class=""><div><h2 class="no-margins">{{user.USERNAME}}</h2><h4>{{user.school_name}}</h4><small><span ng-if="$root.exportShow">Contact: {{user.EMAIL|| user.PHONE}}</span><br>Join at: {{user.CREATED | date:\'yyyy-MM-dd\'}}<br>Last Active: {{userLastLogin.LOGINAT | date:\'yyyy-MM-dd @ h:mma\'}}<br>Country: <img width="15" ng-show="user.COUNTRY" src="http://lipis.github.io/flag-icon-css/flags/4x3/{{user.COUNTRY| lowercase}}.svg"><br></small></div></div></div><table class="table small m-b-xs accounts-table"><tbody><tr><td><strong>{{acc.UNIT_PRICE * acc.CASH_DEPOSITED | currency:"$"}}</strong><div>Account Value</div></td><td><strong>{{acc.CASH | currency:"$"}}</strong><div>Cash Value</div></td></tr><tr><td><strong ng-show="acc.UNIT_PRICE">{{(acc.UNIT_PRICE - 1 ) * 100|number:2}}%</strong><div>ROI</div></td><td><strong>{{acc.TradesCount}}</strong><div>Total Trades</div></td></tr><tr><td><strong>{{acc.Ranking}}</strong><div>Ranking</div></td><td><strong>{{acc.RankingPer}}%</strong><div>Ranking Percentage</div></td></tr><tr><td><strong>{{acc.BiggestWin}}</strong><div>Biggest Win</div></td><td><strong>{{acc.BiggestLoss}}</strong><div>Biggest Loss</div></td></tr><tr><td><strong>{{acc.WinRatio}}%</strong><div>Win Ratio</div></td><td><strong>{{acc.CASH_AVAILABLE | currency:"$"}}</strong><div>Available Cash</div></td></tr><tr ng-show="userSetting"><td><strong>{{userSetting.DEFAULT_QTY}}</strong><div>Quick Trade QTY</div></td><td><strong>{{userSetting.STOP_LOSS_VALUE | currency:"$"}}</strong><div>Position Stop Loss</div></td></tr><tr ng-show="userSetting"><td><strong>{{userSetting.DAILY_STOPLOSS | currency:"$"}}</strong><div>Daily Stop Loss</div></td><td><strong>{{userSetting.TRAILING_STOP | currency:"$"}}</strong><div>Trailing Stop</div></td></tr></tbody></table><highchart config="chartConfig" class="user-roi-chart"></highchart><highchart config="chartRankingConfig" class="user-roi-chart"></highchart><highchart config="chartValueConfig" class="user-roi-chart"></highchart><highchart config="chartLoginConfig" class="user-roi-chart"></highchart></div><div class="col-md-8"><div class="row"><div class="col-md-6" ng-show="beta"><highchart config="chartRadarRiskPreferenceConfig"></highchart></div><div class="col-md-6" ng-show="beta"><highchart config="chartRadarFDTScoreConfig"></highchart></div><div class="col-md-6" ng-show="beta"><highchart config="chartRadarProfitConfig"></highchart></div><div class="col-md-6" ng-show="beta"><div class="col-md-6 col-md-offset-3"><h4>Risk Control Score</h4></div><div class="col-md-3"><i class="fa fa-question-circle" tooltip-placement="left" tooltip="1）隔夜仓位控制 - overnight open-position control.计算交易员每个交易日对所有商品的仓位金额与资产的比例，然后对交易日做平均，最后做归一化.Calculate the ratio between the sum of all items\' open positions and asset at end of the trading day, and average them over all trading days, followed by normalisation. 2）最大仓位控制 - max open-position control.计算交易员下每笔订单后所有购买商品的仓位金额之和于资产的比例，取当天最大值，然后对交易日做平均，最后做归一化。Calculate the max ratio between of the sum of all items\' open position and asset for each coming order for each trading day, and average them over all trading days, followed by normalisation. 3) 收益回撤控制 - draw-down control.计算交易员历史上曾经历过的最大收益回撤值。对交易员的unit_price历史记录进行扫描，找到从最大的历史滑落值，并除以其unit_price最大值。MDD is the maximum value of the decline from the historical peak of the unit_price of a particular trader, normalised by the maximum value.4）损失波动控制 - loss variance control.计算日损失收益率的标准差.The standard deviation of daily PNL ratio.5）单笔损失控制 - order loss control.以在同一个商品上，两次空仓（empty position）中间的操作为一个交易序列，针对某一交易员在所有商品上进行的所有交易序列，找到净值损失最大的一次。Biggest_loss: define a trading series as all the trades between the timestamp of two consecutive empty positions, and for a particular trader, find the trading series with the biggest loss over all product."></i></div><br><highchart config="chartRadarConfig"></highchart></div></div><div class="row"><highchart config="chartTradesConfig" class="user-trade-chart"></highchart></div><div class="row"><div ng-include="\'components/user/user_closed_list.html\'"></div></div><div class="col-md-6"><highchart config="chartPieConfig"></highchart></div><div class="col-md-6" ng-hide="region==\'SEED\' || region==\'INC\'"><div class="table-responsive"><table class="table table-striped"><thead><tr><th class="hidden-xs">Joined Contests</th><th class="hidden-xs">Ranking</th></tr></thead><tbody><tr ng-repeat="contest in contestList"><td>{{contest.name}}</td><td>{{contest.RANKING}}</td></tr></tbody></table></div></div></div></div></div>'),e.put("components/user/user_score.html",'<div class="row" ng-controller="UserScoreCtrl"><div class="wrapper wrapper-content animated fadeInRight"><div class="row filterBar" ng-init="changeFt()"><div class="col-md-2"><select class="input-sm form-control input-s-sm inline product-option" ng-options="feature for feature in features" ng-model="featureSelected" ng-change="changeFt()"></select></div><div class="col-md-1"><select class="input-sm form-control input-s-sm inline product-option" ng-options="sortType for sortType in sortTypes" ng-model="sortTypeSelected" ng-change="changeFt()"></select></div><div class="col-md-1"><input ng-model="limitList" value="10" ng-model-options="{debounce: 1000}" class="userScorelimit" ng-change="changeFt()"> Limit</div><div class="col-md-2"><input ng-model="tradeCount" value="0" class="countFilter" ng-model-options="{debounce: 1000}" ng-change="changeFt()"> Trade Count</div><div class="col-md-2"><input ng-model="loginCount" value="0" class="countFilter" ng-model-options="{debounce: 1000}" ng-change="changeFt()"> Login Count</div><div class="col-md-2"><a type="button" class="btn btn-sm btn-primary" ng-click="compute()">Compute</a> <a type="button" class="btn btn-sm btn-success" ng-click="save()">Save</a></div></div><div ng-include="\'components/user/user_score_list.html\'"></div></div></div>'),e.put("components/user/user_score_list.html",'<div class="col-lg-2" ng-repeat="user in userList"><div class="contact-box center-version"><a href="#/index/profile/{{user.userId}}/CN/FC/beta"><img alt="image" class="img-circle" src="{{usersMap[user.userId].serving_url ||\'http://www.hkfdt.cn/favicon.ico\'}}"><h3 class="m-b-xs"><strong>{{usersMap[user.userId].USERNAME}}</strong></h3><address class="m-t-md"><strong>{{usersMap[user.userId].school_name}}</strong><br><abbr title="Phone">Score:</abbr> {{user["features"][featureSelected].normalized || user["scores"][featureSelected.split("Score")[0]]}}</address></a></div></div>'),e.put("app/main/main.html",'<div class="wrapper wrapper-content animated fadeInRight" ng-hide="$root.dashboardShow"><h3>Redirecting ...</h3></div><div class="wrapper wrapper-content animated fadeInRight" ng-if="$root.dashboardShow"><div ng-include="\'components/box/sumbox.html\'" ng-if="$root.roleRegion ==\'All\'"></div><div class="row chartPanel"><div ng-include="\'components/chart/chart_tu.html\'"></div></div><div class="row chartPanel" ng-if="$root.roleRegion ==\'All\'"><div ng-include="\'components/map/map.html\'"></div><div ng-include="\'components/chart/chart_global_dist.html\'"></div></div><div class="row chartPanel" ng-if="$root.roleRegion ==\'CN\' || $root.roleRegion ==\'All\'"><div ng-include="\'components/chart/chart_fx_fc_sc.html\'"></div></div><div class="row chartPanel" ng-if="$root.roleRegion ==\'CN\' || $root.roleRegion ==\'All\'"><div ng-include="\'components/chart/overlap.html\'"></div><div ng-include="\'components/chart/venn.html\'"></div></div><div ng-controller="TabsDemoCtrl" class="tab-bar"><tabset><tab heading="Overseas" ng-if="$root.roleRegion !=\'CN\' || $root.roleRegion ==\'All\'"><div class="row chartPanel"><div ng-include="\'components/chart/chart_gb_nu.html\'"></div></div></tab><tab heading="Mainland" ng-click="click()" ng-if="$root.roleRegion ==\'CN\' || $root.roleRegion ==\'All\'"><div class="row chartPanel"><div ng-include="\'components/chart/chart_cn_nu.html\'"></div></div></tab></tabset></div><div ng-controller="TabsDemoCtrl" class="tab-bar"><tabset><tab heading="Overseas" ng-if="$root.roleRegion !=\'CN\' || $root.roleRegion ==\'All\'"><div class="row chartPanel"><div ng-include="\'components/chart/chart_gb_au.html\'"></div></div></tab><tab heading="Mainland FX" ng-click="click()" ng-if="$root.roleRegion ==\'CN\' || $root.roleRegion ==\'All\'"><div class="row chartPanel"><div ng-include="\'components/chart/chart_cn_au_fx.html\'"></div></div></tab><tab heading="Mainland FC" ng-click="click()" ng-if="$root.roleRegion ==\'CN\' || $root.roleRegion ==\'All\'"><div class="row chartPanel"><div ng-include="\'components/chart/chart_cn_au_fc.html\'"></div></div></tab><tab heading="Mainland SC" ng-click="click()" ng-if="$root.roleRegion ==\'CN\' || $root.roleRegion ==\'All\'"><div class="row chartPanel"><div ng-include="\'components/chart/chart_cn_au_sc.html\'"></div></div></tab></tabset></div></div>'),e.put("components/incu/user_list.html",'<div class="wrapper wrapper-content animated fadeInRight" ng-hide="$root.incuShow"><h3>No access for this account</h3></div><div class="wrapper wrapper-content animated fadeInRight" ng-controller="IncUserListCrol" ng-if="$root.incuShow"><div class="row"><div class="col-lg-6"><div class="col-xs-8 text-left"><span>Daily Total P&L (including fee&commisions)</span><h1 class="font-bold">${{summaryObj.pnl | number:2}}</h1></div><div class="col-xs-4 text-left"><span>Daily Total QTY</span><h1 class="font-bold">{{summaryObj.qty | number}}</h1></div><div class="col-lg-12"><highchart config="chartPieConfig"></highchart></div></div><div class="col-lg-6"><div class="ibox float-e-margins"><div class="ibox-title"><h5>Daily Summary</h5><div class="ibox-tools"></div></div><div class="ibox-content"><div class="table-responsive"><table st-safe-src="summaryList" st-table="displayedSummary" class="table table-striped"><thead><tr><th>Trade Date</th><th>Symbol</th><th st-sort="ACCOUNT_VALUE" st-sort-default="reverse">QTY</th><th st-sort="PNL">P&L</th></tr></thead><tbody><tr ng-repeat="sum in displayedSummary"><td>{{sum["@TRADE_DATE"]}}</td><td>{{sum.SYMBOL}}</td><td>{{sum.QTY|number}}</td><td>{{sum.PNL|number:2}}</td></tr></tbody></table></div></div></div></div><div class="col-lg-12"><div class="ibox float-e-margins"><div class="ibox-title"><h5>Incubatee Daily Performance</h5><div class="ibox-tools" ng-if="$root.exportShow"><a type="button" class="btn btn-sm btn-primary" href="{{historyFilePath}}" download="{{historyFileName}}">Export</a></div></div><div class="ibox-content"><div class="table-responsive"><table st-safe-src="userList" st-table="displayed" class="table table-striped"><thead><tr><th colspan="5"><div class="input-group"><input st-search="USER_ID" class="form-control" placeholder="Search User ID ..." type="text"> <span class="input-group-btn"><button type="button" class="btn btn-sm btn-primary">Go!</button></span></div></th></tr><tr><th>Trade Date</th><th>User Id</th><th st-sort="ACCOUNT_VALUE" st-sort-default="reverse">Account Value</th><th st-sort="PNL">P&L</th><th st-sort="UR_PNL">UR_P&L</th><th st-sort="ALL_TIME_PNL">All Time P&L</th><th st-sort="SUMQTY">Total Qty</th><th st-sort="CNTQTY"># Qty</th><th st-sort="CASH">Cash</th><th st-sort="Ranking">Ranking</th><th st-sort="WinRatio">Win Ratio</th><th st-sort="BiggestWin">Biggest Win</th><th st-sort="BiggestLoss">Biggest Loss</th><th st-sort="AllTimeSharpRatio">All Time Sharp Ratio</th></tr></thead><tbody><tr ng-repeat="userInfo in displayed"><td>{{userInfo["@TRADE_DATE"]}}</td><td><a href="#/index/profile/{{userInfo.USER_ID}}/INC/FX">{{userInfo.USER_ID}}</a></td><td>{{userInfo.ACCOUNT_VALUE|number:2}}</td><td>{{userInfo.PNL|number:2}}</td><td>{{userInfo.UR_PNL|number:2}}</td><td>{{userInfo.ALL_TIME_PNL|number:2}}</td><td>{{userInfo.SUMQTY}}</td><td>{{userInfo.CNTQTY}}</td><td>{{userInfo.CASH|number:2}}</td><td>{{userInfo.Ranking}}</td><td>{{userInfo.WinRatio}}%</td><td>{{userInfo.BiggestWin|number:2}}</td><td>{{userInfo.BiggestLoss|number:2}}</td><td>{{userInfo.AllTimeSharpRatio|number:2}}%</td></tr></tbody><tfoot><tr><td colspan="5" class="text-center"><div st-pagination="" st-items-by-page="itemsByPage" st-displayed-pages="7"></div></td></tr></tfoot></table></div></div></div></div></div></div>'),e.put("components/school/contest.html",'<div class="col-lg-4" ng-controller="ContestCrol"><div class="ibox float-e-margins"><div class="ibox-title"><h5>School User In Contests</h5><div class="ibox-tools"><button type="button" class="btn btn-sm btn-primary">Export</button></div></div><div class="ibox-content"><div class="row"><div class="col-sm-3 m-b-xs"><select class="input-sm form-control input-s-sm inline product-option" ng-options="product.name for product in products" ng-model="selected" ng-change="changeProduct()"></select></div><div class="col-sm-3"></div></div><div class="table-responsive"><table class="table table-striped"><thead><tr><th class="hidden-xs">Contest Name</th><th class="hidden-xs"># Users</th></tr></thead><tbody><tr ng-repeat="contest in contestList"><td>{{contest.name}}</td><td>{{contest.count|number}}</td></tr></tbody></table></div></div></div></div>'),e.put("components/school/count.html",'<div class="col-lg-6 school-count-box"><div class="col-lg-3 text-center"><div class="widget style1"><div class="row"><i class="fa fa-user fa-3x"></i></div><div class="row"><span>Total Users</span><h2 class="font-bold" ng-bind="totalUser"></h2><span></span></div></div></div><div class="col-lg-9"><div class="row m-t-xs"><div class="col-xs-4"><h5 class="m-b-xs">Core Users 30 Days</h5><h1 class="no-margins" ng-bind-html="isChina?coreFX30 + coreSC30 + coreFC30:core30"></h1></div><div class="col-xs-4"><h5 class="m-b-xs">Weekly Active Users</h5><h1 class="no-margins">{{(weekUserFX + weekUserFC + weekUserSC)|number}}</h1></div><div class="col-xs-4"><h5 class="m-b-xs">Monthly Active Users</h5><h1 class="no-margins">{{(monthUserFX + monthUserFC + monthUserSC)|number}}</h1></div></div><table class="table small m-t-sm"><tbody><tr><td><i class="fa fa-key"></i> 60 Days <strong ng-bind-html="isChina?coreFX60 + coreSC60 + coreFC60:core60"></strong></td><td><i class="fa fa-money"></i> FX <strong ng-bind="weekUserFX"></strong></td><td><i class="fa fa-money"></i> FX <strong ng-bind="monthUserFX"></strong></td></tr><tr><td><i class="fa fa-key"></i> > 90 Days <strong ng-bind-html="isChina?coreFX90 + coreSC90 + coreFC90:core90"></strong></td><td ng-show="$root.regionSelected == \'CN\'"><i class="fa fa-line-chart"></i> FC <strong ng-bind="weekUserFC"></strong></td><td ng-show="$root.regionSelected == \'CN\'"><i class="fa fa-line-chart"></i> FC <strong ng-bind="monthUserFC"></strong></td></tr><tr ng-show="$root.regionSelected == \'CN\'"><td></td><td><i class="fa fa-bank"></i> SC <strong ng-bind="weekUserSC"></strong></td><td><i class="fa fa-bank"></i> SC <strong ng-bind="monthUserSC"></strong></td></tr></tbody></table></div></div>'),e.put("components/school/quant.html",'<div class="wrapper wrapper-content animated fadeInRight"><div class="row chartPanel" ng-controller="QuantCrol"><div class="col-lg-12"><highchart config="chartConfig"></highchart></div></div></div>'),e.put("components/school/school.html",'<div class="wrapper wrapper-content animated fadeInRight" ng-hide="$root.schoolShow"><h3>No access for this account</h3></div><div class="wrapper wrapper-content animated fadeInRight" ng-if="$root.schoolShow"><div class="row chartPanel" ng-controller="SchoolCtrl"><div class="row"><div class="col-md-2 selector pull-left"><ui-select ng-model="region.selected" on-select="onRegionSelect($item, $model)" theme="select2" class="form-control" title="Choose a Region"><ui-select-match placeholder="Select or search Region ...">{{$select.selected}}</ui-select-match><ui-select-choices repeat="item in regions | filter: $select.search"><div ng-bind-html="item | highlight: $select.search"></div><img width="19" src="http://lipis.github.io/flag-icon-css/flags/4x3/{{item| lowercase}}.svg"></ui-select-choices></ui-select></div><div class="col-md-3 selector pull-left" ng-show="school_show"><ui-select ng-model="school.selected" on-select="onSchoolSelect($item, $model)" theme="select2" class="form-control" title="Choose a School"><ui-select-match placeholder="Select or search a school name ...">{{$select.selected.school_name}}</ui-select-match><ui-select-choices repeat="school in schools | filter: $select.search"><div ng-bind-html="school.school_name | highlight: $select.search"></div><small ng-bind-html="school.school_key | highlight: $select.search"></small></ui-select-choices></ui-select></div><div class="col-md-2 compare-switch" ng-show="school_show"><span style="float:right">Compare mode</span><div class="switch"><div class="onoffswitch"><input type="checkbox" ng-model="isCompard" class="onoffswitch-checkbox" id="compared"> <label class="onoffswitch-label" for="compared"><span class="onoffswitch-inner"></span></label></div></div></div></div><div class="row"><div ng-include="\'components/school/count.html\'"></div><div ng-include="\'components/school/user_growth.html\'"></div></div></div><div class="row chartPanel"><div ng-include="\'components/school/user_rank.html\'"></div><div ng-include="\'components/school/contest.html\'"></div></div></div>'),e.put("components/school/user_growth.html",'<div class="col-lg-6"><highchart config="chartConfig" class="user-growth-chart"></highchart></div>'),e.put("components/school/user_rank.html",'<div class="col-lg-8" ng-controller="UserRankingCrol"><div class="ibox float-e-margins"><div class="ibox-title"><h5>School User Ranking(By ROI)</h5><div class="ibox-tools"><button type="button" class="btn btn-sm btn-primary">Export</button></div></div><div class="ibox-content"><div class="row"><div class="col-sm-3 m-b-xs"><select class="input-sm form-control input-s-sm inline product-option" ng-options="product.name for product in products" ng-model="selected" ng-change="changeProduct()"></select></div><div class="col-sm-3"></div></div><div class="table-responsive"><table class="table table-striped"><thead><tr><th></th><th>User Name</th><th class="hidden-xs">User Id</th><th class="hidden-xs">Register</th><th class="hidden-xs">Trade Count</th><th class="hidden-xs">Biggest Loss</th><th class="hidden-xs">Ranking</th><th>ROI %</th></tr></thead><tbody><tr ng-repeat="userInfo in userRankList"><td><img class="img-circle" src="{{userInfo.serving_url || \'http://www.hkfdt.cn/favicon.ico\'}}"></td><td><a href="#/index/profile/{{userInfo.user_id}}/{{$root.regionSelected}}/{{selected.name}}">{{userInfo.username | limitTo: 10}}</a></td><td class="hidden-xs">{{userInfo.user_id}}</td><td class="hidden-xs">{{userInfo.created|date}}</td><td class="hidden-xs">{{userInfo.tradescount|number}}</td><td class="neg-number">- {{userInfo.biggestloss|currency:"$"}}</td><td class="hidden-xs">{{userInfo.ranking}}</td><td>{{(userInfo.unit_price - 1 ) * 100|number:2}} %</td></tr></tbody></table><div class="text-center"><div ng-show="rankListLoading"><i class="fa fa-spinner fa-spin"></i></div><button type="button" class="btn btn-sm btn-info" ng-class="userRankList.length>0?\'\':\'disabled\'" ng-click="loaded=true;loadMore()" ng-hide="loaded">Load More</button></div></div></div></div></div>')
}]);