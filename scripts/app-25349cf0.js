"use strict";angular.module("inspinia",["ngAnimate","ngCookies","ngTouch","ngSanitize","ngResource","ui.router","ui.bootstrap","highcharts-ng","ui.select","angular-venn","angularMoment","smart-table","ngBootstrap"]).config(["$stateProvider","$urlRouterProvider",function(e,t){e.state("login",{"abstract":!0,url:"/login",templateUrl:"components/login/login.html"}).state("index",{"abstract":!0,url:"/index",templateUrl:"components/common/content.html"}).state("index.trader",{url:"/trader",templateUrl:"components/trader/trader_list.html"}).state("index.feature",{url:"/feature",templateUrl:"components/trader/feature.html"}).state("index.ra",{url:"/ra",templateUrl:"components/trader/alloc.html"}).state("index.school",{url:"/school",templateUrl:"components/school/school.html",data:{pageTitle:"School Analytics"}}).state("index.user",{url:"/userScore",templateUrl:"components/user/user_score.html",data:{pageTitle:"User Analytics"}}).state("index.profile",{url:"/profile/:userID/:region/:app",templateUrl:"components/user/user_profile.html",data:{pageTitle:"User Profile"}}).state("index.search",{url:"/profileSearch",templateUrl:"components/user/user_profile.html",data:{pageTitle:"User Profile"}}).state("index.incu",{url:"/incubatee",templateUrl:"components/incu/user_list.html",data:{pageTitle:"User List"}}).state("index.seed",{url:"/seed",templateUrl:"components/seed/user_list.html",data:{pageTitle:"Seed"}}).state("index.cmb",{url:"/cmb",templateUrl:"components/user/cmb_score.html",data:{pageTitle:"cmb"}}).state("index.stock",{url:"/stock",templateUrl:"components/trader/stock.html",data:{pageTitle:"stock"}}).state("index.stoploss",{url:"/stoploss",templateUrl:"components/trader/stoploss.html",data:{pageTitle:"stoploss"}}).state("index.core",{url:"/core",templateUrl:"components/user/core_user.html",data:{pageTitle:"core"}}).state("index.beta",{url:"/profile/:userID/:region/:app/:beta",templateUrl:"components/user/user_profile.html",data:{pageTitle:"User Profile Beta"}}).state("index.mt4",{url:"/mt4/:accountID",templateUrl:"components/user/mt4_profile.html",data:{pageTitle:"MT4 Profile Beta"}}).state("index.mt4users",{url:"/mt4users",templateUrl:"components/user/mt4_user.html",data:{pageTitle:"MT4 users"}}).state("index.quant",{url:"/quant",templateUrl:"components/school/quant.html",data:{pageTitle:"User Profile Beta"}}),t.otherwise("/index/trader")}]).run(["$http","$rootScope",function(e,t){e.get("getSession").success(function(e){var s=e.role;t.roleRegion=e.region,t.roleSchool=e.school,t.userNick=e.nick,t.ftShow=e.ftShow,s&&!e.core?(s=s.toString().split(""),t.dashboardShow="1"==s[0]?!0:!1,!t.firstAvailablePage&&t.dashboardShow&&(t.firstAvailablePage="#/index/main"),t.schoolShow="1"==s[1]?!0:!1,!t.firstAvailablePage&&t.schoolShow&&(t.firstAvailablePage="#/index/school"),t.incuShow="1"==s[2]?!0:!1,!t.firstAvailablePage&&t.incuShow&&(t.firstAvailablePage="#/index/incubatee"),t.seedShow="1"==s[3]?!0:!1,!t.firstAvailablePage&&t.seedShow&&(t.firstAvailablePage="#/index/seed"),t.simShow="1"==s[4]?!0:!1,!t.firstAvailablePage&&t.simShow&&(t.firstAvailablePage="#/index/profileSearch"),t.exportShow="1"==s[5]?!0:!1,"#/index/main"==location.hash&&(location.href=t.firstAvailablePage?t.firstAvailablePage:e.ftShow?"#/index/userScore":"upload.html")):(t.simShow=!0,location.href="#/index/profile/"+e.username+"/"+e.region+"/"+e.app),Highcharts.setOptions({global:{useUTC:!1}})})}]),angular.module("inspinia").controller("UserScoreCtrl",["$scope","$rootScope","$http","$q",function(e,t,s,a){function i(e,t){s.get(e+"&ft="+t.name).success(function(e){for(var s=[],a=0;a<e.length;a++)0!=e[a]._id&&s.push([e[a]._id,e[a].count]);t.chartObj.series=[],t.chartObj.series=[{type:"column",name:"# users between this range",data:s}]})}function o(t){for(var s in e.fts)i(t,e.fts[s])}function n(t){e[t]={options:{colors:["#1ab394"],chart:{backgroundColor:"rgba(255, 255, 255, 0.1)",zoomType:"x"},tooltip:{formatter:function(){return this.y+" # users feature "+this.x}},legend:{enabled:!1}},title:{text:""},xAxis:{title:{text:t+" Distrubtion"}},yAxis:{labels:{enabled:!0},title:{text:null}},tooltip:{headerFormat:"<b>{series.name}</b><br>",pointFormat:"{point.x:%e. %b}: {point.y:.f} users"},plotOptions:{area:{color:"#0038ff",marker:{enabled:null},lineWidth:1,states:{hover:{lineWidth:1}},threshold:null}},credits:{enabled:!1}}}function r(){var e=a.defer();return s.get("getAllContestByApp?db=TW&app=FX").success(function(t){for(var s in t)t[s].name&&(g[t[s].contest_id]={name:t[s].name,icon_image:t[s].icon_image});e.resolve()}),e.promise}function l(){var e=a.defer();return s.get("getAllContestByApp?db=TW&app=FT").success(function(t){for(var s in t)t[s].name&&(g[t[s].contest_id]={name:t[s].name,icon_image:t[s].icon_image});e.resolve()}),e.promise}function c(){var e=a.defer();return s.get("getAllContestByApp?db=CN&app=FX").success(function(t){for(var s in t)t[s].name&&(g[t[s].contest_id]={name:t[s].name,icon_image:t[s].icon_image});e.resolve()}),e.promise}function d(){var e=a.defer();return s.get("getAllContestByApp?db=CN&app=FC").success(function(t){for(var s in t)t[s].name&&(g[t[s].contest_id]={name:t[s].name,icon_image:t[s].icon_image});e.resolve()}),e.promise}function h(){var e=a.defer();return s.get("getAllContestByApp?db=CN&app=SC").success(function(t){for(var s in t)t[s].name&&(g[t[s].contest_id]={name:t[s].name,icon_image:t[s].icon_image});e.resolve()}),e.promise}function p(){for(var t=0;t<e.userList.length;t++)s.get("getUserInfo?db="+e.contestSelected.region+"&userID="+e.userList[t].user_id).success(function(t){if(t&&t.length>0){var s=t[0];e.usersMap[s.USERID]=s}})}var g={};e.distShow=!1,e.fts=[];var u=["ft_avg_ngt_op","ft_std_op_qty","ft_df_qty","ft_active_ratio","ft_var","ft_trade_cnt","ft_tmdd","ft_roll_price","ft_bgw","ft_mdd","ft_bgl","ft_up","ft_avg_dr","ft_std_neg_pnlr","ft_avg_max_op","ft_streak","ft_active_ratio_sldwnd","ft_win_ratio","ft_trade_cnt_pday","ft_tdlf","ft_login_cnt","ft_cp_streak","ft_std_op_dr","ft_login_cnt_pday","ft_shp_rt","ft_tdd"];for(var m in u)n(u[m]),e.fts.push({chartObj:e[u[m]],name:u[m]});e.changeFt=function(t){t&&(e.contestSelected=t),e.contestSelected.contestID&&"fsw_sim_default"==e.weightSelected&&(e.weightSelected=e.weightFiles[1]),e.contestSelected.contestID||"fsw_simc_1"!=e.weightSelected&&"fsw_day_trade"!=e.weightSelected&&"fsw_inc_1"!=e.weightSelected||(e.weightSelected=e.weightFiles[0]),"SEEDSC"==e.contestSelected.region&&(e.weightSelected="fsw_day_trade"),"INC"==e.contestSelected.region&&(e.weightSelected="fsw_inc_1"),e.userList=[];var a="getFDTScoreList?wt_tg="+e.weightSelected+"&sort="+e.featureSelected+"&col="+e.contestSelected.id+"&ap_tag="+e.contestSelected.source+"&region="+e.contestSelected.region+"&limit="+e.limitList+"&desc="+e.sortTypeSelected+(e.incubatee?"&arena=incubatee":"");e.downLoadUrl=a+"&format=csv",e.contestSelected.source.indexOf("_sim_all")>=0&&e.contestSelected.id.indexOf("prod")>=0&&(e.downLoadUrl="downloadInc?app="+e.contestSelected.source.replace("_sim_all","")+"&region="+(e.contestSelected.id.indexOf("global")>=0?"global":"china")),s.get(a).success(function(t){e.userList=t,p(),e.chartScoreDistConfig.series=[],e.chartProfDistConfig.series=[],e.chartRiskDistConfig.series=[],e.chartActDistConfig.series=[],e.chartConsiDistConfig.series=[],s.get(a+"&dist=fdt").success(function(t){for(var s=[],a=0;a<t.length;a++)0!=t[a]._id&&s.push([t[a]._id,t[a].count]);e.chartScoreDistConfig.series.push({type:"column",name:"# users between this range",data:s})}),s.get(a+"&dist=profitability").success(function(t){for(var s=[],a=0;a<t.length;a++)0!=t[a]._id&&s.push([t[a]._id,t[a].count]);e.chartProfDistConfig.series.push({type:"column",name:"# users between this range",data:s})}),s.get(a+"&dist=consistency").success(function(t){for(var s=[],a=0;a<t.length;a++)0!=t[a]._id&&s.push([t[a]._id,t[a].count]);e.chartConsiDistConfig.series.push({type:"column",name:"# users between this range",data:s})}),s.get(a+"&dist=riskCtrl").success(function(t){for(var s=[],a=0;a<t.length;a++)0!=t[a]._id&&s.push([t[a]._id,t[a].count]);e.chartRiskDistConfig.series.push({type:"column",name:"# users between this range",data:s})}),s.get(a+"&dist=activity").success(function(t){for(var s=[],a=0;a<t.length;a++)0!=t[a]._id&&s.push([t[a]._id,t[a].count]);e.chartActDistConfig.series.push({type:"column",name:"# users between this range",data:s})}),e.distShow&&o(a)})},e.changeProd=function(t){e.changeFt(t)},e.initProd=function(){e.contests=[],l().then(function(){r()}).then(function(){c()}).then(function(){h()}).then(function(){d()}).then(function(){s.get("queryContestByApp?prod="+e.productSelected).success(function(s){for(var a in s){var i={name:s[a].source+" - "+s[a].col,id:s[a].col,source:s[a].source,region:"CN"};s[a].col.indexOf("_test")>=0||(s[a].col.indexOf("_inc")>=0&&(i.region="INC"),s[a].col.indexOf("_seed")>=0&&(i.region="SEED"),s[a].col.indexOf("sc_china_seed")>=0&&(i.region="SEEDSC"),s[a].source&&s[a].source.indexOf("sim_all")>=0&&(i.name="中国"+(s[a].col.indexOf("fx")>=0?"外汇":s[a].col.indexOf("fc")>=0?"期货":"股票")+(s[a].col.indexOf("seed")>=0?"种子":s[a].col.indexOf("inc")>=0?"孵化器":"模拟")+"用户"),s[a].source&&s[a].source.indexOf("simc_")>=0?(i.contestID=s[a].source.split("simc_")[1],g[i.contestID]&&(i.name=g[i.contestID].name,i.icon_image=g[i.contestID].icon_image)):i.icon_image="https://lh3.googleusercontent.com/UYcLH0TfhavUG0BUl_7GtUhOpy8RQlPA1SepFY2v4XLNp3QlXkikOFfIrETmBRPcckQ=w300-rw",("INC"!=i.region||!t.incuShow||"CN"!=t.roleRegion&&"All"!=t.roleRegion)&&("SEED"!=i.region&&"SEEDSC"!=i.region||!t.seedShow&&!t.ftShow||"CN"!=t.roleRegion&&"All"!=t.roleRegion)?"CN"!=i.region||"CN"!=t.roleRegion&&"All"!=t.roleRegion||!t.simShow||e.contests.push(i):e.contests.push(i))}e.contestSelected=e.contests[0],e.weightFiles=["fsw_sim_default","fsw_simc_1","fsw_all_tune","fsw_con_tune","fsw_day_trade","fsw_inc_1","fsw_inc_2","fsw_inc_aggrsv","fsw_inc_blnce","fsw_inc_cnsvtv","fsw_inc_shp","fsw_inc_w_op","fsw_inc_w_op_dr"],e.weightSelected=e.weightFiles[0],e.changeFt()}),s.get("queryContestByApp?prod="+e.productSelected+"&region=Global").success(function(s){for(var a in s){var i={name:s[a].source+" - "+s[a].col,id:s[a].col,source:s[a].source,region:"Global"};s[a].col.indexOf("ft_global_seed")>=0&&(i.region="SEEDFT"),s[a].source&&s[a].source.indexOf("sim_all")>=0&&(i.name="全球"+(s[a].col.indexOf("fx")>=0?"外匯":"台灣期货")+(s[a].col.indexOf("seed")>=0?"种子":s[a].col.indexOf("inc")>=0?"孵化器":"模拟")+"用户"),s[a].col.indexOf("_test")>=0||(s[a].source&&s[a].source.indexOf("simc_")>=0?(i.contestID=s[a].source.split("simc_")[1],g[i.contestID]&&(i.name=g[i.contestID].name,i.icon_image=g[i.contestID].icon_image)):i.icon_image="https://avatars0.githubusercontent.com/u/18319956?v=3&s=200",t.ftShow&&s[a].col.indexOf("ft")>=0&&"CN"!=t.roleRegion?e.contests.push(i):t.ftShow||"CN"==t.roleRegion||e.contests.push(i))}})})},e.limitList=10,e.loginCount=0,e.tradeCount=0,e.features=["fdt","riskCtrl","riskPref","consistency","activity","profitability","ft_bgl","ft_mdd","ft_avg_max_op","ft_avg_nt_op","ft_std_neg_pnlr","ft_df_qty","ft_avg_dr","ft_avg_max_op","ft_up","ft_bgw","ft_std_op_qty","ft_std_op_dr","ft_login_cnt","ft_trade_cnt"],e.sortTypes=["Top","Tail","Random"],e.usersMap={},e.featureSelected=e.features[0],e.sortTypeSelected=e.sortTypes[0],e.chartScoreDistConfig={options:{colors:["#1ab394"],chart:{backgroundColor:"rgba(255, 255, 255, 0.1)",zoomType:"x"},tooltip:{formatter:function(){return this.y+" # users score "+this.x}},legend:{enabled:!1}},title:{text:""},xAxis:{title:{text:"FDT Score Distrubtion"}},yAxis:{labels:{enabled:!0},title:{text:null}},tooltip:{headerFormat:"<b>{series.name}</b><br>",pointFormat:"{point.x:%e. %b}: {point.y:.f} users"},plotOptions:{area:{color:"#0038ff",marker:{enabled:null},lineWidth:1,states:{hover:{lineWidth:1}},threshold:null}},credits:{enabled:!1}},e.chartProfDistConfig={options:{colors:["#1ab394"],chart:{backgroundColor:"rgba(255, 255, 255, 0.1)",zoomType:"x"},tooltip:{formatter:function(){return this.y+" # users score "+this.x}},legend:{enabled:!1}},title:{text:""},xAxis:{title:{text:"Profitability Score Distrubtion"}},yAxis:{labels:{enabled:!0},title:{text:null}},tooltip:{headerFormat:"<b>{series.name}</b><br>",pointFormat:"{point.x:%e. %b}: {point.y:.f} users"},plotOptions:{area:{color:"#0038ff",marker:{enabled:null},lineWidth:1,states:{hover:{lineWidth:1}},threshold:null}},credits:{enabled:!1}},e.chartRiskDistConfig={options:{colors:["#1ab394"],chart:{backgroundColor:"rgba(255, 255, 255, 0.1)",zoomType:"x"},tooltip:{formatter:function(){return this.y+" # users score "+this.x}},legend:{enabled:!1}},title:{text:""},xAxis:{title:{text:"Risk Control Score Distrubtion"}},yAxis:{labels:{enabled:!0},title:{text:null}},tooltip:{headerFormat:"<b>{series.name}</b><br>",pointFormat:"{point.x:%e. %b}: {point.y:.f} users"},plotOptions:{area:{color:"#0038ff",marker:{enabled:null},lineWidth:1,states:{hover:{lineWidth:1}},threshold:null}},credits:{enabled:!1}},e.chartConsiDistConfig={options:{colors:["#1ab394"],chart:{backgroundColor:"rgba(255, 255, 255, 0.1)",zoomType:"x"},tooltip:{formatter:function(){return this.y+" # users score "+this.x}},legend:{enabled:!1}},title:{text:""},xAxis:{title:{text:"Consistency Score Distrubtion"}},yAxis:{labels:{enabled:!0},title:{text:null}},tooltip:{headerFormat:"<b>{series.name}</b><br>",pointFormat:"{point.x:%e. %b}: {point.y:.f} users"},plotOptions:{area:{color:"#0038ff",marker:{enabled:null},lineWidth:1,states:{hover:{lineWidth:1}},threshold:null}},credits:{enabled:!1}},e.chartActDistConfig={options:{colors:["#1ab394"],chart:{backgroundColor:"rgba(255, 255, 255, 0.1)",zoomType:"x"},tooltip:{formatter:function(){return this.y+" # users score "+this.x}},legend:{enabled:!1}},title:{text:""},xAxis:{title:{text:"Activity Score Distrubtion"}},yAxis:{labels:{enabled:!0},title:{text:null}},tooltip:{headerFormat:"<b>{series.name}</b><br>",pointFormat:"{point.x:%e. %b}: {point.y:.f} users"},plotOptions:{area:{color:"#0038ff",marker:{enabled:null},lineWidth:1,states:{hover:{lineWidth:1}},threshold:null}},credits:{enabled:!1}}}]),angular.module("inspinia").controller("UserProfileCtrl",["$scope","$rootScope","$http","$stateParams",function(e,t,s,a){function i(t){console.info(t),e.selectTradeDates=t,e.filteredList=[];for(var s=0;s<e.closedList.length;s++)moment(e.closedList[s].TRADE_DATE).format("YYYY-MM-DD")==t&&e.filteredList.push(e.closedList[s]);console.info(e.filteredList),e.$apply()}function o(t,a,i){for(var o=[],n=[],r=0,l=0;l<e.closedList.length;l++)50>r?(r++,o.push(e.closedList[l].ObjId)):(n.push(o),o=[e.closedList[l].ObjId],r=0);0==n.length&&o.length>0&&n.push(o);for(var c in n){var d=n[c];s.post("getTradeSide?userID="+i,{db:a,app:t,objIds:d}).success(function(t){if(t)for(var s in t)e.sideMap[t[s].OBJECT_ID]={side:"Buy"==t[s].SIDE?"Long":"Short",ts:moment(t[s].CREATED).toDate().getTime()/6e4}})}}function n(t,i,n,u,m){function f(){var a=e.dateRangeChanged?"trade_date="+moment(e.dateRange.endDate).format("YYYY-MM-DD")+"&":"";s.get("getScoreDisplay").success(function(o){var m=o;s.get("getUserFeatures?"+a+"col="+n.toLowerCase()+"&debug=true&allScores=true&userID="+t+"&region="+i+"&app_id="+n.toLowerCase()+"&contest_id="+u+(e.seedsc?"&wt_tg=fsw_day_trade":"")+("INC"==i?"&wt_tg=fsw_inc_1":"")).success(function(t){if(0==t.length)console.info("no fdt score"),e.chartRadarFDTScoreConfig.series=[],e.chartSeedSCScoreConfig.series=[],e.chartSeedStyleScoreConfig.series=[],e.chartRadarRiskPreferenceConfig.series=[],e.chartRadarProfitConfig.series=[],e.chartRadarConfig.series=[],e.chartRadarFDTScoreConfig.title={text:"FDT Score is computing"},e.chartSeedStyleScoreConfig.title={text:"Trader Styles"};else{var s={};e.contestScoresList=[];for(var a in t)t[a].ap_tg.indexOf("sim_all")>=0?s=t[a]:t[a].ap_tg&&t[a].ap_tg.split("_").length>2&&(t[a].contestId=t[a].ap_tg.split("_")[2],e.contestScoresList.push(t[a]));u&&e.contestScoresList&&e.contestScoresList.length>0&&(s=e.contestScoresList[0]),console.info(e.contests);var i=[],o=[],n=m.risk_control.features;for(var a in n){var f=s[n[a].feature];i.push(f?{y:f.score,ori:f.raw}:0),h.push(n[a].name)}e.chartRadarConfig.series=[{type:"area",name:"Risk Control Score",data:i,pointPlacement:"on"}],n=m.profitability.features;for(var a in n){var f=s[n[a].feature];o.push(f?{y:f.score,ori:f.raw}:0),r.push(n[a].name)}e.chartRadarProfitConfig.series=[{type:"area",name:"Profitability Score",data:o,pointPlacement:"on"}],e.chartRadarRiskPreferenceConfig.series=[];var b=[];n=m.risk_preference.features;for(var a in n){var f=s[n[a].feature];if(f){var v=f.score;n[a].reversedFrom&&(v=n[a].reversedFrom-f.score),b.push({y:v,ori:f.raw})}else b.push(0);p.push(n[a].name)}e.chartRadarRiskPreferenceConfig.series=[{type:"area",name:"Risk Preference Score",data:b,pointPlacement:"on"}];var y=[];n=m.activity.features;for(var a in n){var f=s[n[a].feature];if(f){var v=f.score;y.push({y:v,ori:f.raw})}else y.push(0);g.push(n[a].name)}e.chartRadarActivityConfig.series=[{type:"area",name:"Activity Score",data:y,pointPlacement:"on"}],e.chartRadarFDTScoreConfig.series=[];var _=[];e.chartRadarFDTScoreConfig.title={text:"FDT Score: "+s.fdt.score.toFixed(2)},e.chartSeedSCScoreConfig.title={text:"FDT Score: "+s.fdt.score.toFixed(2)},n=m.fdt_score.features;for(var a in n){var f=s[n[a].feature];_.push(f?{y:f.score,ori:f.raw}:0),l.push(n[a].name)}var C=[],x=[];n=m.seedsc.fdt_score.features;for(var a in n){var f=s[n[a].feature];C.push(f?{y:f.score,ori:f.raw,weight:f.weight}:0),c.push(n[a].name)}n=m.seedsc.styles.features;for(var a in n){var f=s[n[a].feature];x.push(f?{y:f.score,ori:f.raw,weight:f.weight}:0),d.push(n[a].name)}e.chartRadarFDTScoreConfig.series=[{type:"area",name:"FDT Score",data:_,pointPlacement:"on"}],e.chartSeedSCScoreConfig.series=[{type:"area",name:"FDT Score",data:C,pointPlacement:"on"}],e.chartSeedStyleScoreConfig.series=[{type:"area",name:"Trader Styles",data:x,pointPlacement:"on"}]}})})}e.beta=a.beta,e.region=a.region,e.historyFilePath="getClosedTrades?format=csv&userID="+t+"&db="+i+"&app="+n+(m?"&refresh=true":""),e.historyFileName=t+".csv",s.get("getClosedTrades?userID="+t+"&db="+i+"&app="+n+(m?"&refresh=true":"")).success(function(s){var a=[];for(var r in s)moment(s[r].TRADE_DATE)>=e.dateRange.startDate&&moment(s[r].TRADE_DATE)<=e.dateRange.endDate&&(s[r].ObjId=s[r].POSITION_ID.split("_")[0],s[r].CREATED=moment(s[r].CREATED).toDate().getTime()/6e4,a.push(s[r]));a.sort(function(e,t){return Date.parse(e.TRADE_DATE)-Date.parse(t.TRADE_DATE)}),a=a.reverse(),e.closedList=a,e.rankListLoading=!1,e.loaded=!1,e.userClosedList=a,o(n,i,t)}),"SEED"!=i&&"INC"!=i&&s.get("getContestByApp?userID="+t+"&db="+i+"&app="+n).success(function(t){e.contestList=t}),s.get("getUserLastLogin?userID="+t+"&db="+i+"&app="+n+(m?"&refresh=true":"")).success(function(t){e.userLastLogin=t[0]}),s.get("getUserAccountSetting?userID="+t+"&db="+i+"&app="+n+(m?"&refresh=true":"")).success(function(t){e.userSetting=t[0]}),e.chartPNLConfig.series=[],e.seedsc&&(s.get("getSeedSCStat?type=eff&userID="+t+"&db="+i+"&app="+n+(m?"&refresh=true":"")).success(function(t){e.chartPNLConfig.series=[];for(var s=[],a=0;a<t.length;a++)s.push([Date.parse(t[a].trade_date),parseFloat(t[a].daily_eff)]);e.chartPNLConfig.series.push({type:"bar",name:"Daily P&L Efficiency",data:s})}),s.get("getSeedSCStat?type=commision&userID="+t+"&db="+i+"&app="+n+(m?"&refresh=true":"")).success(function(t){e.chartCommisionConfig.series=[];for(var s=[],a=0;a<t.length;a++)s.push([Date.parse(t[a].trade_date),parseFloat(t[a].daily_commission)]);e.chartCommisionConfig.series.push({type:"bar",name:"Daily Commision",color:"#f8ac59",data:s})}),s.get("getSeedSCStat?type=pos&userID="+t+"&db="+i+"&app="+n+(m?"&refresh=true":"")).success(function(t){e.stats_pos=t}),s.get("getSeedSCStat?type=pnl&userID="+t+"&db="+i+"&app="+n+(m?"&refresh=true":"")).success(function(t){e.stats_pnl=t})),s.get("getUserAccDaily?userID="+t+"&db="+i+"&app="+n+(m?"&refresh=true":"")).success(function(t){var s=[],a=[],i=[],o=[],n=[],r=[],l=[];e.chartConfig.series=[],e.chartValueConfig.series=[],e.chartRankingConfig.series=[],e.chartRollPriceConfig.series=[],e.chartTradeCountConfig.series=[];for(var c=0;c<t.length;c++)moment(t[c].TRADE_DATE)>=e.dateRange.startDate&&moment(t[c].TRADE_DATE)<=e.dateRange.endDate&&(s.push(e.seedsc?[Date.parse(t[c].TRADE_DATE),parseFloat(t[c].ALL_TIME_PNL)]:[Date.parse(t[c].TRADE_DATE),100*(parseFloat(t[c].UNIT_PRICE)-1)]),i.push([Date.parse(t[c].TRADE_DATE),parseFloat(t[c].CASH)]),a.push([Date.parse(t[c].TRADE_DATE),parseFloat(t[c].UNIT_PRICE)*parseFloat(t[c].CASH_DEPOSITED)]),o.push([Date.parse(t[c].TRADE_DATE),parseInt(t[c].Ranking)]),e.seedsc||n.push([Date.parse(t[c].TRADE_DATE),parseInt(t[c].PNL)]),r.push([Date.parse(t[c].TRADE_DATE),parseInt(t[c].UR_PNL)]),l.push([Date.parse(t[c].TRADE_DATE),parseFloat(t[c].ROLL_PRICE)]));if(t&&t.length>0){if(e.dateRange&&e.dateRange.endDate)for(var c in t)e.acc=moment(t[c].TRADE_DATE).format("YYYYMMDD")==moment(e.dateRange.endDate).format("YYYYMMDD")?t[c]:t[0];e.refresh=!1}e.accFirstDate=Date.parse(new Date(t[t.length-1].TRADE_DATE)),e.chartConfig.series.push({type:"area",name:e.seedsc?"All Time P&L":"ROI",data:s}),e.chartRankingConfig.series.push({type:"line",name:"Ranking",data:o}),e.chartValueConfig.series.push({type:"line",name:"Account Value",data:a},{type:"line",name:"Cash Value",data:i}),e.chartRollPriceConfig.series.push({type:"line",name:"Roll Price",data:l}),e.chartTradeCountConfig.series.push({type:"line",name:"UR_PNL",data:r}),e.seedsc||e.chartPNLConfig.series.push({type:"line",name:"Daily P&L",data:n})}),e.chartPieConfig.series=[],s.get("getUserOpenPositions?userID="+t+"&db="+i+"&app="+n+(m?"&refresh=true":"")).success(function(t){var s=[];for(var a in t)s.push({name:t[a].SYMBOL,y:Math.abs(t[a].qty),sign:t[a].qty>=0?"":"-"});e.chartPieConfig.series.push({type:"pie",name:"Open Positions",data:s,pointPlacement:"on"})}),s.get("getDailyLogin?userID="+t+"&db="+i+"&app="+n+(m?"&refresh=true":"")).success(function(t){var s=[];e.chartLoginConfig.series=[];for(var a=0;a<t.length;a++)moment(t[a].date)>=e.dateRange.startDate&&moment(t[a].date)<=e.dateRange.endDate&&s.push([Date.parse(t[a].date),t[a].count]);e.chartLoginConfig.series.push({type:"column",name:"App Open Times",data:s})}),s.get("getDailyTrades?userID="+t+"&db="+i+"&app="+n+(m?"&refresh=true":"")).success(function(t){var s=[],a=[];e.chartTradesConfig.series=[];for(var i=0;i<t.length;i++)moment(t[i].trade_date)>=e.dateRange.startDate&&moment(t[i].trade_date)<=e.dateRange.endDate&&(s.push([Date.parse(t[i].trade_date),parseInt(t[i].tradeCount)-parseInt(t[i].fillCount)]),a.push([Date.parse(t[i].trade_date),parseInt(t[i].fillCount)]));e.chartTradesConfig.series.push({name:"New/Cancel",data:s},{name:"Filled",data:a})}),e.chartRadarConfig.series=[],e.chartRadarProfitConfig.series=[],f(),setTimeout(function(){window.dispatchEvent(new Event("resize"))},100)}Highcharts.setOptions({global:{useUTC:!1}}),e.seedsc="SEEDSC"==a.region&&"SC"==a.app,e.contests={},s.get("getAllContestByApp?db=TW&app=FX").success(function(t){for(var s in t)t[s].name&&(e.contests[t[s].contest_id]=t[s])}),s.get("getAllContestByApp?db=CN&app=FX").success(function(t){for(var s in t)t[s].name&&(e.contests[t[s].contest_id]=t[s])}),s.get("getAllContestByApp?db=CN&app=FC").success(function(t){for(var s in t)t[s].name&&(e.contests[t[s].contest_id]=t[s])}),s.get("getAllContestByApp?db=CN&app=SC").success(function(t){for(var s in t)t[s].name&&(e.contests[t[s].contest_id]=t[s])}),e.dateRange={startDate:moment(t.lastUpdate).subtract(2,"years"),endDate:new Date(t.lastUpdate)},e.products=[{name:"FX",id:"1"},{name:"FC",id:"2"},{name:"SC",id:"3"}],e.userClosedList=[],"All"==t.roleRegion?e.regions=[{name:"Global",id:"Global"},{name:"CN",id:"CN"}]:"CN"==t.roleRegion?e.regions=[{name:"CN",id:"CN"}]:"CN"!=t.roleRegion&&(e.regions=[{name:t.roleRegion,id:t.roleRegion}]),e.productSelected=e.products[0],e.regionSelected=e.regions[0],e.closedList=[],e.scoreProductSelected=e.products[0],e.loadMore=function(){e.userClosedList=e.closedList},e.sideMap={},e.filteredList=[],e.tradeDateCancelClick=function(){e.selectTradeDates=null,e.userClosedList=e.closedList},e.$watch("filteredList",function(){console.info("update close position list"),e.userClosedList=e.filteredList}),e.loadData=function(t){e.refresh=t;var i=a.userID||e.inputUserId,o="";a.userID&&a.userID.indexOf("_1_*1_*1_")>=0&&(o=a.userID.split("_1_*1_*1_")[0],i=a.userID.split("_1_*1_*1_")[1]),e.contestSelected&&e.contestSelected.CONTEST_ID&&(o=e.contestSelected.CONTEST_ID);var r=a.region||e.regionSelected.name,l=a.app||e.productSelected.name;e.db=r,e.app=l,s.get("getUserInfo?userID="+i+"&db="+r).success(function(a){a&&a.length>0?(e.user=a[0],e.joinDate=Date.parse(new Date(a[0].CREATED)),n(i,r,l,o,t)):s.get("getUserInfoByName?userName="+i+"&db="+r).success(function(s){e.user=s[0],n(s[0].USERID,r,l,o,t)})})},e.chartConfig={options:{colors:["#1ab394"],plotOptions:{series:{cursor:"pointer",point:{events:{click:function(){console.info(this.category);var e=moment(this.category).format("YYYY-MM-DD");i(e)}}}}},chart:{backgroundColor:"rgba(255, 255, 255, 0.1)",zoomType:"x"},legend:{enabled:!1}},title:{text:e.seedsc?"All Time P&L Trend":"ROI Trend"},xAxis:{type:"datetime",dateTimeLabelFormats:{month:"%b. %e",year:"%b"},title:{text:"Date"}},yAxis:{labels:{enabled:!0},title:{text:null}},tooltip:{headerFormat:"<b>{series.name}</b><br>",pointFormat:"{point.x:%e. %b}: {point.y:.f} users"},plotOptions:{area:{color:"#0038ff",marker:{enabled:null},lineWidth:1,states:{hover:{lineWidth:1}},threshold:null}},credits:{enabled:!1},series:e.chartSeries},e.chartValueConfig={options:{colors:["#1ab394","#f8ac59"],chart:{backgroundColor:"rgba(255, 255, 255, 0.1)",zoomType:"x"},legend:{enabled:!0}},title:{text:"Account & Cash Value Trend"},xAxis:{type:"datetime",dateTimeLabelFormats:{month:"%b. %e",year:"%b"},title:{text:"Date"}},yAxis:{labels:{enabled:!0},title:{text:null}},tooltip:{headerFormat:"<b>{series.name}</b><br>",pointFormat:"{point.x:%e. %b}: {point.y:.f} users"},plotOptions:{area:{color:"#0038ff",marker:{enabled:null},lineWidth:1,states:{hover:{lineWidth:1}},threshold:null}},credits:{enabled:!1},series:e.chartSeries},e.chartLoginConfig={options:{colors:["#1ab394"],chart:{backgroundColor:"rgba(255, 255, 255, 0.1)",zoomType:"x"},legend:{enabled:!1}},title:{text:"Login Activities"},xAxis:{type:"datetime",dateTimeLabelFormats:{month:"%b. %e",year:"%b"},title:{text:"Date"}},yAxis:{labels:{enabled:!0},title:{text:null}},tooltip:{headerFormat:"<b>{series.name}</b><br>",pointFormat:"{point.x:%e. %b}: {point.y:.f} users"},plotOptions:{area:{color:"#0038ff",marker:{enabled:null},lineWidth:1,states:{hover:{lineWidth:1}},threshold:null}},credits:{enabled:!1}},e.chartTradeCountConfig={options:{colors:["#1ab394"],chart:{backgroundColor:"rgba(255, 255, 255, 0.1)",zoomType:"x"},legend:{enabled:!1}},title:{text:"UR_P&L Trend"},xAxis:{type:"datetime",dateTimeLabelFormats:{month:"%b. %e",year:"%b"},title:{text:"Date"}},yAxis:{labels:{enabled:!0},title:{text:null}},tooltip:{headerFormat:"<b>{series.name}</b><br>",pointFormat:"{point.x:%e. %b}: {point.y:.f} users"},plotOptions:{area:{color:"#0038ff",marker:{enabled:null},lineWidth:1,states:{hover:{lineWidth:1}},threshold:null}},credits:{enabled:!1}},e.chartRollPriceConfig={options:{colors:["#1ab394"],chart:{backgroundColor:"rgba(255, 255, 255, 0.1)",zoomType:"x"},legend:{enabled:!1}},title:{text:"Roll Price"},xAxis:{type:"datetime",dateTimeLabelFormats:{month:"%b. %e",year:"%b"},title:{text:"Date"}},yAxis:{labels:{enabled:!0},title:{text:null}},tooltip:{headerFormat:"<b>{series.name}</b><br>",pointFormat:"{point.x:%e. %b}: {point.y:.f} users"},plotOptions:{area:{color:"#0038ff",marker:{enabled:null},lineWidth:1,states:{hover:{lineWidth:1}},threshold:null}},credits:{enabled:!1}},e.chartPNLConfig={options:{colors:["#1ab394"],chart:{backgroundColor:"rgba(255, 255, 255, 0.1)",zoomType:"x"},legend:{enabled:!1}},title:{text:e.seedsc?"Daily P&L Efficiency":"Daily PNL Trend"},xAxis:{type:"datetime",dateTimeLabelFormats:{month:"%b. %e",year:"%b"},title:{text:"Date"}},yAxis:{labels:{enabled:!0},title:{text:null}},tooltip:{headerFormat:"<b>{series.name}</b><br>",pointFormat:"{point.x:%e. %b}: {point.y:.f} users"},plotOptions:{area:{color:"#0038ff",marker:{enabled:null},lineWidth:1,states:{hover:{lineWidth:1}},threshold:null}},credits:{enabled:!1}},e.chartCommisionConfig={options:{chart:{backgroundColor:"rgba(255, 255, 255, 0.1)",zoomType:"x"},legend:{enabled:!1}},title:{text:"Daily Commision"},xAxis:{type:"datetime",dateTimeLabelFormats:{month:"%b. %e",year:"%b"},title:{text:"Date"}},yAxis:{labels:{enabled:!0},title:{text:null}},tooltip:{headerFormat:"<b>{series.name}</b><br>",pointFormat:"{point.x:%e. %b}: {point.y:.f} users"},plotOptions:{area:{color:"#0038ff",marker:{enabled:null},lineWidth:1,states:{hover:{lineWidth:1}},threshold:null}},credits:{enabled:!1}},e.chartTradesConfig={options:{colors:["#1ab394","#127E68"],chart:{backgroundColor:"rgba(255, 255, 255, 0.1)",zoomType:"x",type:"column"},plotOptions:{column:{stacking:"normal",depth:10}},tooltip:{headerFormat:"<b>{point.key}</b><br>",pointFormat:'<span style="color:{series.color}">●</span> {series.name}: {point.y} / {point.stackTotal}'}},title:{text:"Daily Trades"},xAxis:{type:"datetime",dateTimeLabelFormats:{month:"%b. %e",year:"%b"},title:{text:"Date"}},yAxis:{title:{text:"Trades"}},tooltip:{headerFormat:"<b>{series.name}</b><br>",pointFormat:"{point.x:%e. %b}: {point.y:.f} users"},legend:{enabled:!0},credits:{enabled:!1}},e.chartRankingConfig={options:{colors:["#1ab394"],chart:{backgroundColor:"rgba(255, 255, 255, 0.1)",zoomType:"x",type:"line"}},title:{text:"Daily Ranking"},xAxis:{type:"datetime",dateTimeLabelFormats:{month:"%b. %e",year:"%b"},title:{text:"Date"}},yAxis:{reversed:!0,title:{text:"Trades"}},tooltip:{headerFormat:"<b>{series.name}</b><br>",pointFormat:"{point.x:%e. %b}: {point.y:.f} users"},legend:{enabled:!0},credits:{enabled:!1}},e.chartPieConfig={options:{colors:["#1ab394","#90ee7e","#f45b5b","#7798BF","#aaeeee","#ff0066","#eeaaee","#55BF3B","#DF5353","#7798BF","#aaeeee"],chart:{backgroundColor:"rgba(255, 255, 255, 0.1)",style:{fontFamily:"'Unica One', sans-serif"},legend:{enabled:!0},plotBorderColor:"#606063",type:"pie",options3d:{enabled:!0,alpha:45,beta:0}},tooltip:{pointFormat:"Qty: <b>{point.sign}{point.y}</b> <br> {point.percentage:.1f} %"},plotOptions:{pie:{allowPointSelect:!0,cursor:"pointer",depth:35,dataLabels:{enabled:!0,format:"{point.name}"}}},rangeSelector:{buttonTheme:{fill:"white",stroke:"#C0C0C8","stroke-width":1,states:{select:{fill:"#D0D0D8"}}}},scrollbar:{trackBorderColor:"#C0C0C8"}},title:{text:"Open Positions"}};var r=[],l=[],c=[],d=[],h=[],p=[],g=[];e.chartRadarConfig={options:{colors:["#FDCC99"],chart:{backgroundColor:"rgba(255, 255, 255, 0.1)",polar:!0,type:"line"},pane:{size:"80%"},tooltip:{shared:!0,pointFormat:'<span style="color:{series.color}">{series.name}: <b>{point.y:,.0f}</b><br/><span style="color:{series.color}">Origin: <b>{point.ori:,.4f}</b>'}},title:{text:""},pane:{size:"80%"},xAxis:{categories:h,tickmarkPlacement:"on",lineWidth:0},yAxis:{gridLineInterpolation:"polygon",lineWidth:0,min:0,max:100},tooltip:{shared:!0,pointFormat:'<span style="color:{series.color}">{series.name}: <b>${point.y:,.4f}</b><br/>'},legend:{align:"right",verticalAlign:"top",y:70,layout:"vertical"}},e.chartRadarRiskPreferenceConfig={options:{colors:["#A5E6C0"],chart:{backgroundColor:"rgba(255, 255, 255, 0.1)",polar:!0,type:"line"},pane:{size:"80%"},tooltip:{shared:!0,pointFormat:'<span style="color:{series.color}">{series.name}: <b>{point.y:,.4f}</b><br/><span style="color:{series.color}">Origin: <b>{point.ori:,.4f}</b>'}},title:{text:""},pane:{size:"80%"},xAxis:{categories:p,tickmarkPlacement:"on",lineWidth:0},yAxis:{gridLineInterpolation:"polygon",lineWidth:0,min:0,max:100},legend:{align:"right",verticalAlign:"top",y:70,layout:"vertical"}},e.chartRadarActivityConfig={options:{colors:["#D8A8DE"],chart:{backgroundColor:"rgba(255, 255, 255, 0.1)",polar:!0,type:"line"},pane:{size:"80%"},tooltip:{shared:!0,pointFormat:'<span style="color:{series.color}">{series.name}: <b>{point.y:,.4f}</b><br/><span style="color:{series.color}">Origin: <b>{point.ori:,.4f}</b>'}},title:{text:""},pane:{size:"80%"},xAxis:{categories:g,tickmarkPlacement:"on",lineWidth:0},yAxis:{gridLineInterpolation:"polygon",lineWidth:0,min:0,max:100},legend:{align:"right",verticalAlign:"top",y:70,layout:"vertical"}},e.chartRadarProfitConfig={options:{colors:["#BDDAF7"],chart:{backgroundColor:"rgba(255, 255, 255, 0.1)",polar:!0,type:"line"},pane:{size:"80%"},tooltip:{shared:!0,pointFormat:'<span style="color:{series.color}">{series.name}: <b>{point.y:,.4f}</b><br/><span style="color:{series.color}">Origin: <b>{point.ori:,.4f}</b>'}},title:{text:""},pane:{size:"80%"},xAxis:{categories:r,tickmarkPlacement:"on",lineWidth:0},yAxis:{gridLineInterpolation:"polygon",lineWidth:0,min:0,max:100},legend:{align:"right",verticalAlign:"top",y:70,layout:"vertical"}},e.chartSeedSCScoreConfig={options:{colors:["#1ab394"],chart:{backgroundColor:"rgba(255, 255, 255, 0.1)",polar:!0,type:"line"},pane:{size:"80%"},tooltip:{shared:!0,pointFormat:'<span style="color:{series.color}">{series.name}: <b>{point.y:,.4f}</b><br/><span style="color:{series.color}">Origin: <b>{point.ori:,.4f}</b><br/><span style="color:{series.color}">Weitht: <b>{point.weight:,.4f}</b>'}},title:{text:""},pane:{size:"80%"},xAxis:{categories:c,tickmarkPlacement:"on",lineWidth:0},yAxis:{gridLineInterpolation:"polygon",lineWidth:0,min:0,max:100},legend:{align:"right",verticalAlign:"top",y:70,layout:"vertical"}},e.chartSeedStyleScoreConfig={options:{colors:["#D8A8DE"],chart:{backgroundColor:"rgba(255, 255, 255, 0.1)",polar:!0,type:"line"},pane:{size:"80%"},tooltip:{shared:!0,pointFormat:'<span style="color:{series.color}">{series.name}: <b>{point.y:,.4f}</b><br/><span style="color:{series.color}">Origin: <b>{point.ori:,.4f}</b><br/><span style="color:{series.color}">Weitht: <b>{point.weight:,.4f}</b>'}},title:{text:""},pane:{size:"80%"},xAxis:{categories:d,tickmarkPlacement:"on",lineWidth:0},yAxis:{gridLineInterpolation:"polygon",lineWidth:0,min:0,max:100},legend:{align:"right",verticalAlign:"top",y:70,layout:"vertical"}},e.chartRadarFDTScoreConfig={options:{colors:["#1ab394"],chart:{backgroundColor:"rgba(255, 255, 255, 0.1)",polar:!0,type:"line"},pane:{size:"80%"},tooltip:{shared:!0,pointFormat:'<span style="color:{series.color}">{series.name}: <b>{point.y:,.4f}</b><br/>'}},title:{text:""},pane:{size:"80%"},xAxis:{categories:l,tickmarkPlacement:"on",lineWidth:0},yAxis:{gridLineInterpolation:"polygon",lineWidth:0,min:0,max:100},legend:{align:"right",verticalAlign:"top",y:70,layout:"vertical"}},a.userID&&(e.loadData(),e.hasUserId=!0)
}]),angular.module("inspinia").controller("MT4UserCtrl",["$scope","$rootScope","$http",function(e,t,s){s.get("getMT4Users").success(function(t){e.userList=t})}]),angular.module("inspinia").controller("MT4ProfileCtrl",["$scope","$rootScope","$http","$stateParams",function(e,t,s,a){Highcharts.setOptions({global:{useUTC:!1}}),e.user={},e.userClosedList=[],e.beta=a.beta,e.closedList=[],s.get("getMT4Account?account="+a.accountID).success(function(t){e.acc=t[0];var s=t[0].trades,a=[];for(var i in s)s[i].closeTimeTs=Date.parse(s[i].closeTime)/6e4,s[i].openTimeTs=Date.parse(s[i].openTime)/6e4,"balance"!=s[i].type&&"credit"!=s[i].type&&a.push(s[i]);a.sort(function(e,t){return new Date(t.closeTime)-new Date(e.closeTime)}),e.userClosedList=a,e.chartPieConfig.series=[];var o=t[0].openTrades,n=[];for(var i in o)n.push({name:o[i].item,y:Math.abs(o[i].size),sign:o[i].size>=0?"":"-"});e.chartPieConfig.series.push({type:"pie",name:"User Profolio",data:n,pointPlacement:"on"})}),s.get("getMT4AccountDaily?userId="+a.accountID).success(function(t){var s=[];e.chartConfig.series=[];for(var a=0;a<t.length;a++)s.push([Date.parse(t[a].TRADE_DATE),100*(parseFloat(t[a].UNIT_PRICE)-1)]);t&&t.length>0&&(e.performance={BiggestWin:t[0].BiggestWin,BiggestLoss:t[0].BiggestLoss,WinRatio:t[0].WinRatio,TradesCount:t[0].TradesCount,UNIT_PRICE:t[0].UNIT_PRICE,ALL_TIME_PNL:t[0].ALL_TIME_PNL,CASH_DEPOSITED:t[0].CASH_DEPOSITED}),e.chartConfig.series.push({type:"area",name:"ROI",data:s})}),s.get("getMT4Score?userId="+a.accountID).success(function(t){var s=[],a=[];s.push(t.ft_shp_rt?{y:t.ft_shp_rt.score,ori:t.ft_shp_rt.raw}:0),s.push(t.ft_tmdd?{y:t.ft_tmdd.score,ori:t.ft_tmdd.raw}:0),s.push(t.ft_mdd?{y:t.ft_mdd.score,ori:t.ft_mdd.raw}:0),s.push(t.ft_std_neg_pnlr?{y:t.ft_std_neg_pnlr.score,ori:t.ft_std_neg_pnlr.raw}:0),s.push(t.ft_bgl?{y:t.ft_bgl.score,ori:t.ft_bgl.raw}:0),e.chartRadarFDTScoreConfig.title={text:"FDT Score: "+t.fdt.score.toFixed(2)},e.chartRadarConfig.series=[{type:"area",name:"Risk Control Score",data:s,pointPlacement:"on"}],a.push(t.ft_bgw?{y:t.ft_bgw.score,ori:t.ft_bgw.raw}:0),a.push(t.ft_roll_price?{y:t.ft_roll_price.score,ori:t.ft_roll_price.raw}:0),a.push(t.ft_streak?{y:t.ft_streak.score,ori:t.ft_streak.raw}:0),e.chartRadarProfitConfig.series=[{type:"area",name:"Profitability Score",data:a,pointPlacement:"on"}],e.chartRadarRiskPreferenceConfig.series=[];var s=[];s.push(t.ft_avg_dr?{y:100-t.ft_avg_dr.score,ori:t.ft_avg_dr.raw}:0),s.push(t.ft_df_qty?{y:t.ft_df_qty.score,ori:t.ft_df_qty.raw}:0),s.push(t.ft_avg_max_op?{y:100-t.ft_avg_max_op.score,ori:t.ft_avg_max_op.raw}:0),s.push(t.ft_avg_ngt_op?{y:100-t.ft_avg_ngt_op.score,ori:t.ft_avg_ngt_op.raw}:0),e.chartRadarRiskPreferenceConfig.series=[{type:"area",name:"Risk Preference Score",data:s,pointPlacement:"on"}],e.chartRadarFDTScoreConfig.title={text:"FDT Score: "+t.fdt.score.toFixed(2)},e.chartRadarFDTScoreConfig.series=[];var s=[];s.push(t.riskCtrl.score),s.push(t.profitability.score),s.push(t.consistency.score),s.push(t.activity.score),e.chartRadarFDTScoreConfig.series=[{type:"area",name:"FDT Score",data:s,pointPlacement:"on"}]}),e.chartRadarFDTScoreConfig={options:{colors:["#1ab394"],chart:{backgroundColor:"rgba(255, 255, 255, 0.1)",polar:!0,type:"line"},pane:{size:"80%"},tooltip:{shared:!0,pointFormat:'<span style="color:{series.color}">{series.name}: <b>{point.y:,.2f}</b><br/>'}},title:{text:""},pane:{size:"80%"},xAxis:{categories:["Risk Control(风险控制能力)","Profitability(盈利能力)","Steadiness(稳定性)","Activeness(活跃度)"],tickmarkPlacement:"on",lineWidth:0},yAxis:{gridLineInterpolation:"polygon",lineWidth:0,min:0,max:100},legend:{align:"right",verticalAlign:"top",y:70,layout:"vertical"}},e.chartConfig={options:{colors:["#1ab394"],plotOptions:{series:{cursor:"pointer",point:{events:{click:function(){console.info(this.category);var e=moment(this.category).format("YYYY-MM-DD");_filterTradeDate(e)}}}}},chart:{backgroundColor:"rgba(255, 255, 255, 0.1)",zoomType:"x"},legend:{enabled:!1}},title:{text:"ROI Trend"},xAxis:{type:"datetime",dateTimeLabelFormats:{month:"%b. %e",year:"%b"},title:{text:"Date"}},yAxis:{labels:{enabled:!0},title:{text:null}},tooltip:{headerFormat:"<b>{series.name}</b><br>",pointFormat:"{point.x:%e. %b}: {point.y:.f} users"},plotOptions:{area:{color:"#0038ff",marker:{enabled:null},lineWidth:1,states:{hover:{lineWidth:1}},threshold:null}},credits:{enabled:!1},series:e.chartSeries},e.chartRadarConfig={options:{colors:["#A5E6C0"],chart:{backgroundColor:"rgba(255, 255, 255, 0.1)",polar:!0,type:"line"},pane:{size:"80%"},tooltip:{shared:!0,pointFormat:'<span style="color:{series.color}">{series.name}: <b>{point.y:,.0f}</b><br/><span style="color:{series.color}">Origin: <b>{point.ori:,.2f}</b>'}},title:{text:""},pane:{size:"80%"},xAxis:{categories:["Annual Sharpe Ratio (年化夏普比例)","Timed Maximum Drawdown (最大回撤日均值)","Draw-down (收益回撤控制)","Loss variance (损失波动控制)","Order loss (单笔损失控制)"],tickmarkPlacement:"on",lineWidth:0},yAxis:{gridLineInterpolation:"polygon",lineWidth:0,min:0,max:100},tooltip:{shared:!0,pointFormat:'<span style="color:{series.color}">{series.name}: <b>${point.y:,.0f}</b><br/>'},legend:{align:"right",verticalAlign:"top",y:70,layout:"vertical"}},e.chartRadarRiskPreferenceConfig={options:{colors:["#A5E6C0"],chart:{backgroundColor:"rgba(255, 255, 255, 0.1)",polar:!0,type:"line"},pane:{size:"80%"},tooltip:{shared:!0,pointFormat:'<span style="color:{series.color}">{series.name}: <b>{point.y:,.0f}</b><br/><span style="color:{series.color}">Origin: <b>{point.ori:,.2f}</b>'}},title:{text:""},pane:{size:"80%"},xAxis:{categories:["Open Position Duration(持仓时间)","Default Qty Ratio(默认交易量比例)","Max Open Position(最大仓位)","Overnight Open Position(隔夜仓位)"],tickmarkPlacement:"on",lineWidth:0},yAxis:{gridLineInterpolation:"polygon",lineWidth:0,min:0,max:100},legend:{align:"right",verticalAlign:"top",y:70,layout:"vertical"}},e.chartRadarProfitConfig={options:{colors:["#A5E6C0"],chart:{backgroundColor:"rgba(255, 255, 255, 0.1)",polar:!0,type:"line"},pane:{size:"80%"},tooltip:{shared:!0,pointFormat:'<span style="color:{series.color}">{series.name}: <b>{point.y:,.0f}</b><br/><span style="color:{series.color}">Origin: <b>{point.ori:,.2f}</b>'}},title:{text:""},pane:{size:"80%"},xAxis:{categories:["Biggest Win(最大獲利)","Roll Price(交易時段回報率)","Streak(連續盈利天數)"],tickmarkPlacement:"on",lineWidth:0},yAxis:{gridLineInterpolation:"polygon",lineWidth:0,min:0,max:100},legend:{align:"right",verticalAlign:"top",y:70,layout:"vertical"}},e.chartPieConfig={options:{colors:["#1ab394","#90ee7e","#f45b5b","#7798BF","#aaeeee","#ff0066","#eeaaee","#55BF3B","#DF5353","#7798BF","#aaeeee"],chart:{backgroundColor:"rgba(255, 255, 255, 0.1)",style:{fontFamily:"'Unica One', sans-serif"},legend:{enabled:!0},plotBorderColor:"#606063",type:"pie",options3d:{enabled:!0,alpha:45,beta:0}},tooltip:{pointFormat:"Qty: <b>{point.sign}{point.y}</b> <br> {point.percentage:.1f} %"},plotOptions:{pie:{allowPointSelect:!0,cursor:"pointer",depth:35,dataLabels:{enabled:!0,format:"{point.name}"}}},rangeSelector:{buttonTheme:{fill:"white",stroke:"#C0C0C8","stroke-width":1,states:{select:{fill:"#D0D0D8"}}}},scrollbar:{trackBorderColor:"#C0C0C8"}},title:{text:"Portfolio"}}}]),angular.module("inspinia").controller("CoreUserCtrl",["$scope","$rootScope","$http",function(e,t,s){function a(){for(var t=0;t<e.userList.length;t++)s.get("getUserInfo?app="+e.appSelected+"&db="+e.regionSelected+"&userID="+e.userList[t].user_id).success(function(t){if(t&&t.length>0){var s=t[0];e.usersMap[s.USERID]=s}})}var i=[{name:"台灣大學",key:501,region:"TW"},{name:"政治大學",key:502,region:"TW"},{name:"清華大學",key:505,region:"TW"},{name:"中山大學",key:508,region:"TW"},{name:"台灣師範大學",key:506,region:"TW"},{name:"中央大學",key:507,region:"TW"},{name:"交通大學",key:503,region:"TW"},{name:"中興大學",key:520,region:"TW"},{name:"輔仁大學",key:511,region:"TW"},{name:"東吳大學",key:518,region:"TW"},{name:"淡江大學",key:509,region:"TW"},{name:"東海大學",key:514,region:"TW"},{name:"逢甲大學",key:529,region:"TW"},{name:"實踐大學",key:566,region:"TW"},{name:"台北商業大學",key:538,region:"TW"},{name:"中正",key:513,region:"TW"},{name:"暨南大學",key:516,region:"TW"},{name:"銘傳大學",key:517,region:"TW"}],o=[{name:"北京大学",key:82,region:"CN"},{name:"清华大学",key:129,region:"CN"},{name:"人民大学",key:73,region:"CN"},{name:"北京师范大学",key:104,region:"CN"},{name:"北京航空航天大学",key:78,region:"CN"},{name:"对外贸易大学",key:77,region:"CN"},{name:"中央财经大学",key:50,region:"CN"},{name:"南开大学",key:"IN0102",region:"CN"},{name:"上海交通大学",key:"IN0061",region:"CN"},{name:"复旦大学",key:202,region:"CN"},{name:"上海财经大学",key:208,region:"CN"},{name:"南京大学",key:201,region:"CN"},{name:"浙江大学",key:231,region:"CN"},{name:"中山大学",key:205,region:"CN"},{name:"西南财经大学",key:228,region:"CN"},{name:"武汉大学",key:601,region:"CN"}];e.appTypes=["FX","FC","SC"],e.regions=["TW","IN","CN","US","AU","HK","GB","KE","ID","SG","PK","NZ","TR","CO","GR","FR","SE","PT","CZ","JP","CA","RU","MO","NO","IE","MY","BR","ZA","VE","AE","IQ","KZ","NP","UA","HR","GH","NG","AT","VN","EG","MC","IT","BE","KR","AZ","DE","AF","LT","KH","PH","SA","ES","ME","IL","KW","NL","PL","RO","AM","BT","KG","YE","JA","TH","AR","BD","MX","NI","SY","SR","ZW","null","SD","BN","IO","LR"],e.appSelected=e.appTypes[0],e.regionSelected=e.regions[0],e.limitList=20,e.usersMap={},e.active=30,e.setActive=function(t){e.active=t},e.isActive=function(t){return t===e.active},e.changeRegion=function(){"TW"==e.regionSelected?e.schools=i:"CN"==e.regionSelected&&(e.schools=o),e.schools.unshift({name:"All",key:"all",region:"All"}),e.schoolSelected=e.schools[0],e.changeSelect()},e.changeSelect=function(t){t&&(e.active=t),e.userList=[],e.totalUser=0,s.get("getCoreUserBySchool?app="+e.appSelected+"&db="+e.regionSelected+"&school_key="+(e.schoolSelected?e.schoolSelected.key:"all")).success(function(t){var s=[];for(var i in t)t[i].life>=e.active&&s.push(t[i]);e.totalUser=s.length,e.userList=s.slice(0,e.limitList),a()})}}]),angular.module("inspinia").controller("CMBCtrl",["$scope","$rootScope","$http",function(e,t,s){function a(){for(var t=0;t<e.userList.length;t++)s.get("getUserInfo?app=FC&db=CN&userID="+e.userList[t].userId).success(function(t){if(t&&t.length>0){var s=t[0];e.usersMap[s.USERID]=s}})}e.changeFt=function(){var t="Top"==e.sortTypeSelected?!0:!1,i="Random"==e.sortTypeSelected?!0:!1;s.get("getFinlinkList?type="+e.featureSelected.key+"&desc="+t+(i?"&random=true":"")+"&limit="+e.limitList+"&logincnt="+e.loginCount+"&tradecnt="+e.tradeCount+"&unitPrice="+e.unitPrice+"&mdd="+e.mdd).success(function(t){e.userList=t,a()})},e.limitList=10,e.loginCount=0,e.tradeCount=0,e.unitPrice=.95,e.mdd=-.15,e.features=[{key:"banker_trader_steady",name:"稳健交易型"},{key:"banker_trader_active",name:"积极交易型"},{key:"banker_trader_balanced",name:"平衡交易型"},{key:"banker_investor_steady",name:"稳健投资型"},{key:"banker_investor_active",name:"积极投资型"},{key:"banker_investor_balanced",name:"平衡投资型"},{key:"banker_risk_control",name:"风险控制型"},{key:"banker_marketing",name:"市场营销型"}],e.sortTypes=["Top","Tail","Random"],e.usersMap={},e.featureSelected=e.features[0],e.sortTypeSelected=e.sortTypes[0]}]),angular.module("inspinia").controller("TraderCtrl",["$scope","$rootScope","$http",function(e,t,s){function a(){s.get('getDataFromMongo?col=sc_china_live_scores&limit=500&sort={"fdt.score":-1}&last=1').success(function(t){e.traderList=t;for(var s in t)t[s].rank=parseInt(s)+1,n[t[s].user_id]=t[s];e.loadFDTScore(e.traderList[0].user_id)}),s.get("getStockHistory?symbol=sh000001").success(function(e){var e=e.record;for(var t in e)r[e[t][0]]=parseFloat(e[t][3])})}var i=[],o=[];e.cates=[],e.dateRanges=[{range:"year",display:"一年"}],e.dateSelected=e.dateRanges[0];var n={},r={};e.selected="",e.loadFDTScore=function(t){s.get('getDataFromMongo?col=sc_closed_positions&query={"Trader":"'+t+'"}&limit=0&sort={"TradeDate":-1}').success(function(t){e.closedList=t;for(var s=0,a={},i={},o={},n={},l={},c=t.length-1;c>=0;c--)s+=t[c].RealizedNet,a[t[c].TradeDate]=s,i[t[c].TradeDate]=i[t[c].TradeDate]?t[c].TotalShares+i[t[c].TradeDate]:t[c].TotalShares,o[t[c].TradeDate]=o[t[c].TradeDate]?t[c].TotalShares+o[t[c].TradeDate]:t[c].TotalShares,n[t[c].TradeDate]=n[t[c].TradeDate]?t[c].TotalFee+n[t[c].TradeDate]:t[c].TotalFee,l[t[c].TradeDate]=l[t[c].TradeDate]?t[c].RealizedNet+l[t[c].TradeDate]:t[c].RealizedNet;var d=[],h=[],p=[],g=[],u=[];for(var m in a)d.push([m,a[m]]),h.push([m,r[m]]),l[m]&&o[m]&&p.push([m,l[m]/o[m]]),g.push([m,n[m]]),u.push([m,i[m]]);e.chartAccPnlConfig.series=[],e.chartIndexConfig.series=[],e.chartEffConfig.series=[],e.chartFeeConfig.series=[],e.chartVolConfig.series=[],e.chartAccPnlConfig.series.push({type:"area",name:"累计收益",data:d}),e.chartIndexConfig.series.push({type:"area",name:"上证指数",data:h}),e.chartEffConfig.series.push({type:"area",name:"盈利效率",data:p}),e.chartFeeConfig.series.push({type:"area",name:"手续费",data:g}),e.chartVolConfig.series.push({type:"area",name:"交易量",data:u}),setTimeout(function(){window.dispatchEvent(new Event("resize"))},100)}),e.selected=t,s.get("getScoreDisplay").success(function(s){var a=n[t];e.chartSeedSCScoreConfig.series=[],e.chartSeedStyleScoreConfig.series=[];e.chartSeedSCScoreConfig.title={text:"FDT Score: "+a.fdt.score.toFixed(2)},e.chartSeedStyleScoreConfig.title={text:"交易员风格"};var r=[],l=[],c=s.seedsc.fdt_score.features;e.cates=[];for(var d in c){var h=a[c[d].feature];r.push(h?{y:h.score,ori:h.raw,weight:h.weight}:0),i.push(c[d].name),e.cates.push({name:c[d].name,feature:c[d].feature})}c=s.seedsc.styles.features;for(var d in c){var h=a[c[d].feature];h&&(o.push(c[d].name),l.push({y:h.score,ori:h.raw,weight:h.weight}))}e.chartSeedSCScoreConfig.series=[{type:"area",name:"FDT Score",data:r,pointPlacement:"on"}],e.chartSeedStyleScoreConfig.series=[{type:"area",name:"Trader Styles",data:l,pointPlacement:"on"}]})},a(),e.chartSeedSCScoreConfig={options:{colors:["#f96868"],chart:{backgroundColor:"rgba(255, 255, 255, 0.1)",polar:!0,type:"line"},pane:{size:"80%"},tooltip:{shared:!0,pointFormat:'<span style="color:{series.color}">{series.name}: <b>{point.y:,.4f}</b><br/><span style="color:{series.color}">Origin: <b>{point.ori:,.4f}</b><br/><span style="color:{series.color}">Weight: <b>{point.weight:,.4f}</b>'}},title:{text:""},pane:{size:"80%"},xAxis:{categories:i,tickmarkPlacement:"on",lineWidth:0},yAxis:{gridLineInterpolation:"polygon",lineWidth:0,min:0,max:100},legend:{align:"right",verticalAlign:"top",y:70,layout:"vertical"}},e.chartIndexConfig={options:{colors:["#1ab394"],chart:{backgroundColor:"rgba(255, 255, 255, 0.1)",zoomType:"x"},legend:{enabled:!0},yAxis:{min:2e3},xAxis:{labels:{formatter:function(){return""}}}},title:{text:""},credits:{enabled:!1}},e.chartAccPnlConfig={options:{colors:["#f96868"],chart:{backgroundColor:"rgba(255, 255, 255, 0.1)",zoomType:"x"},legend:{enabled:!0},xAxis:{labels:{formatter:function(){return""}}}},title:{text:""},credits:{enabled:!1}},e.chartEffConfig={options:{colors:["#A5E6C0"],chart:{backgroundColor:"rgba(255, 255, 255, 0.1)",zoomType:"x"},legend:{enabled:!0},xAxis:{labels:{formatter:function(){return""}}}},title:{text:""},credits:{enabled:!1}},e.chartVolConfig={options:{colors:["#FDCC99"],chart:{backgroundColor:"rgba(255, 255, 255, 0.1)",zoomType:"x"},legend:{enabled:!0},xAxis:{labels:{formatter:function(){return""}}}},title:{text:""},credits:{enabled:!1}},e.chartFeeConfig={options:{colors:["#BDDAF7"],chart:{backgroundColor:"rgba(255, 255, 255, 0.1)",zoomType:"x"},legend:{enabled:!0},xAxis:{labels:{formatter:function(){return""}}}},title:{text:""},credits:{enabled:!1}},e.chartSeedStyleScoreConfig={options:{colors:["#D8A8DE"],chart:{backgroundColor:"rgba(255, 255, 255, 0.1)",polar:!0,type:"line"},pane:{size:"80%"},tooltip:{shared:!0,pointFormat:'<span style="color:{series.color}">{series.name}: <b>{point.y:,.4f}</b><br/><span style="color:{series.color}">Origin: <b>{point.ori:,.4f}</b><br/><span style="color:{series.color}">Weitht: <b>{point.weight:,.4f}</b>'}},title:{text:""},pane:{size:"80%"},xAxis:{categories:o,tickmarkPlacement:"on",lineWidth:0},yAxis:{gridLineInterpolation:"polygon",lineWidth:0,min:0,max:100},legend:{align:"right",verticalAlign:"top",y:70,layout:"vertical"}}}]),angular.module("inspinia").controller("StoplossCtrl",["$scope","$rootScope","$http",function(e,t,s){s.get("getStopLoss").success(function(t){e.stoplossList=t,e.chartScatterConfig.series=[];var s=[],a=[];for(var i in t)t[i].daily_exp_pnl>=0?s.push([t[i].daily_exp_pnl,t[i].black_allert]):a.push([t[i].daily_exp_pnl,t[i].black_allert]);e.chartScatterConfig.series=[{name:"正盈利",color:"rgba(223, 83, 83, .5)",data:s},{name:"负盈利",color:"rgba(119, 152, 191, .5)",data:a}]}),e.chartScatterConfig={options:{colors:["#f96868"],chart:{backgroundColor:"rgba(255, 255, 255, 0.1)",zoomType:"xy",type:"scatter"},xAxis:{title:{enabled:!0,text:"日均盈利: "},startOnTick:!0,endOnTick:!0,showLastLabel:!0},yAxis:{title:{text:"黑色止损线: "}},tooltip:{headerFormat:"<b>{series.name}</b><br>",pointFormat:"日均盈利: {point.x}, 黑色预警: {point.y} "}},title:{text:"日均盈利与黑色预警线关系"}}}]),angular.module("inspinia").controller("StockCtrl",["$scope","$rootScope","$http",function(e,t,s){function a(t,a){s.post("getBatchPredictFromMongo",{sids:t,limit:t.length,date:a}).success(function(t){for(var s in t)e.predictMap[t[s].stock_id]=t[s].testPred})}function i(t,s){e.predictMap={};for(var i=0;i<s.length;){var o=i+50,n=s.slice(i,o);console.info(n),a(n,t),i=o}}function o(t){var a=[];s.get('getDataFromMongo?col=sc_china_live_stock&limit=500&sort={"fdt.score":-1}&last=1').success(function(t){e.traderList=t;for(var i in t)t[i].rank=parseInt(i)+1,n[t[i].user_id]=t[i],a.push(t[i].user_id);t&&t.length>0&&s.get("getScoreDisplay").success(function(s){var a=s.seedsc.fdt_score.features;e.cates=[];for(var i in a){var o=t[0][a[i].feature];o&&e.cates.push({name:a[i].name,feature:a[i].feature})}})});var o=moment().subtract(30,"days").format("YYYY-MM-DD");s.get('getDataFromMongo?col=sc_closed_positions&query={"TradeDate":{"$gt":"'+o+'"}}&limit=0').success(function(o){var n={};for(var r in o){var l=("00000"+o[r].StkCode).slice(-6);n[l]?(n[l].pnl=o[r].RealizedNet+n[l].pnl,n[l].volAmount=o[r].TotalTradeMoney+n[l].volAmount,n[l].tradeCount=n[l].tradeCount+1):n[l]={pnl:o[r].RealizedNet,volAmount:o[r].TotalTradeMoney,stockName:o[r].StkName,tradeCount:1}}var c=[],d=[];for(var h in n)if(n[h].volAmount&&n[h].volAmount>0){var p=n[h].pnl/n[h].volAmount;p>.001&&n[h].tradeCount>5&&(c.push({stockCode:h,eff:p,stockName:n[h].stockName}),d.push(h))}console.info(a),(new Date).getHours()>=15&&i(e.shIndex[0],a),s.get("getPredictFromMongo?limit="+d.length+"&sids="+d+"&date="+t).success(function(t){var s={};for(var a in t)s[t[a].stock_id]=t[a];for(var i in c)s[c[i].stockCode]?(c[i].predict=s[c[i].stockCode].testPred,c[i].info=s[c[i].stockCode].realtimeInfo):c[i].noPredict=!0;var o=[];for(var n in c)c[n].noPredict||o.push(c[n]);o.sort(function(e,t){return t.predict-e.predict});for(var a in o)o[a].rank=parseInt(a)+1;e.stockArr=o})})}e.cates=[];var n={};s.get("getRealTimeIndex").success(function(t){e.realtimeIndex=t,e.shIndexVar=(parseFloat(t[3])-parseFloat(t[2]))/parseFloat(t[2])*100,e.indexVol=(parseFloat(t[4])-parseFloat(t[5]))/parseFloat(t[2])*100}),s.get("getStockHistory?symbol=sh000001").success(function(t){var t=t.record;e.shIndex=t[t.length-1],e.shLastIndex=t[t.length-2];var s="";s=(new Date).getHours()<15?e.shIndex[0]:e.shLastIndex[0],o(s)}),e.selected=""}]),angular.module("inspinia").controller("FeatureCtrl",["$scope","$rootScope","$http",function(e,t,s){s.get("getDataFromMongo?col=sc_china_live_misc&limit=500").success(function(t){e.imgs=t})}]),angular.module("inspinia").controller("AllocCtrl",["$scope","$rootScope","$http",function(e,t,s){s.get("getDataFromMongo?col=res_alloc_display&limit=500").success(function(t){e.allocList=t})}]),angular.module("inspinia").controller("TabsDemoCtrl",["$scope","$rootScope","$window",function(e){e.tabs=[{title:"Global",content:"Dynamic content 1"},{title:"China",content:"Dynamic content 2",disabled:!0}],e.click=function(){setTimeout(function(){window.dispatchEvent(new Event("resize"))},100)}}]),angular.module("inspinia").controller("PredictCrol",["$scope","$rootScope","$http",function(e,t,s){function a(){e.top10Mean=0,e.top20Mean=0,e.top30Mean=0,e.top40Mean=0,s.get("getPredict").success(function(t){var s=0,a=0,i=0,o=0;e.predictList=t;for(var n in t)10>n&&t[n].realtimeInfo&&parseFloat(t[n].realtimeInfo.open)>0&&(s+=(parseFloat(t[n].realtimeInfo.high)-parseFloat(t[n].realtimeInfo.low))/parseFloat(t[n].realtimeInfo.open)*100),20>n&&t[n].realtimeInfo&&parseFloat(t[n].realtimeInfo.open)>0&&(a+=(parseFloat(t[n].realtimeInfo.high)-parseFloat(t[n].realtimeInfo.low))/parseFloat(t[n].realtimeInfo.open)*100),30>n&&t[n].realtimeInfo&&parseFloat(t[n].realtimeInfo.open)>0&&(i+=(parseFloat(t[n].realtimeInfo.high)-parseFloat(t[n].realtimeInfo.low))/parseFloat(t[n].realtimeInfo.open)*100),40>n&&t[n].realtimeInfo&&parseFloat(t[n].realtimeInfo.open)>0&&(o+=(parseFloat(t[n].realtimeInfo.high)-parseFloat(t[n].realtimeInfo.low))/parseFloat(t[n].realtimeInfo.open)*100);e.top10Mean=parseFloat(s/10),e.top20Mean=parseFloat(a/20),e.top30Mean=parseFloat(i/30),e.top40Mean=parseFloat(o/40)}),s.get("getStockHistory?symbol=sh000001").success(function(t){var t=t.record;e.shIndex=t[t.length-1],e.shLastIndex=t[t.length-2],e.shIndexVar=(parseFloat(e.shIndex[3])-parseFloat(e.shLastIndex[3]))/parseFloat(e.shLastIndex[3])*100,e.indexVol=(parseFloat(e.shIndex[2])-parseFloat(e.shIndex[4]))/parseFloat(e.shLastIndex[3])*100})}s.get("getScTradeDate").success(function(t){e.obsDate=moment(t.DATE).format("YYYY-MM-DD")}),a()}]),angular.module("inspinia").controller("SeedUserListCrol",["$scope","$rootScope","$http","$filter",function(e,t,s,a){e.rowCollection=[],e.historyFilePath="getSeedList?format=csv",e.historyFileName=a("date")(new Date,"yyyy-MM-dd")+"_seed.csv",e.loadSeedData=function(){s.get("getSeedList").success(function(t){e.userList=t}),s.get("getSeedSummary").success(function(t){e.summaryList=t;var s=[];for(var a in t)s.push({name:t[a].SYMBOL,y:t[a].QTY,pnl:t[a].PNL});e.chartPieConfig.series=[{type:"pie",name:"",data:s,pointPlacement:"on"}]}),s.get("getSeedCount").success(function(t){e.summaryObj=t})},e.loadSeedData(),e.chartPieConfig={options:{colors:["#1ab394","#90ee7e","#f45b5b","#7798BF","#aaeeee","#ff0066","#eeaaee","#55BF3B","#DF5353","#7798BF","#aaeeee"],chart:{backgroundColor:"rgba(255, 255, 255, 0.1)",style:{fontFamily:"'Unica One', sans-serif"},legend:{enabled:!0},plotBorderColor:"#606063",type:"pie",options3d:{enabled:!0,alpha:45,beta:0}},tooltip:{pointFormat:"Qty: <b>{point.y}</b> <br> PNL: <b>{point.pnl}</b> <br> {point.percentage:.1f} %"},plotOptions:{pie:{allowPointSelect:!0,cursor:"pointer",depth:35,dataLabels:{enabled:!0,format:"{point.name}"}}},rangeSelector:{buttonTheme:{fill:"white",stroke:"#C0C0C8","stroke-width":1,states:{select:{fill:"#D0D0D8"}}}},scrollbar:{trackBorderColor:"#C0C0C8"}},title:{text:"Symbols"}}}]),angular.module("inspinia").controller("UserRankingCrol",["$scope","$rootScope","$http",function(e,t,s){var a=[{name:"FX",id:"1"},{name:"FC",id:"2"},{name:"SC",id:"3"}],i=[];e.$watch(function(){return t.selectedSchool},function(){t.selectedSchool&&(e.products="CN"==t.regionSelected?a:[a[0]],e.selected=e.products[0],e.loadSchoolData(t.selectedSchool))},!0),e.loadSchoolData=function(a){e.loaded=!1,e.userRankList=[],e.rankListLoading=!0,s.get("getUserRanking?school_key="+a+"&app="+e.selected.name+"&db="+t.regionSelected).success(function(t){i=t,e.rankListLoading=!1,e.userRankList=t.slice(0,10)})},e.loadMore=function(){e.userRankList=i},e.changeProduct=function(){e.loadSchoolData(t.selectedSchool)}}]),angular.module("inspinia").controller("SchoolCtrl",["$scope","$rootScope","$http",function(e,t,s){function a(a){s.get("getSchools?db="+a).success(function(s){for(var i in s)if(s[i].school_name&&(s[i].school_region&&e.regions.indexOf(s[i].school_region)<0&&(t.roleRegion==s[i].school_region||"All"==t.roleRegion||"Overseas"==t.roleRegion&&"CN"!=s[i].school_region)&&e.regions.push(s[i].school_region),o.indexOf(s[i].school_key)<0&&"INOTHER"!=s[i].school_key&&"825"!=s[i].school_key&&"672"!=s[i].school_key)){if("CN"==a&&"CN"!=s[i].school_region)continue;(s[i].school_key==t.roleSchool||"All"==t.roleSchool)&&(e.schoolsList.push(s[i]),o.push(s[i].school_key))}console.info(e.regions)})}function i(){e.totalUser=0,e.monthUserFX=0,e.weekUserFX=0,e.monthUserFC=0,e.weekUserFC=0,e.monthUserSC=0,e.weekUserSC=0,e.school.selected=void 0,e.core30=0,e.core60=0,e.core90=0,e.coreFC30=0,e.coreFX30=0,e.coreSC30=0,e.coreFC60=0,e.coreFX60=0,e.coreSC60=0,e.coreFC90=0,e.coreFX90=0,e.coreSC90=0}e.regions=[],e.schoolsList=[];var o=[];e.schools=[],e.school={},e.compareList=[],a(),a("CN"),e.addSchool=function(){e.school.selected="Please select a school to compare ...",e.isCompard=!0},e.loadSchoolData=function(t){s.get("getSchoolUserGrowth?school_key="+t.school_key+"&db="+t.school_region).success(function(s){e.isCompard||(e.chartConfig.series=[]);for(var a=[],i=0;i<s.length;i++)a.push([Date.parse(s[i].date),s[i].total_user_num]);e.chartConfig.series.push({type:"spline",name:t.school_name,data:a})})},e.onSearch=function(){},e.loadCountData=function(t){i(),s.get("getSchoolUserCountByApp?app=FX&school_key="+t.school_key+"&db="+t.school_region).success(function(t){var s=t;e.totalUser=s.totalUser,e.monthUserFX=s.monthlyActiveUser,e.weekUserFX=s.weeklyActiveUser}),"CN"==t.school_region?(e.isChina=!0,s.get("getSchoolUserCountByApp?app=SC&school_key="+t.school_key+"&db="+t.school_region).success(function(t){var s=t;e.monthUserSC=s.monthlyActiveUser,e.weekUserSC=s.weeklyActiveUser}),s.get("getSchoolUserCountByApp?app=FC&school_key="+t.school_key+"&db="+t.school_region).success(function(t){var s=t;e.totalUser=s.totalUser,e.monthUserFC=s.monthlyActiveUser,e.weekUserFC=s.weeklyActiveUser}),s.get("getCoreUserBySchool?app=FC&school_key="+t.school_key+"&db="+t.school_region).success(function(t){var s=0,a=0,i=0;for(var o in t)t[o].life>30&&s++,t[o].life>60&&a++,t[o].life>90&&i++;e.coreFC30=s,e.coreFC60=a,e.coreFC90=i}),s.get("getCoreUserBySchool?app=FX&school_key="+t.school_key+"&db="+t.school_region).success(function(t){var s=0,a=0,i=0;for(var o in t)t[o].life>30&&s++,t[o].life>60&&a++,t[o].life>90&&i++;e.coreFX30=s,e.coreFX60=a,e.coreFX90=i}),s.get("getCoreUserBySchool?app=SC&school_key="+t.school_key+"&db="+t.school_region).success(function(t){var s=0,a=0,i=0;for(var o in t)t[o].life>30&&s++,t[o].life>60&&a++,t[o].life>90&&i++;e.coreSC30=s,e.coreSC60=a,e.coreSC90=i})):(e.isChina=!1,s.get("getCoreUserBySchool?app=FX&school_key="+t.school_key+"&db="+t.school_region).success(function(t){var s=0,a=0,i=0;for(var o in t)t[o].life>30&&s++,t[o].life>60&&a++,t[o].life>90&&i++;e.core30=s,e.core60=a,e.core90=i}))},e.onSchoolSelect=function(s){e.count_show=!0,e.loadSchoolData(s),e.loadCountData(s),t.selectedSchool=s.school_key},e.onRegionSelect=function(s){if(i(),e.schools=[],t.regionSelected=s,e.school_show=!0,e.schoolsList.length>0){"All"==t.roleSchool&&e.schools.push({school_key:"all",school_name:"All schools"});for(var a in e.schoolsList)e.schoolsList[a].school_region&&e.schoolsList[a].school_region==s&&(e.schools.push(e.schoolsList[a]),e.schools[0].school_region=e.schoolsList[a].school_region)}},e.chartConfig={chart:{backgroundColor:null,zoomType:"x"},title:{text:"User Growth"},xAxis:{type:"datetime",dateTimeLabelFormats:{month:"%b. %e",year:"%b"},title:{text:"Date"}},yAxis:{title:{text:"Users"},min:0},tooltip:{headerFormat:"<b>{series.name}</b><br>",pointFormat:"{point.x:%e. %b}: {point.y:.f} users"},legend:{enabled:!0},plotOptions:{area:{color:"#0038ff",marker:{enabled:null},lineWidth:1,states:{hover:{lineWidth:1}},threshold:null}},credits:{enabled:!1},series:e.chartSeries}}]),angular.module("inspinia").controller("QuantCrol",["$scope","$rootScope","$http",function(e,t,s){e.chartConfig={options:{chart:{backgroundColor:null,zoomType:"x"},title:{text:"User Growth"},xAxis:{type:"datetime",dateTimeLabelFormats:{month:"%b. %e",year:"%b"},title:{text:"Date"}},yAxis:{title:{text:"Users"},min:0},tooltip:{headerFormat:"<b>{series.name}</b><br>",pointFormat:"{point.x:%e. %b}: {point.y:.f} users"}},legend:{enabled:!0},plotOptions:{area:{color:"#0038ff",marker:{enabled:null},lineWidth:1,states:{hover:{lineWidth:1}},threshold:null}},credits:{enabled:!1}},e.chartConfig.series=[],console.info("quant..."),s.get("getSymbol?symbol=EURJPY").success(function(t){for(var s=[],a=[],i=[],o=19;o<t.length;o++)s.push([Date.parse(t[o].KEYTIME),t[o].CLOSE_PRICE-130]),a.push([Date.parse(t[o].KEYTIME),t[o].max20-130]),i.push([Date.parse(t[o].KEYTIME),t[o].min10-130]);e.chartConfig.series.push({type:"spline",name:"Close Price",data:s},{type:"spline",name:"Max 20",data:a},{type:"spline",name:"Min10",data:i})})}]),angular.module("inspinia").controller("ContestCrol",["$scope","$rootScope","$http",function(e,t,s){var a=[{name:"FX",id:"1"},{name:"FC",id:"2"},{name:"SC",id:"3"}];e.$watch(function(){return t.selectedSchool},function(){t.selectedSchool&&(e.products="CN"==t.regionSelected?a:[a[0]],e.selected=e.products[0],e.loadContentData(t.selectedSchool))},!0),e.loadContentData=function(a){e.contestList=[],s.get("getContestByApp?school_key="+a+"&app="+e.selected.name+"&db="+t.regionSelected).success(function(t){e.contestList=t})},e.changeProduct=function(){e.loadContentData(t.selectedSchool)}}]);var app=angular.module("inspinia");app.controller("MapCtrl",["$scope","$location","$http",function(e,t,s){e.data=function(){s.get("getRegionDist?file=Global_Country_TU").success(function(t){t=t.data.Global_Country_TU;var s={};e.markers=[];for(var a=0;a<t.length;a++)t[a].Country&&(s[t[a].Country]=parseInt(t[a]["Total Users"])),"HK"==t[a].Country&&e.markers.push({latLng:[22.15,114.1],name:"Hong Kong",values:parseInt(t[a]["Total Users"])});e.datamap=s})}}]),app.directive("map",function(){return{restrict:"EAC",link:function(e,t){var s=null;e.$watch("datamap",function(){console.log(s),e.datamap&&($(t).width("auto"),$(t).height(400),s=$(t).vectorMap({onRegionClick:function(e,t){console.info(t)},map:"world_mill_en",backgroundColor:"transparent",regionStyle:{initial:{fill:"#e4e4e4","fill-opacity":1,stroke:"none","stroke-width":0,"stroke-opacity":0}},series:{regions:[{values:e.datamap,scale:["#1ab394","#ED5565"],normalizeFunction:"polynomial"}]},onMarkerTipShow:function(t,s,a){s.html(s.html()+": "+(e.markers[a]?e.markers[a].values:""))},onRegionTipShow:function(t,s,a){s.html(s.html()+": "+(e.datamap[a]?e.datamap[a]:""))},markers:e.markers,markerStyle:{initial:{fill:"#F8E23B",stroke:"#383f47"}}}))})}}}),angular.module("inspinia").controller("IncUserListCrol",["$scope","$rootScope","$http","$filter",function(e,t,s,a){e.rowCollection=[],e.historyFilePath="getIncuList?format=csv",e.historyFileName=a("date")(new Date,"yyyy-MM-dd")+"_incubatee.csv",e.loadIncuData=function(){s.get("getIncuList").success(function(t){e.userList=t}),s.get("getIncuSummary").success(function(t){e.summaryList=t;var s=[];for(var a in t)s.push({name:t[a].SYMBOL,y:t[a].QTY,pnl:t[a].PNL});e.chartPieConfig.series=[{type:"pie",name:"",data:s,pointPlacement:"on"}]}),s.get("getIncuCount").success(function(t){e.summaryObj=t})},e.loadIncuData(),e.chartPieConfig={options:{colors:["#1ab394","#90ee7e","#f45b5b","#7798BF","#aaeeee","#ff0066","#eeaaee","#55BF3B","#DF5353","#7798BF","#aaeeee"],chart:{backgroundColor:"rgba(255, 255, 255, 0.1)",style:{fontFamily:"'Unica One', sans-serif"},legend:{enabled:!0},plotBorderColor:"#606063",type:"pie",options3d:{enabled:!0,alpha:45,beta:0}},tooltip:{pointFormat:"Qty: <b>{point.y}</b> <br> PNL: <b>{point.pnl}</b> <br> {point.percentage:.1f} %"},plotOptions:{pie:{allowPointSelect:!0,cursor:"pointer",depth:35,dataLabels:{enabled:!0,format:"{point.name}"}}},rangeSelector:{buttonTheme:{fill:"white",stroke:"#C0C0C8","stroke-width":1,states:{select:{fill:"#D0D0D8"}}}},scrollbar:{trackBorderColor:"#C0C0C8"}},title:{text:"Symbols"}}}]),angular.module("inspinia").controller("VennCtrl",["$scope","$http","$rootScope",function(e,t,s){e.loadData=function(a){t.get("getDataFromFile?file="+a).success(function(t){t=t.data;var a=[{sets:["Mainland_FX"],size:t.China_FX_FC_SC_TU[0].China_FX},{sets:["Mainland_FC"],size:t.China_FX_FC_SC_TU[0].China_FC},{sets:["Mainland_SC"],size:t.China_FX_FC_SC_TU[0].China_SC},{sets:["Mainland_FX","Mainland_FC"],size:t.China_FX_FC_SC_TU[0].China_FX_FC},{sets:["Mainland_FX","Mainland_SC"],size:t.China_FX_FC_SC_TU[0].China_FX_SC},{sets:["Mainland_FC","Mainland_SC"],size:t.China_FX_FC_SC_TU[0].China_FC_SC},{sets:["Mainland_FX","Mainland_FC","Mainland_SC"],size:t.China_FX_FC_SC_TU[0].China_FX_FC_SC}];
s.overlapUsers=t.China_FX_FC_SC_TU[0].China_FX_FC_SC,e.vennData=a,setTimeout(function(){var e=d3.select("#venn"),t=d3.select("body").append("div").attr("class","venntooltip");e.selectAll("g").on("mouseover",function(s){venn.sortAreas(e,s),t.transition().duration(400).style("opacity",.9),t.text(s.size+" users");var a=d3.select(this).transition("tooltip").duration(400);a.select("path").style("stroke-width",3).style("fill-opacity",1==s.sets.length?.4:.1).style("stroke-opacity",1)}).on("mousemove",function(){t.style("left",d3.event.pageX+"px").style("top",d3.event.pageY-28+"px")}).on("mouseout",function(e){t.transition().duration(400).style("opacity",0);var s=d3.select(this).transition("tooltip").duration(400);s.select("path").style("stroke-width",0).style("fill-opacity",1==e.sets.length?.25:0).style("stroke-opacity",0)})},300)})}}]),angular.module("inspinia").controller("ChartPieCtrl",["$scope","$http","$rootScope",function(e,t){e.loadData=function(){t.get("getChannelDist?db=CN").success(function(t){var s=[];for(var a in t)s.push({name:t[a].channel,y:Math.abs(t[a].count)});e.chartPieConfig.series=[],e.chartPieConfig.series.push({type:"pie",name:"China Download Channel Distubution",data:s,pointPlacement:"on"})})},e.chartPieConfig={options:{colors:["#1ab394","#90ee7e","#f45b5b","#7798BF","#aaeeee","#ff0066","#eeaaee","#55BF3B","#DF5353","#7798BF","#aaeeee"],chart:{backgroundColor:"rgba(255, 255, 255, 0.1)",style:{fontFamily:"'Unica One', sans-serif"},legend:{enabled:!0},plotBorderColor:"#606063",type:"pie",options3d:{enabled:!0,alpha:45,beta:0}},tooltip:{pointFormat:"Registration:  {point.percentage:.1f} %"},plotOptions:{pie:{allowPointSelect:!0,cursor:"pointer",depth:35,dataLabels:{enabled:!0,format:"{point.name}"}}},rangeSelector:{buttonTheme:{fill:"white",stroke:"#C0C0C8","stroke-width":1,states:{select:{fill:"#D0D0D8"}}}},scrollbar:{trackBorderColor:"#C0C0C8"}}}}]),angular.module("inspinia").controller("ChartCtrl",["$scope","$http","$rootScope",function(e,t,s){e.$on("changeSelector",function(e,t){console.info(t)}),s.TotalGlobalTrendObj={},s.TotalChinaTrendObj={},e.loadData=function(a){t.get("getDataFromFile?file="+a).success(function(t){t=t.data;var i=a.split("|");e.chartConfig.series=[];for(var o=0;o<i.length;o++){for(var n=[],r=0;r<t[i[o]].length;r++)n.push([Date.parse(t[i[o]][r].date),parseInt(t[i[o]][r][e.valueName])]);"All"==s.roleRegion?e.chartConfig.series.push({type:"area",name:e[i[o]],data:n}):"CN"==s.roleRegion&&(i[o].indexOf("China")>=0||i[o].indexOf("Overlap")>=0)?e.chartConfig.series.push({type:"area",name:e[i[o]],data:n}):"CN"!=s.roleRegion&&i[o].indexOf("Global")>=0&&e.chartConfig.series.push({type:"area",name:e[i[o]],data:n})}if("Date_TU_Global|Date_TU_China"==a){var l=t.Date_TU_Global,c=t.Date_TU_China;s.totalUsersChina=parseInt(c[c.length-1][e.valueName]),s.totalUsersGlobal=parseInt(l[l.length-1][e.valueName])}})},e.chartConfig={options:{},xAxis:{type:"datetime",dateTimeLabelFormats:{month:"%b. %e",year:"%b"},title:{text:"Date"}},yAxis:{title:{text:"Users"},min:0},tooltip:{headerFormat:"<b>{series.name}</b><br>",pointFormat:"{point.x:%e. %b}: {point.y:.f} users"},legend:{enabled:!0},plotOptions:{area:{color:"#0038ff",marker:{enabled:null},lineWidth:1,states:{hover:{lineWidth:1}},threshold:null}},credits:{enabled:!1},series:e.chartSeries}}]),angular.module("inspinia").controller("ChartComLineCtrl",["$scope","$http",function(e,t){e.loadData=function(s){t.get("getDataFromFile?file="+s).success(function(t){t=t.data;var s=[],a=[],i={};i={Others:0};for(var o={},n=0;n<t.Global_Country_TU.length&&5>n;n++)s.push(t.Global_Country_TU[n]),a.push(t.Global_Country_TU[n].Country),i[t.Global_Country_TU[n].Country]=0;for(var n=0;n<t.Date_Global_Country_TU.length;n++)if(a.indexOf(t.Date_Global_Country_TU[n].country)>=0){"TW"==t.Date_Global_Country_TU[n].country&&console.info(t.Date_Global_Country_TU[n]);var r=i[t.Date_Global_Country_TU[n].country]+parseInt(t.Date_Global_Country_TU[n]["Total Users"]);i[t.Date_Global_Country_TU[n].country]=r;var l=[Date.parse(t.Date_Global_Country_TU[n].date),r];o[t.Date_Global_Country_TU[n].country]&&o[t.Date_Global_Country_TU[n].country].length>0?o[t.Date_Global_Country_TU[n].country].push(l):(o[t.Date_Global_Country_TU[n].country]=[],o[t.Date_Global_Country_TU[n].country].push(l))}else{var r=i.Others+parseInt(t.Date_Global_Country_TU[n]["Total Users"]);i.Others=r;var l=[Date.parse(t.Date_Global_Country_TU[n].date),r];o.Others&&o.Others.length>0?o.Others.push(l):(o.Others=[],o.Others.push(l))}var c=[];a.push("Others");for(var d in a)c.push({name:a[d],data:o[a[d]]});e.chartConfig.series=c})},e.chartConfig={chart:{backgroundColor:null,zoomType:"x"},xAxis:{type:"datetime",dateTimeLabelFormats:{month:"%b. %e",year:"%b"},title:{text:"Date"}},yAxis:{title:{text:"Users"},min:0},tooltip:{headerFormat:"<b>{series.name}</b><br>",pointFormat:"{point.x:%e. %b}: {point.y:.f} users"},legend:{enabled:!0},plotOptions:{area:{color:"#0038ff",marker:{enabled:null},lineWidth:1,states:{hover:{lineWidth:1}},threshold:null}},credits:{enabled:!1},series:e.chartSeries}}]),angular.module("inspinia").controller("ChartAreaCtrl",["$scope","$http","$rootScope",function(e,t,s){s.activeGlobalTrendObj={},s.activeChinaTrendObj={},e.loadData=function(s){t.get("getDataFromFile?file="+s).success(function(t){t=t.data;var a=s.split("|");e.chartConfig.series=[];for(var i=0;i<a.length;i++){for(var o=[],n=0;n<t[a[i]].length;n++)o.push([Date.parse(t[a[i]][n].date),parseInt(t[a[i]][n][e.valueName])]);e.chartConfig.series.push({type:"area",name:e[a[i]],data:o})}})},e.chartConfig={chart:{backgroundColor:null,zoomType:"x"},options:{plotOptions:{area:{fillColor:{linearGradient:{x1:0,y1:0,x2:0,y2:1},stops:[[0,Highcharts.getOptions().colors[0]],[1,Highcharts.Color(Highcharts.getOptions().colors[0]).setOpacity(0).get("rgba")]]},marker:{radius:2},lineWidth:1,states:{hover:{lineWidth:1}},threshold:null}}},xAxis:{type:"datetime",dateTimeLabelFormats:{month:"%b. %e",year:"%b"},title:{text:"Date"}},yAxis:{title:{text:"Users"},min:0},tooltip:{headerFormat:"<b>{series.name}</b><br>",pointFormat:"{point.x:%e. %b}: {point.y:.f} users"},legend:{enabled:!0},plotOptions:{area:{color:"#0038ff",marker:{enabled:null},lineWidth:1,states:{hover:{lineWidth:1}},threshold:null}},credits:{enabled:!1},series:e.chartSeries}}]),angular.module("inspinia").controller("ChartActiveCtrl",["$scope","$http","$rootScope",function(e,t,s){e.loadData=function(){t.get("getActiveUserPer").success(function(t){for(var a=[],i=[],o=0;o<t.global.length;o++)a.push([Date.parse(t.global[o].date),t.global[o].Percentage]);for(var o=0;o<t.china.length;o++)i.push([Date.parse(t.china[o].date),t.china[o].Percentage]);"All"==s.roleRegion?e.chartConfig.series=[{type:"area",name:"Mainland %",data:i},{type:"area",name:"Overseas %",data:a}]:"CN"==s.roleRegion?e.chartConfig.series=[{type:"area",name:"Mainland %",data:i}]:"CN"!=s.roleRegion&&(e.chartConfig.series=[{type:"area",name:"Overseas %",data:a}])})},e.chartConfig={options:{colors:["#1ab394","#127E68"],chart:{backgroundColor:null,zoomType:"x"},tooltip:{headerFormat:"<b>{series.name}</b><br>",pointFormat:"{point.x:%e. %b}: {point.y:.f} %"}},xAxis:{type:"datetime",dateTimeLabelFormats:{month:"%b. %e",year:"%b"},title:{text:"Date"},floor:Date.UTC(2015,4,17)},yAxis:{title:{text:"Active Users%"},min:0},tooltip:{headerFormat:"<b>{series.name}</b><br>",pointFormat:"{point.x:%e. %b}: {point.y:.f} users"},legend:{enabled:!0},credits:{enabled:!1},series:e.chartSeries}}]),angular.module("inspinia").controller("BoxCtrl",["$scope","$http","$rootScope","$filter","$cookieStore",function(e,t,s,a,i){s.lastUpdate=moment().subtract(1,"days").format("YYYY-MM-DD");var o=moment().subtract(2,"days").format("YYYY-MM-DD");e.loadContestCount=function(){t.get("getContestCount").success(function(t){e.contentCount=t[0].count}),t.get("getStatFromFile?date="+s.lastUpdate+"&oldDate="+o).success(function(t){e.stats=t}),t.get("getCoreUserTotal?app=FX&db=TW").success(function(t){e.cuGlobal=t.length}),t.get("getCoreUserTotal?app=FX&db=CN").success(function(t){e.cuChinaFX=t.length}),t.get("getCoreUserTotal?app=FC&db=CN").success(function(t){e.cuChinaFC=t.length}),t.get("getCoreUserTotal?app=SC&db=CN").success(function(t){e.cuChinaSC=t.length})},s.logout=function(){i.remove("connect.sid"),location.href="logout"}}]),$(document).ready(function(){function e(){var e=$("body > #wrapper").height()-61;$(".sidebard-panel").css("min-height",e+"px");var t=$("nav.navbar-default").height(),s=$("#page-wrapper").height();t>s&&$("#page-wrapper").css("min-height",t+"px"),s>t&&$("#page-wrapper").css("min-height",$(window).height()+"px"),$("body").hasClass("fixed-nav")&&$("#page-wrapper").css("min-height",$(window).height()-60+"px")}$(window).bind("load resize scroll",function(){$("body").hasClass("body-small")||e()}),setTimeout(function(){e()})}),$(function(){$(window).bind("load resize",function(){$(this).width()<769?$("body").addClass("body-small"):$("body").removeClass("body-small")})}),angular.module("inspinia").directive("sideNavigation",["$timeout",function(e){return{restrict:"A",link:function(t,s){t.$watch("authentication.user",function(){e(function(){s.metisMenu()})})}}}]).directive("minimalizaSidebar",["$timeout",function(e){return{restrict:"A",template:'<a class="navbar-minimalize minimalize-styl-2 btn btn-danger " href="" ng-init="minimalize()" ng-click="minimalize()"><i class="fa fa-bars"></i></a>',controller:["$scope","$element",function(t){t.minimalize=function(){$(window).width()>=600?angular.element("body").toggleClass("mini-navbar"):angular.element("body").hasClass("body-small")&&angular.element("body").toggleClass("mini-navbar"),!angular.element("body").hasClass("mini-navbar")||angular.element("body").hasClass("body-small")?(angular.element("#side-menu").hide(),e(function(){angular.element("#side-menu").fadeIn(500)},100)):angular.element("#side-menu").removeAttr("style")}}]}}]),angular.module("inspinia").run(["$templateCache",function(e){e.put("components/box/sumbox.html",'<div class="row" ng-controller="BoxCtrl"><div class="col-lg-2"><div class="ibox float-e-margins"><div class="ibox-title"><span class="label label-success pull-right">All Apps</span><h5>Total Users</h5></div><div class="ibox-content"><h1 class="no-margins" ng-bind="(stats.totalUser|number)">0</h1><small>Users</small></div></div></div><div class="col-lg-2"><a href="#/index/core"><div class="ibox float-e-margins"><div class="ibox-title"><h5>Mainland</h5></div><div class="ibox-content"><h1 class="no-margins" ng-bind="((cuChinaFX + cuChinaFC + cuChinaSC)|number)"><i class="fa fa-spinner fa-spin"></i></h1><small>Core Users</small> <span class="stat-percent font-bold text-success ng-binding" ng-bind="((cuChinaFX + $cuChinaFC + cuChinaSC)/ ($root.totalUsersChina) * 100|number:2) + \'%\'"></span></div></div></a></div><div class="col-lg-2"><a href="#/index/core"><div class="ibox float-e-margins"><div class="ibox-title"><h5>Overseas</h5></div><div class="ibox-content"><h1 class="no-margins" ng-bind="(cuGlobal|number)"><i class="fa fa-spinner fa-spin"></i></h1><small>Core Users</small> <span class="stat-percent font-bold text-success ng-binding" ng-bind="(cuGlobal/ ($root.totalUsersGlobal) * 100|number:2) + \'%\'"></span></div></div></a></div><div class="col-lg-2"><div class="ibox float-e-margins"><div class="ibox-title"><span class="label label-info pull-right">Daily</span><h5>Active User</h5></div><div class="ibox-content"><h1 class="no-margins" ng-bind="(stats.activeUser |number) || \'Calculating...\'">0</h1><span class="stat-percent font-bold text-success" ng-bind="(stats.activePer|number:2) + \'%\'"></span> <span class="font-bold" ng-class="stats.activeTrend > 0?\'text-danger\':\'text-navy\'">{{stats.activeTrend|number:2}}% <i class="fa" ng-class="stats.activeTrend > 0?\'fa-level-up\':\'fa-level-down\'"></i></span></div></div></div><div class="col-lg-2"><div class="ibox float-e-margins"><div class="ibox-title"><span class="label label-primary pull-right">Daily</span><h5>New Users</h5></div><div class="ibox-content"><h1 class="no-margins" ng-bind="(stats.newUser|number) || \'Calculating...\'">0</h1><span class="stat-percent font-bold text-navy" ng-bind="(stats.newPer |number:2) + \'%\'"><i class="fa fa-bolt"></i></span> <span class="font-bold" ng-class="stats.newTrend >0?\'text-danger\':\'text-navy\'">{{stats.newTrend |number:2}}% <i class="fa" ng-class="stats.newTrend >0?\'fa-level-up\':\'fa-level-down\'"></i></span></div></div></div><div class="col-lg-2"><div class="ibox float-e-margins"><div class="ibox-title"><span class="label label-danger pull-right">Overseas</span><h5>Contest</h5></div><div class="ibox-content"><h1 class="no-margins" ng-init="loadContestCount()" ng-bind="(contentCount |number)">0</h1><small>Contests Held</small></div></div></div></div>'),e.put("app/public/show.html",'<div class="wrapper wrapper-content animated fadeInRight"><div class="row chartPanel" ng-if="$root.roleRegion ==\'All\'"><div ng-include="\'components/map/map.html\'"></div></div></div>'),e.put("app/main/main.html",'<div class="wrapper wrapper-content animated fadeInRight"><div class="ibox float-e-margins"><div class="ibox-title"><h5>动态资源分配</h5><div class="ibox-tools"></div></div><div class="ibox-content" style="height:1300px"><div class="row"><div class="col-lg-6">原始“交易员-股票”效率分布 <img src="assets/images/eff.png"></div><div class="col-lg-5">“股票-股票”相似性分布 <img src="assets/images/sim.png"></div></div><div class="row"><div class="col-lg-6">推测“交易员-股票”效率分布 <img src="assets/images/weff.png"></div><div class="col-lg-5">资源分配结果（5交易员，50股票，最大股票数5） <img src="assets/images/ra.png"></div></div></div></div></div>'),e.put("components/incu/user_list.html",'<div class="wrapper wrapper-content animated fadeInRight" ng-hide="$root.incuShow"><h3>No access for this account</h3></div><div class="wrapper wrapper-content animated fadeInRight" ng-controller="IncUserListCrol" ng-if="$root.incuShow"><div class="row"><div class="col-lg-6"><div class="col-xs-8 text-left"><span>Daily Total P&L (including fee&commisions)</span><h1 class="font-bold">${{summaryObj.pnl | number:2}}</h1></div><div class="col-xs-4 text-left"><span>Daily Total QTY</span><h1 class="font-bold">{{summaryObj.qty | number}}</h1></div><div class="col-lg-12"><highchart config="chartPieConfig"></highchart></div></div><div class="col-lg-6"><div class="ibox float-e-margins"><div class="ibox-title"><h5>Daily Summary</h5><div class="ibox-tools"></div></div><div class="ibox-content"><div class="table-responsive"><table st-safe-src="summaryList" st-table="displayedSummary" class="table table-striped"><thead><tr><th>Trade Date</th><th>Symbol</th><th st-sort="ACCOUNT_VALUE" st-sort-default="reverse">QTY</th><th st-sort="PNL">P&L</th></tr></thead><tbody><tr ng-repeat="sum in displayedSummary"><td>{{sum["@TRADE_DATE"]}}</td><td>{{sum.SYMBOL}}</td><td>{{sum.QTY|number}}</td><td>{{sum.PNL|number:2}}</td></tr></tbody></table></div></div></div></div><div class="col-lg-12"><div class="ibox float-e-margins"><div class="ibox-title"><h5>Incubatee Daily Performance</h5><div class="ibox-tools" ng-if="$root.exportShow"><a type="button" class="btn btn-sm btn-primary" href="{{historyFilePath}}" download="{{historyFileName}}">Export</a></div></div><div class="ibox-content"><div class="table-responsive"><table st-safe-src="userList" st-table="displayed" class="table table-striped"><thead><tr><th colspan="5"><div class="input-group"><input st-search="USER_ID" class="form-control" placeholder="Search User ID ..." type="text"> <span class="input-group-btn"><button type="button" class="btn btn-sm btn-primary">Go!</button></span></div></th></tr><tr><th>Trade Date</th><th>User Id</th><th st-sort="ACCOUNT_VALUE" st-sort-default="reverse">Account Value</th><th st-sort="PNL">P&L</th><th st-sort="UR_PNL">UR_P&L</th><th st-sort="ALL_TIME_PNL">All Time P&L</th><th st-sort="SUMQTY">Total Qty</th><th st-sort="CNTQTY"># Filled</th><th st-sort="CASH">Cash</th><th st-sort="Ranking">Ranking</th><th st-sort="WinRatio">Win Ratio</th><th st-sort="BiggestWin">Biggest Win</th><th st-sort="BiggestLoss">Biggest Loss</th><th st-sort="AllTimeSharpRatio">All Time Sharp Ratio</th></tr></thead><tbody><tr ng-repeat="userInfo in displayed"><td>{{userInfo["@TRADE_DATE"]}}</td><td><a href="#/index/profile/{{userInfo.USER_ID}}/INC/FX">{{userInfo.USER_ID}}</a></td><td>{{userInfo.ACCOUNT_VALUE|number:2}}</td><td>{{userInfo.PNL|number:2}}</td><td>{{userInfo.UR_PNL|number:2}}</td><td>{{userInfo.ALL_TIME_PNL|number:2}}</td><td>{{userInfo.SUMQTY}}</td><td>{{userInfo.CNTQTY}}</td><td>{{userInfo.CASH|number:2}}</td><td>{{userInfo.Ranking}}</td><td>{{userInfo.WinRatio}}%</td><td>{{userInfo.BiggestWin|number:2}}</td><td>{{userInfo.BiggestLoss|number:2}}</td><td>{{userInfo.AllTimeSharpRatio|number:2}}</td></tr></tbody><tfoot><tr><td colspan="5" class="text-center"><div st-pagination="" st-items-by-page="itemsByPage" st-displayed-pages="7"></div></td></tr></tfoot></table></div></div></div></div></div></div>'),e.put("components/map/map.html",'<div class="col-md-6 chartPanel" ng-controller="MapCtrl"><h3>Global Distribution on Map</h3><div id="map" map="" ng-init="data()"></div></div>'),e.put("components/common/content.html",'<div id="wrapper"><div ng-include="\'components/common/navigation.html\'"></div><div id="page-wrapper" class="gray-bg {{$state.current.name}}"><div ng-include="\'components/common/topnavbar.html\'"></div><div ui-view=""></div><div ng-include="\'components/common/footer.html\'"></div></div></div>'),e.put("components/common/footer.html",'<div class="footer"><div class="pull-right">FDT Dashboard v1.0</div><div><strong>Copyright</strong> FDT &copy; 2016</div></div>'),e.put("components/common/ibox_tools.html",'<div class="ibox-tools dropdown" dropdown=""><a ng-click="showhide()"><i class="fa fa-chevron-up"></i></a> <a class="dropdown-toggle" href="" dropdown-toggle=""><i class="fa fa-wrench"></i></a><ul class="dropdown-menu dropdown-user"><li><a href="">Config option 1</a></li><li><a href="">Config option 2</a></li></ul><a ng-click="closebox()"><i class="fa fa-times"></i></a></div>'),e.put("components/common/navigation.html",'<nav class="navbar-default navbar-static-side" role="navigation"><div class="sidebar-collapse"><ul side-navigation="" class="nav metismenu" id="side-menu"><li class="nav-header"><div class="dropdown profile-element open"><span><img alt="image" style="width:80px" src="assets/images/fdt_bull.png"></span> <a data-toggle="dropdown" class="dropdown-toggle" href="#" aria-expanded="false"><span class="clear"><span class="block m-t-xs"><strong class="font-bold">{{$root.userNick}}</strong></span> <span class="text-muted text-xs block"><b class="caret"></b></span></span></a></div><div class="logo-element"><img alt="image" class="" src="http://incubator.fdt.io/tw/images/fdt_incubator_logo.png" style="width: 40px;"></div></li><li ui-sref-active="active"><a ui-sref="index.trader"><i class="fa fa-user"></i> <span class="nav-label" 交易员表现<="" span=""></span></a><ul class="nav nav-second-level collapse"><li><a ui-sref="index.trader">交易员</a></li><li><a ui-sref="index.stock">股票</a></li><li><a ui-sref="index.stoploss" ng-if="$root.roleRegion==\'All\'">止损</a></li><li><a ui-sref="index.feature" ng-if="$root.roleRegion==\'All\'">特征相关性</a></li><li><a ui-sref="index.ra" ng-if="$root.roleRegion==\'All\'">资源分配</a></li></ul></li><li><a ui-sref="index.main"><i class="fa fa-cube"></i> <span class="nav-label" 资源分配<="" span=""></span></a></li></ul></div></nav>'),e.put("components/common/topnavbar.html",'<div class="row border-bottom" ng-controller="BoxCtrl"><nav class="navbar navbar-static-top white-bg" role="navigation" style="margin-bottom: 0"><div class="navbar-header"><span minimaliza-sidebar=""></span><form role="search" class="navbar-form-custom" method="post" action=""><div class="form-group"><input type="text" placeholder="" class="form-control" name="top-search" id="top-search"></div></form></div><ul class="nav navbar-top-links navbar-right"><li><i class="fa fa-user"></i> <span class="m-r-sm text-muted welcome-message" ng-bind="$root.userNick"></span></li><li><a href="#" ng-click="logout()"><i class="fa fa-sign-out"></i> Log out</a></li></ul></nav></div>'),e.put("components/school/contest.html",'<div class="col-lg-4" ng-controller="ContestCrol"><div class="ibox float-e-margins"><div class="ibox-title"><h5>School User In Contests</h5><div class="ibox-tools"><button type="button" class="btn btn-sm btn-primary">Export</button></div></div><div class="ibox-content"><div class="row"><div class="col-sm-3 m-b-xs"><select class="input-sm form-control input-s-sm inline product-option" ng-options="product.name for product in products" ng-model="selected" ng-change="changeProduct()"></select></div><div class="col-sm-3"></div></div><div class="table-responsive"><table class="table table-striped"><thead><tr><th class="hidden-xs">Contest Name</th><th class="hidden-xs"># Users</th></tr></thead><tbody><tr ng-repeat="contest in contestList"><td>{{contest.name}}</td><td>{{contest.count|number}}</td></tr></tbody></table></div></div></div></div>'),e.put("components/school/count.html",'<div class="col-lg-6 school-count-box"><div class="col-lg-3 text-center"><div class="widget style1"><div class="row"><i class="fa fa-user fa-3x"></i></div><div class="row"><span>Total Users</span><h2 class="font-bold" ng-bind="totalUser"></h2><span></span></div></div></div><div class="col-lg-9"><div class="row m-t-xs"><div class="col-xs-4"><h5 class="m-b-xs">Core Users 30 Days</h5><h1 class="no-margins" ng-bind-html="isChina?coreFX30 + coreSC30 + coreFC30:core30"></h1></div><div class="col-xs-4"><h5 class="m-b-xs">Weekly Active Users</h5><h1 class="no-margins">{{(weekUserFX + weekUserFC + weekUserSC)|number}}</h1></div><div class="col-xs-4"><h5 class="m-b-xs">Monthly Active Users</h5><h1 class="no-margins">{{(monthUserFX + monthUserFC + monthUserSC)|number}}</h1></div></div><table class="table small m-t-sm"><tbody><tr><td><i class="fa fa-key"></i> 60 Days <strong ng-bind-html="isChina?coreFX60 + coreSC60 + coreFC60:core60"></strong></td><td><i class="fa fa-money"></i> FX <strong ng-bind="weekUserFX"></strong></td><td><i class="fa fa-money"></i> FX <strong ng-bind="monthUserFX"></strong></td></tr><tr><td><i class="fa fa-key"></i> > 90 Days <strong ng-bind-html="isChina?coreFX90 + coreSC90 + coreFC90:core90"></strong></td><td ng-show="$root.regionSelected == \'CN\'"><i class="fa fa-line-chart"></i> FC <strong ng-bind="weekUserFC"></strong></td><td ng-show="$root.regionSelected == \'CN\'"><i class="fa fa-line-chart"></i> FC <strong ng-bind="monthUserFC"></strong></td></tr><tr ng-show="$root.regionSelected == \'CN\'"><td></td><td><i class="fa fa-bank"></i> SC <strong ng-bind="weekUserSC"></strong></td><td><i class="fa fa-bank"></i> SC <strong ng-bind="monthUserSC"></strong></td></tr></tbody></table></div></div>'),e.put("components/school/quant.html",'<div class="wrapper wrapper-content animated fadeInRight"><div class="row chartPanel" ng-controller="QuantCrol"><div class="col-lg-12"><highchart config="chartConfig"></highchart></div></div></div>'),e.put("components/school/school.html",'<div class="wrapper wrapper-content animated fadeInRight" ng-hide="$root.schoolShow"><h3>No access for this account</h3></div><div class="wrapper wrapper-content animated fadeInRight" ng-if="$root.schoolShow"><div class="row chartPanel" ng-controller="SchoolCtrl"><div class="row"><div class="col-md-2 selector pull-left"><ui-select ng-model="region.selected" on-select="onRegionSelect($item, $model)" theme="select2" class="form-control" title="Choose a Region"><ui-select-match placeholder="Select or search Region ...">{{$select.selected}}</ui-select-match><ui-select-choices repeat="item in regions | filter: $select.search"><div ng-bind-html="item | highlight: $select.search"></div><img width="19" src="http://lipis.github.io/flag-icon-css/flags/4x3/{{item| lowercase}}.svg"></ui-select-choices></ui-select></div><div class="col-md-3 selector pull-left" ng-show="school_show"><ui-select ng-model="school.selected" on-select="onSchoolSelect($item, $model)" theme="select2" class="form-control" title="Choose a School"><ui-select-match placeholder="Select or search a school name ...">{{$select.selected.school_name}}</ui-select-match><ui-select-choices repeat="school in schools | filter: $select.search"><div ng-bind-html="school.school_name | highlight: $select.search"></div><small ng-bind-html="school.school_key | highlight: $select.search"></small></ui-select-choices></ui-select></div><div class="col-md-2 compare-switch" ng-show="school_show"><span style="float:right">Compare mode</span><div class="switch"><div class="onoffswitch"><input type="checkbox" ng-model="isCompard" class="onoffswitch-checkbox" id="compared"> <label class="onoffswitch-label" for="compared"><span class="onoffswitch-inner"></span></label></div></div></div></div><div class="row"><div ng-include="\'components/school/count.html\'"></div><div ng-include="\'components/school/user_growth.html\'"></div></div></div><div class="row chartPanel"><div ng-include="\'components/school/user_rank.html\'"></div><div ng-include="\'components/school/contest.html\'"></div></div></div>'),e.put("components/school/user_growth.html",'<div class="col-lg-6"><highchart config="chartConfig" class="user-growth-chart"></highchart></div>'),e.put("components/school/user_rank.html",'<div class="col-lg-8" ng-controller="UserRankingCrol"><div class="ibox float-e-margins"><div class="ibox-title"><h5>School User Ranking(By ROI)</h5><div class="ibox-tools"><button type="button" class="btn btn-sm btn-primary">Export</button></div></div><div class="ibox-content"><div class="row"><div class="col-sm-3 m-b-xs"><select class="input-sm form-control input-s-sm inline product-option" ng-options="product.name for product in products" ng-model="selected" ng-change="changeProduct()"></select></div><div class="col-sm-3"></div></div><div class="table-responsive"><table class="table table-striped"><thead><tr><th></th><th>User Name</th><th class="hidden-xs">User Id</th><th class="hidden-xs">Register</th><th class="hidden-xs">Trade Count</th><th class="hidden-xs">Biggest Loss</th><th class="hidden-xs">Ranking</th><th>ROI %</th></tr></thead><tbody><tr ng-repeat="userInfo in userRankList"><td><img class="img-circle" src="{{userInfo.serving_url || \'http://www.hkfdt.cn/favicon.ico\'}}"></td><td><a href="#/index/profile/{{userInfo.user_id}}/{{$root.regionSelected}}/{{selected.name}}">{{userInfo.username | limitTo: 10}}</a></td><td class="hidden-xs">{{userInfo.user_id}}</td><td class="hidden-xs">{{userInfo.created|date}}</td><td class="hidden-xs">{{userInfo.tradescount|number}}</td><td class="neg-number">- {{userInfo.biggestloss|currency:"$"}}</td><td class="hidden-xs">{{userInfo.ranking}}</td><td>{{(userInfo.unit_price - 1 ) * 100|number:2}} %</td></tr></tbody></table><div class="text-center"><div ng-show="rankListLoading"><i class="fa fa-spinner fa-spin"></i></div><button type="button" class="btn btn-sm btn-info" ng-class="userRankList.length>0?\'\':\'disabled\'" ng-click="loaded=true;loadMore()" ng-hide="loaded">Load More</button></div></div></div></div></div>'),e.put("components/chart/chart_cn_au_fc.html",'<div class="col-md-4" ng-controller="ChartAreaCtrl"><highchart ng-init="loadData(\'Date_AU_China_FC\')" config="chartConfig"></highchart><input type="hidden" ng-init="chartConfig.title.text=\'Daily Active Users\'"> <input type="hidden" ng-init="chartConfig.subtitle.text=\'Mainland\'"> <input type="hidden" ng-init="valueName=\'Active Users\'"> <input type="hidden" ng-init="Date_AU_China_FC=\'Mainland Daily Active Users\'"></div><div class="col-md-4" ng-controller="ChartAreaCtrl"><highchart ng-init="loadData(\'Week_AU_China_FC\')" config="chartConfig"></highchart><input type="hidden" ng-init="chartConfig.title.text=\'Weekly Active Users\'"> <input type="hidden" ng-init="chartConfig.subtitle.text=\'Mainland\'"> <input type="hidden" ng-init="valueName=\'Active Users\'"> <input type="hidden" ng-init="Week_AU_China_FC=\'Mainland Weekly Active Users\'"></div><div class="col-md-4" ng-controller="ChartAreaCtrl"><highchart ng-init="loadData(\'Month_AU_China_FC\')" config="chartConfig"></highchart><input type="hidden" ng-init="chartConfig.title.text=\'Monthly Active Users\'"> <input type="hidden" ng-init="chartConfig.subtitle.text=\'Mainland\'"> <input type="hidden" ng-init="valueName=\'Active Users\'"> <input type="hidden" ng-init="Month_AU_China_FC=\'Mainland Monthly Active Users\'"></div>'),e.put("components/chart/chart_cn_au_fx.html",'<div class="col-md-4" ng-controller="ChartAreaCtrl"><highchart ng-init="loadData(\'Date_AU_China_FX\')" config="chartConfig"></highchart><input type="hidden" ng-init="chartConfig.title.text=\'Daily Active Users\'"> <input type="hidden" ng-init="chartConfig.subtitle.text=\'Mainland\'"> <input type="hidden" ng-init="valueName=\'Active Users\'"> <input type="hidden" ng-init="Date_AU_China_FX=\'Mainland Daily Active Users\'"></div><div class="col-md-4" ng-controller="ChartAreaCtrl"><highchart ng-init="loadData(\'Week_AU_China_FX\')" config="chartConfig"></highchart><input type="hidden" ng-init="chartConfig.title.text=\'Weekly Active Users\'"> <input type="hidden" ng-init="chartConfig.subtitle.text=\'Mainland\'"> <input type="hidden" ng-init="valueName=\'Active Users\'"> <input type="hidden" ng-init="Week_AU_China_FX=\'Mainland Weekly Active Users\'"></div><div class="col-md-4" ng-controller="ChartAreaCtrl"><highchart ng-init="loadData(\'Month_AU_China_FX\')" config="chartConfig"></highchart><input type="hidden" ng-init="chartConfig.title.text=\'Monthly Active Users\'"> <input type="hidden" ng-init="chartConfig.subtitle.text=\'Mainland\'"> <input type="hidden" ng-init="valueName=\'Active Users\'"> <input type="hidden" ng-init="Month_AU_China_FX=\'Mainland Monthly Active Users\'"></div>'),e.put("components/chart/chart_cn_au_sc.html",'<div class="col-md-4" ng-controller="ChartAreaCtrl"><highchart ng-init="loadData(\'Date_AU_China_SC\')" config="chartConfig"></highchart><input type="hidden" ng-init="chartConfig.title.text=\'Daily Active Users\'"> <input type="hidden" ng-init="chartConfig.subtitle.text=\'Mainland\'"> <input type="hidden" ng-init="valueName=\'Active Users\'"> <input type="hidden" ng-init="Date_AU_China_SC=\'Mainland Daily Active Users\'"></div><div class="col-md-4" ng-controller="ChartAreaCtrl"><highchart ng-init="loadData(\'Week_AU_China_SC\')" config="chartConfig"></highchart><input type="hidden" ng-init="chartConfig.title.text=\'Weekly Active Users\'"> <input type="hidden" ng-init="chartConfig.subtitle.text=\'Mainland\'"> <input type="hidden" ng-init="valueName=\'Active Users\'"> <input type="hidden" ng-init="Week_AU_China_SC=\'Mainland Weekly Active Users\'"></div><div class="col-md-4" ng-controller="ChartAreaCtrl"><highchart ng-init="loadData(\'Month_AU_China_SC\')" config="chartConfig"></highchart><input type="hidden" ng-init="chartConfig.title.text=\'Monthly Active Users\'"> <input type="hidden" ng-init="chartConfig.subtitle.text=\'Mainland\'"> <input type="hidden" ng-init="valueName=\'Active Users\'"> <input type="hidden" ng-init="Month_AU_China_SC=\'Mainland Monthly Active Users\'"></div>'),e.put("components/chart/chart_cn_nu.html",'<div class="col-md-4" ng-controller="ChartAreaCtrl"><highchart ng-init="loadData(\'Date_NU_China\')" config="chartConfig"></highchart><input type="hidden" ng-init="chartConfig.title.text=\'Daily New Users\'"> <input type="hidden" ng-init="valueName=\'New Users\'"> <input type="hidden" ng-init="Date_NU_China=\'Mainland Daily New Users\'"></div><div class="col-md-4" ng-controller="ChartAreaCtrl"><highchart ng-init="loadData(\'Week_NU_China\')" config="chartConfig"></highchart><input type="hidden" ng-init="chartConfig.title.text=\'Weekly New Users\'"> <input type="hidden" ng-init="valueName=\'New Users\'"> <input type="hidden" ng-init="Week_NU_China=\'Mainland Weekly New Users\'"></div><div class="col-md-4" ng-controller="ChartAreaCtrl"><highchart ng-init="loadData(\'Month_NU_China\')" config="chartConfig"></highchart><input type="hidden" ng-init="chartConfig.title.text=\'Monthly New Users\'"> <input type="hidden" ng-init="valueName=\'New Users\'"> <input type="hidden" ng-init="Month_NU_China=\'Mainland Monthly New Users\'"></div>'),e.put("components/chart/chart_fx_fc_sc.html",'<div class="col-md-6" ng-controller="ChartCtrl"><highchart ng-init="loadData(\'Date_TU_China_FX|Date_TU_China_FC|Date_TU_China_SC\')" config="chartConfig"></highchart><input type="hidden" ng-init="chartConfig.title.text=\'Mainland FX FC SC\'"> <input type="hidden" ng-init="valueName=\'Total Users\'"> <input type="hidden" ng-init="Date_TU_China_FX=\'Mainland FX\'"> <input type="hidden" ng-init="Date_TU_China_FC=\'Mainland FC\'"> <input type="hidden" ng-init="Date_TU_China_SC=\'Mainland SC\'"></div>'),e.put("components/chart/chart_gb_au.html",'<div class="col-md-4" ng-controller="ChartAreaCtrl"><highchart ng-init="loadData(\'Date_AU_Global_FX\')" config="chartConfig"></highchart><input type="hidden" ng-init="chartConfig.title.text=\'Daily Active Users\'"> <input type="hidden" ng-init="chartConfig.subtitle.text=\'Overseas\'"> <input type="hidden" ng-init="valueName=\'Active Users\'"> <input type="hidden" ng-init="Date_AU_Global_FX=\'Overseas Daily Active Users\'"></div><div class="col-md-4" ng-controller="ChartAreaCtrl"><highchart ng-init="loadData(\'Week_AU_Global_FX\')" config="chartConfig"></highchart><input type="hidden" ng-init="chartConfig.title.text=\'Weekly Active Users\'"> <input type="hidden" ng-init="chartConfig.subtitle.text=\'Overseas\'"> <input type="hidden" ng-init="valueName=\'Active Users\'"> <input type="hidden" ng-init="Week_AU_Global_FX=\'Overseas Weekly Active Users\'"></div><div class="col-md-4" ng-controller="ChartAreaCtrl"><highchart ng-init="loadData(\'Month_AU_Global_FX\')" config="chartConfig"></highchart><input type="hidden" ng-init="chartConfig.title.text=\'Monthly Active Users\'"> <input type="hidden" ng-init="chartConfig.subtitle.text=\'Overseas\'"> <input type="hidden" ng-init="valueName=\'Active Users\'"> <input type="hidden" ng-init="Month_AU_Global_FX=\'Overseas Monthly Active Users\'"></div>'),e.put("components/chart/chart_gb_nu.html",'<div class="col-md-4" ng-controller="ChartAreaCtrl"><highchart ng-init="loadData(\'Date_NU_Global\')" config="chartConfig"></highchart><input type="hidden" ng-init="chartConfig.title.text=\'Daily New Users\'"> <input type="hidden" ng-init="chartConfig.subtitle.text=\'Overseas\'"> <input type="hidden" ng-init="valueName=\'New Users\'"> <input type="hidden" ng-init="Date_NU_Global=\'Overseas Daily New Users\'"></div><div class="col-md-4" ng-controller="ChartAreaCtrl"><highchart ng-init="loadData(\'Week_NU_Global\')" config="chartConfig"></highchart><input type="hidden" ng-init="chartConfig.title.text=\'Weekly New Users\'"> <input type="hidden" ng-init="chartConfig.subtitle.text=\'Overseas\'"> <input type="hidden" ng-init="valueName=\'New Users\'"> <input type="hidden" ng-init="Week_NU_Global=\'Overseas Weekly New Users\'"></div><div class="col-md-4" ng-controller="ChartAreaCtrl"><highchart ng-init="loadData(\'Month_NU_Global\')" config="chartConfig"></highchart><input type="hidden" ng-init="chartConfig.title.text=\'Monthly New Users\'"> <input type="hidden" ng-init="chartConfig.subtitle.text=\'Overseas\'"> <input type="hidden" ng-init="valueName=\'New Users\'"> <input type="hidden" ng-init="Month_NU_Global=\'Overseas Monthly New Users\'"></div>'),e.put("components/chart/chart_global_dist.html",'<div ng-controller="ChartComLineCtrl"><div class="col-md-6"><highchart ng-init="loadData(\'Date_Global_Country_TU|Global_Country_TU\')" config="chartConfig"></highchart><input type="hidden" ng-init="chartConfig.title.text=\'Global Distribution\'"></div></div>'),e.put("components/chart/chart_tu.html",'<div class="row"><div class="col-lg-6" ng-controller="ChartCtrl"><highchart ng-init="loadData(\'Date_TU_Global|Date_TU_China\')" config="chartConfig" class="span9"></highchart><input type="hidden" ng-init="chartConfig.title.text=\'Total User Growth\'"> <input type="hidden" ng-init="valueName=\'Total Users\'"> <input type="hidden" ng-init="Date_TU_Global=\'Overseas\'"> <input type="hidden" ng-init="Date_TU_China=\'Mainland\'"> <input type="hidden" ng-init="chartType=\'area\'"> <input type="hidden" ng-init="chartConfig.colors=[\'#0000ff\',\'ff0066\',\'2b908f\']"></div><div class="col-lg-6" ng-controller="ChartActiveCtrl"><highchart ng-init="loadData()" config="chartConfig" class="span9"></highchart><input type="hidden" ng-init="chartConfig.title.text=\'Active User Percentage\'"></div></div>'),e.put("components/chart/chart_tw_au.html",'<div class="col-md-4" ng-controller="ChartAreaCtrl"><highchart ng-init="loadData(\'Date_AU_TW_FX\')" config="chartConfig"></highchart><input type="hidden" ng-init="chartConfig.title.text=\'Daily Active Users\'"> <input type="hidden" ng-init="chartConfig.subtitle.text=\'Taiwan\'"> <input type="hidden" ng-init="valueName=\'Active Users\'"> <input type="hidden" ng-init="Date_AU_TW_FX=\'Taiwan Daily Active Users\'"></div><div class="col-md-4" ng-controller="ChartAreaCtrl"><highchart ng-init="loadData(\'Week_AU_TW_FX\')" config="chartConfig"></highchart><input type="hidden" ng-init="chartConfig.title.text=\'Weekly Active Users\'"> <input type="hidden" ng-init="chartConfig.subtitle.text=\'Taiwan\'"> <input type="hidden" ng-init="valueName=\'Active Users\'"> <input type="hidden" ng-init="Week_AU_TW_FX=\'Taiwan Weekly Active Users\'"></div><div class="col-md-4" ng-controller="ChartAreaCtrl"><highchart ng-init="loadData(\'Month_AU_TW_FX\')" config="chartConfig"></highchart><input type="hidden" ng-init="chartConfig.title.text=\'Monthly Active Users\'"> <input type="hidden" ng-init="chartConfig.subtitle.text=\'Taiwan\'"> <input type="hidden" ng-init="valueName=\'Active Users\'"> <input type="hidden" ng-init="Month_AU_TW_FX=\'Taiwan Monthly Active Users\'"></div>'),e.put("components/chart/chart_tw_nu.html",'<div class="col-md-4" ng-controller="ChartAreaCtrl"><highchart ng-init="loadData(\'Date_NU_TW\')" config="chartConfig"></highchart><input type="hidden" ng-init="chartConfig.title.text=\'Daily New Users\'"> <input type="hidden" ng-init="valueName=\'New Users\'"> <input type="hidden" ng-init="Date_NU_TW=\'TW Daily New Users\'"></div><div class="col-md-4" ng-controller="ChartAreaCtrl"><highchart ng-init="loadData(\'Week_NU_TW\')" config="chartConfig"></highchart><input type="hidden" ng-init="chartConfig.title.text=\'Weekly New Users\'"> <input type="hidden" ng-init="valueName=\'New Users\'"> <input type="hidden" ng-init="Week_NU_TW=\'TW Weekly New Users\'"></div><div class="col-md-4" ng-controller="ChartAreaCtrl"><highchart ng-init="loadData(\'Month_NU_TW\')" config="chartConfig"></highchart><input type="hidden" ng-init="chartConfig.title.text=\'Monthly New Users\'"> <input type="hidden" ng-init="valueName=\'New Users\'"> <input type="hidden" ng-init="Month_NU_TW=\'TW Monthly New Users\'"></div>'),e.put("components/chart/china_channel_dist.html",'<div class="col-md-6" ng-controller="ChartPieCtrl"><highchart ng-init="loadData()" config="chartPieConfig"></highchart><input type="hidden" ng-init="chartPieConfig.title.text=\'China Download Channel Distubution\'"></div>'),e.put("components/chart/overlap.html",'<div class="col-md-6" ng-controller="ChartCtrl"><highchart ng-init="loadData(\'FX_FC_Overlap|FX_SC_Overlap|FC_SC_Overlap|FX_FC_SC_Overlap\')" config="chartConfig"></highchart><input type="hidden" ng-init="chartConfig.title.text=\'FX FC SC Users\'"> <input type="hidden" ng-init="chartConfig.subtitle.text=\'Overlaping Users\'"> <input type="hidden" ng-init="valueName=\'Common Users\'"> <input type="hidden" ng-init="FX_FC_Overlap=\'FX&FC\'"> <input type="hidden" ng-init="FX_SC_Overlap=\'FX&SC\'"> <input type="hidden" ng-init="FC_SC_Overlap=\'FC&SC\'"> <input type="hidden" ng-init="FX_FC_SC_Overlap=\'FX&FC&SC\'"></div>'),e.put("components/chart/venn.html",'<div class="col-md-6 venn-panel" ng-controller="VennCtrl"><div id="venn" venn="vennData" ng-init="loadData(\'China_FX_FC_SC_TU\')"></div></div>'),e.put("components/stock/predict.html",'<div class="wrapper wrapper-content animated fadeInRight"><div class="row" ng-controller="PredictCrol"><div class="col-lg-12"><div class="ibox float-e-margins"><div class="ibox-title"><h5>预测股票振幅前50 (实际观察日：{{obsDate}})</h5><div class="ibox-tools">上证指数： <span ng-class="shIndexVar>0?\'stock-up\':\'stock-down\'">{{shIndex[3]}} <i class="fa" ng-class="shIndexVar>0?\'fa-level-up\':\'fa-level-down\'"></i> {{shIndexVar|number:2 }} %</span> 振幅： {{indexVol | number : 2}} %</div></div><div class="ibox-content col-lg-5"><div class="table-responsive"><table class="table table-striped"><thead><tr><th></th><th>平均振幅</th><th>平均振幅/大盘振幅</th></tr></thead><tbody><tr><td>前10名</td><td>{{top10Mean |number:2}} %</td><td>{{top10Mean/indexVol |number:2}} 倍</td></tr><tr><td>前20名</td><td>{{top20Mean |number:2}} %</td><td>{{top20Mean/indexVol |number:2}} 倍</td></tr><tr><td>前30名</td><td>{{top30Mean |number:2}} %</td><td>{{top30Mean/indexVol |number:2}} 倍</td></tr><tr><td>前40名</td><td>{{top40Mean |number:2}} %</td><td>{{top40Mean/indexVol |number:2}} 倍</td></tr></tbody></table></div></div><div class="ibox-content"><div class="table-responsive"><table class="table table-striped"><thead><tr><th>预测振幅排名</th><th>股票代码</th><th>股票名字</th><th>现价</th><th>涨跌</th><th>涨跌幅</th><th>实际振幅</th><th>实际振幅/大盘振幅</th><th>成交量</th><th>市值</th><th>换手率</th><th>相关新闻</th></tr></thead><tbody><tr ng-repeat="stock in predictList"><td ng-show="stock.realtimeInfo">{{$index}}</td><td ng-show="stock.realtimeInfo"><a target="_blank" href="http://finance.ifeng.com/app/hq/stock/{{stock.symbol.indexOf(\'6\')==0?\'sh\':\'sz\'}}{{stock.symbol}}">{{stock.symbol}}</a></td><td ng-show="stock.realtimeInfo">{{stock.realtimeInfo.name}}</td><td ng-show="stock.realtimeInfo">{{stock.realtimeInfo.trade|number:2}}</td><td ng-show="stock.realtimeInfo" ng-class="stock.realtimeInfo.pricechange>0?\'stock-up\':\'stock-down\'">{{stock.realtimeInfo.pricechange|number:2}}</td><td ng-show="stock.realtimeInfo" ng-class="stock.realtimeInfo.pricechange>0?\'stock-up\':\'stock-down\'">{{stock.realtimeInfo.changepercent|number:2}}%</td><td ng-show="stock.realtimeInfo" style="font-weight:bold; color: purple">{{(stock.realtimeInfo.high - stock.realtimeInfo.low)/stock.realtimeInfo.open* 100|number:2}}%</td><td ng-show="stock.realtimeInfo">{{((stock.realtimeInfo.high - stock.realtimeInfo.low)/stock.realtimeInfo.open* 100 / indexVol)|number:2}} 倍</td><td ng-show="stock.realtimeInfo">{{stock.realtimeInfo.volume/(100*10000) |number:2}} 万手</td><td ng-show="stock.realtimeInfo">{{stock.realtimeInfo.mktcap/10000|number:2}} 亿</td><td ng-show="stock.realtimeInfo">{{stock.realtimeInfo.turnoverratio|number:3}} %</td><td ng-show="stock.realtimeInfo"><a target="_blank" href="http://news.baidu.com/ns?word={{stock.realtimeInfo.name}}&sr=0&cl=2&rn=20&tn=news&ct=0&clk=sortbytime">相关新闻</a></td></tr></tbody></table></div></div></div></div></div></div>'),e.put("components/seed/user_list.html",'<div class="wrapper wrapper-content animated fadeInRight" ng-hide="$root.seedShow"><h3>No access for this account</h3></div><div class="wrapper wrapper-content animated fadeInRight" ng-if="$root.seedShow"><div class="row" ng-controller="SeedUserListCrol"><div class="col-lg-6"><div class="col-xs-8 text-left"><span>Daily Total P&L (including fee&commisions)</span><h1 class="font-bold">${{summaryObj.pnl | number:2}}</h1></div><div class="col-xs-4 text-left"><span>Daily Total QTY</span><h1 class="font-bold">{{summaryObj.qty | number}}</h1></div><div class="col-lg-12"><highchart config="chartPieConfig"></highchart></div></div><div class="col-lg-6"><div class="ibox float-e-margins"><div class="ibox-title"><h5>Daily Summary</h5><div class="ibox-tools"></div></div><div class="ibox-content"><div class="table-responsive"><table st-safe-src="summaryList" st-table="displayedSummary" class="table table-striped"><thead><tr><th>Trade Date</th><th>Symbol</th><th st-sort="ACCOUNT_VALUE" st-sort-default="reverse">QTY</th><th st-sort="PNL">P&L</th></tr></thead><tbody><tr ng-repeat="sum in displayedSummary"><td>{{sum["@TRADE_DATE"]}}</td><td>{{sum.SYMBOL}}</td><td>{{sum.QTY|number}}</td><td>{{sum.PNL|number:2}}</td></tr></tbody></table></div></div></div></div><div class="col-lg-12"><div class="ibox float-e-margins"><div class="ibox-title"><h5>Seed Daily Performance</h5><div class="ibox-tools" ng-if="$root.exportShow"><a type="button" class="btn btn-sm btn-primary" href="{{historyFilePath}}" download="{{historyFileName}}">Export</a></div></div><div class="ibox-content"><div class="table-responsive"><table st-safe-src="userList" st-table="displayed" class="table table-striped"><thead><tr><th colspan="5"><div class="input-group"><input st-search="USER_ID" class="form-control" placeholder="Search User ID ..." type="text"> <span class="input-group-btn"><button type="button" class="btn btn-sm btn-primary">Go!</button></span></div></th></tr><tr><th>Trade Date</th><th>User Id</th><th st-sort="ACCOUNT_VALUE" st-sort-default="reverse">Account Value</th><th st-sort="PNL">P&L</th><th st-sort="UR_PNL">UR_P&L</th><th st-sort="ALL_TIME_PNL">All Time P&L</th><th st-sort="SUMQTY">Total Qty</th><th st-sort="CNTQTY"># Filled</th><th st-sort="CASH">Cash</th><th st-sort="Ranking">Ranking</th><th st-sort="WinRatio">Win Ratio</th><th st-sort="BiggestWin">Biggest Win</th><th st-sort="BiggestLoss">Biggest Loss</th><th st-sort="AllTimeSharpRatio">All Time Sharp Ratio</th></tr></thead><tbody><tr ng-repeat="userInfo in displayed"><td>{{userInfo["@TRADE_DATE"]}}</td><td><a href="#/index/profile/{{userInfo.USER_ID}}/SEED/FX">{{userInfo.USER_ID}}</a></td><td>{{userInfo.ACCOUNT_VALUE|number:2}}</td><td>{{userInfo.PNL|number:2}}</td><td>{{userInfo.UR_PNL|number:2}}</td><td>{{userInfo.ALL_TIME_PNL|number:2}}</td><td>{{userInfo.SUMQTY}}</td><td>{{userInfo.CNTQTY}}</td><td>{{userInfo.CASH|number:2}}</td><td>{{userInfo.Ranking}}</td><td>{{userInfo.WinRatio}}%</td><td>{{userInfo.BiggestWin|number:2}}</td><td>{{userInfo.BiggestLoss|number:2}}</td><td>{{userInfo.AllTimeSharpRatio|number:2}}</td></tr></tbody><tfoot><tr><td colspan="5" class="text-center"><div st-pagination="" st-items-by-page="itemsByPage" st-displayed-pages="7"></div></td></tr></tfoot></table></div></div></div></div></div></div>'),e.put("components/trader/alloc.html",'<div class="wrapper wrapper-content animated fadeInRight" ng-controller="AllocCtrl"><div class="row"><div class="col-lg-12"><div class="ibox"><div class="ibox-content"><div class="table-responsive"><table class="table table-striped" st-table="userDisplayed" st-safe-src="allocList"><thead><tr><th colspan="5"><div class="input-group"><input st-search="user_id" placeholder="搜索" type="text"> <span class="input-group-btn"></span></div></th></tr><tr><th>交易員ID</th><th>分配股票1</th><th>效率</th><th>分配量</th><th>分配股票2</th><th>效率</th><th>分配量</th><th>分配股票3</th><th>效率</th><th>分配量</th><th>分配股票4</th><th>效率</th><th>分配量</th><th>分配股票5</th><th>效率</th><th>分配量</th></tr></thead><tbody><tr ng-repeat="user in userDisplayed" class="traderListItem"><td>{{user.user_id}}</td><td style="background-color: #F3F2EE;"><a href="http://quote.eastmoney.com/{{user.res_array[0].symbol}}.html">{{user.res_array[0].symbol}}</a></td><td style="background-color: #F3F2EE;" ng-class="user.res_array[0].infer == 1?\'stock-infer\':\'stock-compute\'">{{user.res_array[0].eff|number:9}}</td><td style="background-color: #F3F2EE;">{{user.res_array[0].qty|number:2}}</td><td style="background-color: #E3FBD6;"><a href="http://quote.eastmoney.com/{{user.res_array[1].symbol}}.html">{{user.res_array[1].symbol}}</a></td><td style="background-color: #E3FBD6;" ng-class="user.res_array[0].infer == 1?\'stock-infer\':\'stock-compute\'">{{user.res_array[1].eff|number:9}}</td><td style="background-color: #E3FBD6;">{{user.res_array[1].qty|number:2}}</td><td style="background-color: #D6F9FB;"><a href="http://quote.eastmoney.com/{{user.res_array[2].symbol}}.html">{{user.res_array[2].symbol}}</a></td><td style="background-color: #D6F9FB;" ng-class="user.res_array[0].infer == 1?\'stock-infer\':\'stock-compute\'">{{user.res_array[2].eff|number:9}}</td><td style="background-color: #D6F9FB;">{{user.res_array[2].qty|number:2}}</td><td style="background-color: #D8D6FB;"><a href="http://quote.eastmoney.com/{{user.res_array[3].symbol}}.html">{{user.res_array[3].symbol}}</a></td><td style="background-color: #D8D6FB;" ng-class="user.res_array[0].infer == 1?\'stock-infer\':\'stock-compute\'">{{user.res_array[3].eff|number:9}}</td><td style="background-color: #D8D6FB;">{{user.res_array[3].qty|number:2}}</td><td style="background-color: #FBD6D6;"><a href="http://quote.eastmoney.com/{{user.res_array[4].symbol}}.html">{{user.res_array[4].symbol}}</a></td><td style="background-color: #FBD6D6;" ng-class="user.res_array[0].infer == 1?\'stock-infer\':\'stock-compute\'">{{user.res_array[4].eff|number:9}}</td><td style="background-color: #FBD6D6;">{{user.res_array[4].qty|number:2}}</td></tr></tbody><tfoot><tr><td colspan="5" class="text-center"><div st-pagination="" st-items-by-page="itemsByPage" st-displayed-pages="10"></div></td></tr></tfoot></table></div></div></div></div></div><div class="ibox float-e-margins"><div class="ibox-title"><h5>动态资源分配</h5><div class="ibox-tools"></div></div><div class="ibox-content" style="height:1300px"><div class="row"><div class="col-lg-6">原始“交易员-股票”效率分布 <img src="assets/images/eff.png"></div><div class="col-lg-5">“股票-股票”相似性分布 <img src="assets/images/sim.png"></div></div><div class="row"><div class="col-lg-6">推测“交易员-股票”效率分布 <img src="assets/images/weff.png"></div><div class="col-lg-5">资源分配结果（5交易员，50股票，最大股票数5） <img src="assets/images/ra.png"></div></div></div></div></div>'),e.put("components/trader/feature.html",'<div class="wrapper wrapper-content animated fadeInRight" ng-controller="FeatureCtrl"><div class="ibox float-e-margins"><div class="ibox-title"><h5>特征相关性</h5><div class="ibox-tools"></div></div><div class="ibox-content"><div class="row" ng-repeat="img in imgs"><div class="col-lg-12"><img style="width:100%;display: block;float: left;" src="data:image/png;base64,{{img.img}}"></div></div></div></div></div>'),e.put("components/trader/stock.html",'<div class="wrapper wrapper-content animated fadeInRight" ng-controller="StockCtrl"><div class="row"><div class="col-lg-12"><div class="ibox"><div class="ibox-content"><div class="table-responsive"><table class="table table-striped" st-table="userDisplayed" st-safe-src="traderList"><thead><tr><th colspan="5"><div class="input-group"><input st-search="user_id" placeholder="搜索" type="text"> <span class="input-group-btn"></span></div></th></tr><tr><th>排名</th><th>股票代码</th><th st-sort="fdt.score" st-sort-default="reverse">FDT Score</th><th st-sort="rank">明天振幅预测</th><th st-sort="ft_avg_daily_pnl.raw">日均盈利</th><th st-sort="{{cate.feature}}.raw" ng-repeat="cate in cates">{{cate.name}}</th><th st-sort="ft_tdd.raw">交易天数</th><th st-sort="ft_pnl_efficiency.raw">总盈利效率</th><th st-sort="ft_min_neg_pnl.raw">最大单笔损失</th></tr></thead><tbody><tr ng-repeat="user in userDisplayed" class="traderListItem"><td ng-click="loadFDTScore(user.user_id)" ng-class="{traderListItemSelected: selected == user.user_id}">{{user.rank}}</td><td ng-click="loadFDTScore(user.user_id)" ng-class="{traderListItemSelected: selected == user.user_id}"><a target="_blank" href="http://quote.eastmoney.com/{{user.user_id}}.html">{{user.user_id}}</a></td><td ng-click="loadFDTScore(user.user_id)" ng-class="{traderListItemSelected: selected == user.user_id}">{{user.fdt.score | number :3 }}</td><td ng-click="loadFDTScore(user.user_id)" ng-class="{traderListItemSelected: selected == user.user_id}">{{predictMap[user.user_id] || "计算中" | number:2}} %</td><td ng-click="loadFDTScore(user.user_id)" ng-class="{traderListItemSelected: selected == user.user_id}">¥ {{user.ft_avg_daily_pnl.raw|number :2}}</td><td ng-click="loadFDTScore(user.user_id)" ng-class="{traderListItemSelected: selected == user.user_id}" ng-repeat="cate in cates">{{user[cate.feature].raw | number:6}}</td><td ng-click="loadFDTScore(user.user_id)" ng-class="{traderListItemSelected: selected == user.user_id}">{{user.ft_tdd.raw }}</td><td ng-click="loadFDTScore(user.user_id)" ng-class="{traderListItemSelected: selected == user.user_id}">{{user.ft_pnl_efficiency.raw | number :6 }}</td><td ng-click="loadFDTScore(user.user_id)" ng-class="{traderListItemSelected: selected == user.user_id}">{{user.ft_min_neg_pnl.raw | number :6 }}</td></tr></tbody><tfoot><tr><td colspan="5" class="text-center"><div st-pagination="" st-items-by-page="itemsByPage" st-displayed-pages="10"></div></td></tr></tfoot></table></div></div></div></div></div><div class="row"><div class="col-lg-8"><div class="ibox"><div class="ibox-title"><h5>最近30天表现最好股票</h5><div class="ibox-tools">上证指数： <span ng-class="shIndexVar>0?\'stock-up\':\'stock-down\'">{{shIndex[3]}} <i class="fa" ng-class="shIndexVar>0?\'fa-level-up\':\'fa-level-down\'"></i> {{shIndexVar|number:2 }} %</span> 振幅： {{indexVol | number : 2}} %</div></div><div class="ibox-content"><div class="table-responsive"><table class="table table-striped" st-table="stockArrDisplayed" st-safe-src="stockArr"><thead><tr><th>股票</th><th>股票名称</th><th st-sort="eff" st-sort-default="reverse">盈利效率</th><th st-sort="rank">预计振幅排名</th><th st-sort="voli">实际振幅</th><th st-sort="voli">实际振幅/大盘振幅</th></tr></thead><tbody><tr ng-repeat="stock in stockArrDisplayed"><td><a target="_blank" href="http://quote.eastmoney.com/{{(\'00000\'+ stock.stockCode).slice(-6)}}.html">{{(\'00000\'+ stock.stockCode).slice(-6)}}</a></td><td>{{stock.stockName}}</td><td>{{stock.eff*100|number:6}} %</td><td>{{stock.rank}}</td><td>{{(stock.info.high - stock.info.low)/stock.info.settlement* 100|number:2}}%</td><td>{{((stock.info.high - stock.info.low)/stock.info.open* 100 / indexVol)|number:2}} 倍</td></tr></tbody><tfoot><tr><td colspan="5" class="text-center"><div st-pagination="" st-items-by-page="itemsByPage" st-displayed-pages="10"></div></td></tr></tfoot></table></div></div></div></div></div></div>'),e.put("components/trader/stoploss.html",'<div class="wrapper wrapper-content animated fadeInRight" ng-controller="StoplossCtrl"><div class="row"><div class="col-lg-12"><div class="ibox"><div class="ibox-content"><div class="table-responsive"><table class="table table-striped" st-table="userDisplayed" st-safe-src="stoplossList"><thead><tr><th colspan="5"><div class="input-group"><input st-search="user_id" placeholder="搜索" type="text"> <span class="input-group-btn"></span></div></th></tr><tr><th>交易員ID</th><th st-sort="last_trade_date" st-sort-default="reverse">最后交易日</th><th st-sort="trade_days">交易天数</th><th st-sort="min_stoploss">最小止损额</th><th st-sort="all_net_pnl">总净盈利</th><th st-sort="daily_exp_pnl">日指数平均盈利</th><th st-sort="daily_exp_pos_pnl">日指数正向平均盈利</th><th st-sort="mkt_vol_r">今日上证量比</th><th st-sort="max_loss">交易员历史最大损失</th><th st-sort="black_allert">黑色止损线</th><th st-sort="red_allert">红色止损线</th><th st-sort="yellow_allert">黄色止损线</th></tr></thead><tbody><tr ng-repeat="user in userDisplayed" class="traderListItem"><td>{{user.user_id}}</td><td>{{user.last_trade_date}}</td><td>{{user.trade_days}}</td><td>{{user.min_stoploss | number:2}}</td><td>{{user.all_net_pnl | number:2}}</td><td>{{user.daily_exp_pnl | number:2}}</td><td>{{user.daily_exp_pos_pnl | number:2}}</td><td>{{user.mkt_vol_r | number:2}}</td><td>{{user.max_loss | number:2}}</td><td>{{user.black_allert | number:2}}</td><td style="color:#ED5565">{{user.red_allert | number:2}}</td><td style="color:#DCB466">{{user.yellow_allert | number:2}}</td></tr></tbody><tfoot><tr><td colspan="5" class="text-center"><div st-pagination="" st-items-by-page="itemsByPage" st-displayed-pages="10"></div></td></tr></tfoot></table></div></div></div></div></div><div class="row"><div class="col-lg-12"><highchart config="chartScatterConfig"></highchart></div></div></div>'),e.put("components/trader/trader_list.html",'<div class="wrapper wrapper-content animated fadeInRight" ng-controller="TraderCtrl"><div class="row"><div class="col-lg-12"><div class="ibox"><div class="ibox-content"><div class="table-responsive"><table class="table table-striped" st-table="userDisplayed" st-safe-src="traderList"><thead><tr><th colspan="13"><div class="input-group"><input st-search="user_id" placeholder="搜索" type="text"> <span class="input-group-btn"></span></div></th><th colspan="3"><span>时间范围：</span><select class="input-sm form-control input-s-sm inline product-option" ng-options="date.display for date in dateRanges" ng-model="dateSelected" ng-change="changeFt()" style="width: 50%"></select></th></tr><tr><th>排名</th><th>交易员 ID</th><th st-sort="fdt.score" st-sort-default="reverse">FDT Score</th><th st-sort="ft_avg_daily_pnl.raw">日均盈利</th><th st-sort="{{cate.feature}}.raw" ng-repeat="cate in cates">{{cate.name}}</th><th st-sort="ft_tdd.raw">交易天数</th><th st-sort="ft_pnl_efficiency.raw">总盈利效率</th><th st-sort="ft_min_neg_pnl.raw">最大单笔损失</th></tr></thead><tbody><tr ng-repeat="user in userDisplayed" class="traderListItem"><td ng-click="loadFDTScore(user.user_id)" ng-class="{traderListItemSelected: selected == user.user_id}">{{user.rank}}</td><td ng-click="loadFDTScore(user.user_id)" ng-class="{traderListItemSelected: selected == user.user_id}">{{user.user_id}}</td><td ng-click="loadFDTScore(user.user_id)" ng-class="{traderListItemSelected: selected == user.user_id}">{{user.fdt.score | number :3 }}</td><td ng-click="loadFDTScore(user.user_id)" ng-class="{traderListItemSelected: selected == user.user_id}">¥ {{user.ft_avg_daily_pnl.raw|number :2}}</td><td ng-click="loadFDTScore(user.user_id)" ng-class="{traderListItemSelected: selected == user.user_id}" ng-repeat="cate in cates">{{user[cate.feature].raw | number:6}}</td><td ng-click="loadFDTScore(user.user_id)" ng-class="{traderListItemSelected: selected == user.user_id}">{{user.ft_tdd.raw }}</td><td ng-click="loadFDTScore(user.user_id)" ng-class="{traderListItemSelected: selected == user.user_id}">{{user.ft_pnl_efficiency.raw | number :6 }}</td><td ng-click="loadFDTScore(user.user_id)" ng-class="{traderListItemSelected: selected == user.user_id}">{{user.ft_min_neg_pnl.raw | number :6 }}</td></tr></tbody><tfoot><tr><td colspan="5" class="text-center"><div st-pagination="" st-items-by-page="itemsByPage" st-displayed-pages="10"></div></td></tr></tfoot></table></div></div></div></div></div><div class="row"><div class="col-lg-4"><highchart config="chartSeedSCScoreConfig"></highchart><highchart config="chartSeedStyleScoreConfig"></highchart></div><div class="col-lg-8"><highchart config="chartAccPnlConfig" class="trader-chart"></highchart><highchart config="chartIndexConfig" class="trader-chart"></highchart><highchart config="chartEffConfig" class="trader-chart"></highchart><highchart config="chartFeeConfig" class="trader-chart"></highchart><highchart config="chartVolConfig" class="trader-chart"></highchart><div class="table-responsive"><table class="table table-striped" st-table="closedDisplayed" st-safe-src="closedList"><thead><tr><th>交易员ID</th><th st-sort="TradeDate" st-sort-default="reverse">交易日期</th><th>股票代码</th><th>股票名称</th><th st-sort="TotalShares">交易股数</th><th st-sort="TotalTradeMoney">交易额</th><th st-sort="TotalFee">交易费用</th><th st-sort="TotalTrades">交易次数</th><th st-sort="RealizedNet">实现盈亏</th></tr></thead><tbody><tr ng-repeat="trade in closedDisplayed"><td>{{trade.Trader}}</td><td>{{trade.TradeDate}}</td><td>{{(\'00000\'+trade.StkCode).slice(-6)}}</td><td><a target="_blank" href="http://quote.eastmoney.com/{{(\'00000\'+trade.StkCode).slice(-6)}}.html">{{trade.StkName}}</a></td><td>{{trade.TotalShares}}</td><td>¥ {{trade.TotalTradeMoney | number :2}}</td><td>¥ {{trade.TotalFee | number :2}}</td><td>{{trade.TotalTrades}}</td><td ng-class="trade.RealizedNet>=0?\'stock-up\':\'stock-down\'">¥ {{trade.RealizedNet | number :2}}</td></tr></tbody><tfoot><tr><td colspan="5" class="text-center"><div st-pagination="" st-items-by-page="itemsByPage" st-displayed-pages="10"></div></td></tr></tfoot></table></div></div></div></div>'),e.put("components/user/cmb_list.html",'<div class="col-lg-2" ng-repeat="user in userList"><div class="contact-box center-version"><a href="#/index/profile/{{user.userId}}/CN/FC/beta"><img alt="image" class="img-circle" src="{{usersMap[user.userId].serving_url ||\'http://www.hkfdt.cn/favicon.ico\'}}"><h3 class="m-b-xs"><strong>{{usersMap[user.userId].USERNAME}}</strong></h3><address class="m-t-md"><strong>{{usersMap[user.userId].school_name}}</strong><br><abbr title="Phone">Score:</abbr> {{user["scoresMap"]["feature"][featureSelected.key]["scores"].fdt}}</address></a></div></div>'),e.put("components/user/cmb_score.html",'<div class="row" ng-controller="CMBCtrl"><div class="wrapper wrapper-content animated fadeInRight"><img src="assets/images/cmb.png" style="width:180px;margin-bottom: 15px; margin-left: 15px;"><div class="row filterBar" ng-init="changeFt()"><div class="col-md-2"><select class="input-sm form-control input-s-sm inline product-option" ng-options="feature.name for feature in features" ng-model="featureSelected" ng-change="changeFt()"></select></div><div class="col-md-1"><input ng-model="limitList" value="10" ng-model-options="{debounce: 1000}" class="userScorelimit" ng-change="changeFt()"> Limit</div><div class="col-md-2"><input ng-model="tradeCount" value="0" class="countFilter" ng-model-options="{debounce: 1000}" ng-change="changeFt()"> Trade Count</div><div class="col-md-2"><input ng-model="loginCount" value="0" class="countFilter" ng-model-options="{debounce: 1000}" ng-change="changeFt()"> Login Count</div><div class="col-md-2"><input ng-model="unitPrice" value="0.95" class="countFilter" ng-model-options="{debounce: 1000}" ng-change="changeFt()"> Unit Price</div><div class="col-md-2"><input ng-model="mdd" value="-0.15" class="countFilter" ng-model-options="{debounce: 1000}" ng-change="changeFt()"> MDD</div></div><div ng-include="\'components/user/cmb_list.html\'"></div></div></div>'),e.put("components/user/core_user.html",'<div class="row" ng-controller="CoreUserCtrl"><div class="wrapper wrapper-content animated fadeInRight"><div class="row filterBar" ng-init="changeRegion()"><div class="col-md-2"><select class="input-sm form-control input-s-sm inline product-option" ng-options="app for app in appTypes" ng-model="appSelected" ng-change="changeSelect()"></select></div><div class="col-md-1"><select class="input-sm form-control input-s-sm inline product-option" ng-options="region for region in regions" ng-model="regionSelected" ng-change="changeRegion()"></select></div><div class="col-md-1"><select class="input-sm form-control input-s-sm inline product-option" ng-options="school.name for school in schools" ng-model="schoolSelected" ng-change="changeSelect()"></select></div><div class="col-md-1"><input ng-model="limitList" value="20" ng-model-options="{debounce: 1000}" class="userScorelimit" ng-change="changeSelect()"> Limit</div><div class="col-md-1"><a class="btn btn-white btn-bitbucket"><i class="fa fa-user-md"></i> {{totalUser}}</a></div><div class="col-md-2 btn-group pull-right"><button class="btn" ng-class="{\'btn-primary\': isActive(30), \'btn-white\': !isActive(30)}" type="button" ng-click="changeSelect(30)">30 Day</button> <button class="btn" ng-class="{\'btn-primary\': isActive(60), \'btn-white\': !isActive(60)}" type="button" ng-click="changeSelect(60)">60 Day</button> <button class="btn" ng-class="{\'btn-primary\': isActive(90), \'btn-white\': !isActive(90)}" type="button" ng-click="changeSelect(90)">90 Day</button></div></div><div ng-include="\'components/user/core_user_list.html\'"></div></div></div>'),e.put("components/user/core_user_list.html",'<div class="col-lg-2" ng-repeat="user in userList"><div class="contact-box center-version"><a href="#/index/profile/{{user.user_id}}/{{regionSelected}}/{{appSelected}}"><img alt="image" class="img-circle" src="{{usersMap[user.user_id].serving_url ||\'http://www.hkfdt.cn/favicon.ico\'}}"><h3 class="m-b-xs"><strong>{{usersMap[user.user_id].USERNAME}}</strong></h3><address class="m-t-md"><strong>{{usersMap[user.user_id].school_name|limitTo:10}}</strong><br><abbr title="Phone">Trade Life :</abbr> {{user.life}}</address></a></div></div>'),e.put("components/user/mt4_closed_list.html",'<div class="col-lg-12"><div class="ibox float-e-margins"><div class="ibox-title"><h5>Trade History</h5></div><div class="ibox-content"><div class="table-responsive"><table class="table table-striped" st-table="userClosedListDisplayed" st-safe-src="userClosedList"><thead><tr><th st-sort-default="reverse">Trade Date</th><th>Symbol</th><th>SIDE</th><th>Duration</th><th class="hidden-xs">QTY</th><th class="hidden-xs">Buy Price</th><th class="hidden-xs">Sell Price</th><th>P&L</th></tr></thead><tbody><tr ng-repeat="trade in userClosedListDisplayed"><td>{{trade.closeTime|date:\'yyyy-MM-dd\'}}</td><td>{{trade.item}}</td><td>{{trade.type}}</td><td><span>{{trade.closeTimeTs - trade.openTimeTs | amDurationFormat : \'minutes\'}}</span></td><td class="hidden-xs">{{trade.size}}</td><td class="hidden-xs">{{trade.openPrice}}</td><td class="neg-number">{{trade.closePrice}}</td><td>{{trade.profit|number:2}}</td></tr></tbody><tfoot><tr><td colspan="5" class="text-center"><div st-pagination="" st-items-by-page="itemsByPage" st-displayed-pages="7"></div></td></tr></tfoot></table></div></div></div></div>'),e.put("components/user/mt4_profile.html",'<div class="wrapper wrapper-content animated fadeInRight" ng-controller="MT4ProfileCtrl"><a target="_blank" href="http://oxfordnie.org/"><img alt="image" style="width:120px; float:right" src="assets/images/oxford_nie.png"></a><div class="row m-b-lg m-t-lg"><div class="col-md-4"><div class="profile-image"><img src="{{user.serving_url || \'http://cdn4.aptoide.com/imgs/3/7/0/37056af9e7e51c1b28de1d2f920568a4.png\'}}" class="img-circle circle-border m-b-md" alt="profile"></div><div class="profile-info"><div class=""><div><h2 class="no-margins">{{acc.name}}</h2><h4>{{user.school_name}}</h4><small><span ng-if="$root.exportShow">Contact: {{user.EMAIL }} {{user.PHONE}}</span><br>Join at: {{user.CREATED | date:\'yyyy-MM-dd\'}}<br>Last Active: {{userLastLogin.LOGINAT | date:\'yyyy-MM-dd @ h:mma\'}}<br>Country: <img width="15" ng-show="user.COUNTRY" src="http://lipis.github.io/flag-icon-css/flags/4x3/{{user.COUNTRY| lowercase}}.svg"><br></small></div></div></div><div class="row" style="margin-top: 20px;" ng-show="dateRangeChanged"><div class="pull-left" style="font-size: 10px;color: #aaa;margin-left: 25px;">Account on : {{dateRange.endDate | date:\'yyyy-MM-dd\'}}</div></div><table class="table small m-b-xs accounts-table"><tbody><tr><td><strong>{{acc.account}}</strong><div>Account No</div></td><td><strong>{{(performance.UNIT_PRICE - 1 ) * 100|number:2}}%</strong><div>ROI</div></td></tr><tr><td><strong>{{performance.ALL_TIME_PNL|number:2}}</strong><div>All Time P&L</div></td><td><strong>{{performance.CASH_DEPOSITED|number:2}}</strong><div>Cash Deposite</div></td></tr><tr><td><strong>{{acc.currency}}</strong><div>Currency</div></td><td><strong>{{acc.leverage}}</strong><div>Leverage</div></td></tr><tr><td><strong>{{acc.time}}</strong><div>Update Time</div></td><td><strong>{{acc.title}}</strong><div>Title</div></td></tr><tr><td><strong>{{performance.BiggestWin}}</strong><div>Biggest Win</div></td><td><strong>{{performance.BiggestLoss}}</strong><div>Biggest Loss</div></td></tr><tr><td><strong>{{performance.WinRatio}}%</strong><div>Win Ratio</div></td><td><strong>{{performance.TradesCount}}</strong><div>Trade Counts</div></td></tr></tbody></table><div class="col-md-12"><highchart config="chartPieConfig"></highchart></div></div><div class="col-md-8"><div class="row"><div class="col-md-6"><highchart config="chartRadarFDTScoreConfig"></highchart></div><div class="col-md-6"><highchart config="chartRadarRiskPreferenceConfig"></highchart></div><div class="col-md-6"><highchart config="chartRadarProfitConfig"></highchart></div><div class="col-md-6"><div class="col-md-6 col-md-offset-3"><h4>Risk Control Score</h4></div><div class="col-md-3"></div><br><highchart config="chartRadarConfig"></highchart></div></div><div class="row"><highchart config="chartConfig" class="user-trade-chart"></highchart></div><div class="row"><div ng-include="\'components/user/mt4_closed_list.html\'"></div></div></div></div></div>'),e.put("components/user/mt4_user.html",'<div class="row" ng-controller="MT4UserCtrl"><div class="wrapper wrapper-content animated fadeInRight ecommerce"><div class="row"><div class="col-lg-12"><div class="ibox"><div class="ibox-content"><div class="table-responsive"><table class="table table-striped" st-table="userDisplayed" st-safe-src="userList"><thead><tr><th>Title</th><th>Account Name</th><th>Account No</th><th>ROI</th><th>Currency</th><th>Leverage</th><th>File Export Time</th><th>Upload Date</th><th>Upload User</th><th>MT4 File</th></tr></thead><tbody><tr ng-repeat="user in userDisplayed"><td>{{user.title}}</td><td><a href="#/index/mt4/{{user.account}}">{{user.name}}</a></td><td>{{user.account}}</td><td>{{(user.UNIT_PRICE ? (user.UNIT_PRICE - 1 ) * 100 : 0)|number:2}}%</td><td>{{user.currency}}</td><td>{{user.leverage}}</td><td>{{user.time}}</td><td>{{user.cTime|date:\'yyyy-MM-dd\'}}</td><td>{{user.uploadUser}}</td><td><a ng-if="user.filename" href="downloadMT4File?filename={{user.filename}}" class="btn btn-primary" style="padding: 2px 6px;"><i class="fa fa-download"></i></a></td></tr></tbody><tfoot><tr><td colspan="5" class="text-center"><div st-pagination="" st-items-by-page="itemsByPage" st-displayed-pages="7"></div></td></tr></tfoot></table></div></div></div></div></div></div></div>'),e.put("components/user/user_closed_list.html",'<div class="col-lg-12"><div class="ibox float-e-margins"><div class="ibox-title"><h5>Trade History</h5><div class="ibox-tools" ng-if="$root.exportShow"><button type="button" class="btn btn-outline btn-primary" ng-if="selectTradeDates" ng-click="tradeDateCancelClick()">{{selectTradeDates}} <i class="fa fa-times"></i></button> <a type="button" class="btn btn-sm btn-primary" href="{{historyFilePath}}" download="{{historyFileName}}">Export</a></div></div><div class="ibox-content"><div class="table-responsive"><table class="table table-striped" st-table="userClosedListDisplayed" st-safe-src="userClosedList"><thead><tr><th>Trade Date</th><th>Symbol</th><th>SIDE</th><th>Duration</th><th class="hidden-xs">QTY</th><th class="hidden-xs">Buy Price</th><th class="hidden-xs">Sell Price</th><th>P&L</th></tr></thead><tbody><tr ng-repeat="trade in userClosedListDisplayed"><td>{{trade.TRADE_DATE|date:\'yyyy-MM-dd\'}}</td><td>{{trade.SYMBOL}}</td><td>{{sideMap[trade.ObjId]["side"]}}</td><td><span ng-if="sideMap[trade.ObjId]">{{(trade.CREATED - sideMap[trade.ObjId]["ts"]) | amDurationFormat : \'minutes\'}}</span></td><td class="hidden-xs">{{trade.QTY|number}}</td><td class="hidden-xs">{{trade.BUY_PRICE}}</td><td class="neg-number">{{trade.SELL_PRICE}}</td><td>{{trade.AC_PNL|number:2}}</td></tr></tbody><tfoot><tr><td colspan="5" class="text-center"><div st-pagination="" st-items-by-page="itemsByPage" st-displayed-pages="7"></div></td></tr></tfoot></table></div></div></div></div>'),e.put("components/user/user_profile.html",'<div class="wrapper wrapper-content animated fadeInRight" ng-hide="$root.simShow || $root.ftShow"><h3>No access for this account</h3></div><div class="wrapper wrapper-content animated fadeInRight" ng-controller="UserProfileCtrl" ng-if="$root.simShow || $root.ftShow"><div class="row"><div class="col-md-3" ng-hide="hasUserId"><div class="input-group"><input type="text" class="form-control" ng-model="inputUserId" placeholder="Please enter fdt user id or user name"> <span class="input-group-btn"><button type="button" class="btn btn-primary" ng-click="loadData()">Go!</button></span></div></div><div class="col-md-1" ng-hide="hasUserId"><select class="input-sm form-control input-s-sm inline product-option" ng-options="product.name for product in products" ng-model="productSelected"></select></div><div class="col-md-1" ng-hide="hasUserId"><select class="input-sm form-control input-s-sm inline product-option" ng-options="region.name for region in regions" ng-model="regionSelected"></select></div><div class="col-md-2 form-group pull-right" id="data_1"><div class="input-group date"><span class="input-group-addon"><i class="fa fa-calendar"></i></span> <input singledatepicker="true" type="daterange" class="form-control date-selector" ng-change="loadData(); dateRangeChanged=true" ng-model="dateRange"></div></div></div><a target="_blank" href="http://oxfordnie.org/"><img alt="image" style="width:120px; float:right" src="assets/images/oxford_nie.png"></a><div class="row m-b-lg m-t-lg"><div class="col-md-4"><div class="profile-image" style="text-align: center"><img src="{{user.serving_url || \'http://www.hkfdt.cn/favicon.ico\'}}" class="img-circle circle-border m-b-md" alt="profile"> <a ng-click="loadData(true)" type="button" class="btn btn-primary dim" style="margin-top: -25px;width: 60px;height: 25px;padding: 5px;font-size: 10px;"><i ng-class="refresh?\'fa-spin\':\'\'" class="fa fa-refresh"></i></a></div><div class="profile-info"><div class=""><div><h2 class="no-margins">{{user.USERNAME}} <a style="margin-left: 20px;padding: 2px;font-size: 10px;" ng-hide="accFirstDate-joinDate < 1000*60*60*24*2" class="btn btn-default" href="#">Reset @{{accFirstDate| date:\'yyyy-MM-dd\'}}</a></h2><h4>{{user.school_name}}</h4><small><span ng-if="$root.exportShow">Contact: {{user.EMAIL }} {{user.PHONE}}</span><br>Join at: {{user.CREATED | date:\'yyyy-MM-dd\'}}<br>Last Active: {{userLastLogin.LOGINAT | date:\'yyyy-MM-dd @ h:mma\'}}<br>Country: <img width="15" ng-show="user.COUNTRY" src="http://lipis.github.io/flag-icon-css/flags/4x3/{{user.COUNTRY| lowercase}}.svg"><br></small></div></div></div><div class="row" style="margin-top: 20px;" ng-show="dateRangeChanged"><div class="pull-left" style="font-size: 10px;color: #aaa;margin-left: 25px;">Account on : {{dateRange.endDate | date:\'yyyy-MM-dd\'}}</div></div><table class="table small m-b-xs accounts-table" ng-hide="seedsc"><tbody><tr><td><strong>{{acc.CASH + acc.UR_PNL | currency:"$"}}</strong><div>Account Value</div></td><td><strong>{{acc.CASH | currency:"$"}}</strong><div>Cash Value</div></td></tr><tr><td><strong ng-show="acc.UNIT_PRICE">{{(acc.UNIT_PRICE - 1 ) * 100|number:2}}%</strong><div>ROI</div></td><td><strong>{{acc.TradesCount}}</strong><div>Total Trades</div></td></tr><tr><td><strong>{{acc.Ranking}}</strong><div>Ranking</div></td><td><strong>{{acc.RankingPer}}%</strong><div>Ranking Percentage</div></td></tr><tr><td><strong>{{acc.BiggestWin}}</strong><div>Biggest Win</div></td><td><strong>{{acc.BiggestLoss}}</strong><div>Biggest Loss</div></td></tr><tr><td><strong>{{acc.WinRatio}}%</strong><div>Win Ratio</div></td><td><strong>{{acc.CASH_AVAILABLE | currency:"$"}}</strong><div>Available Cash</div></td></tr><tr ng-show="userSetting"><td><strong>{{userSetting.DEFAULT_QTY}}</strong><div>Quick Trade QTY</div></td><td><strong>{{userSetting.STOP_LOSS_VALUE | currency:"$"}}</strong><div>Position Stop Loss</div></td></tr><tr ng-show="userSetting"><td><strong>{{userSetting.DAILY_STOPLOSS | currency:"$"}}</strong><div>Daily Stop Loss</div></td><td><strong>{{userSetting.TRAILING_STOP }}</strong><div>Trailing Stop</div></td></tr></tbody></table><highchart config="chartLoginConfig" class="user-roi-chart" ng-hide="seedsc"></highchart><highchart config="chartPNLConfig" class="user-roi-chart"></highchart><highchart style="margin-top: 40px;" config="chartCommisionConfig" class="user-roi-chart" ng-show="seedsc"></highchart><highchart config="chartRollPriceConfig" class="user-roi-chart" ng-hide="seedsc"></highchart><highchart config="chartTradeCountConfig" class="user-roi-chart" ng-hide="seedsc"></highchart><highchart config="chartValueConfig" class="user-roi-chart" ng-hide="seedsc"></highchart><highchart config="chartRankingConfig" class="user-roi-chart" ng-hide="seedsc"></highchart><div class="table-responsive" ng-show="seedsc" style="margin-top: 50px;"><h3 style="text-align:center; margin-bottom: 20px;">Top Traded Symbols (by Acounmt)</h3><table class="table table-striped"><thead><tr><th class="hidden-xs">Symbol</th><th class="hidden-xs">Total Amount</th></tr></thead><tbody><tr ng-repeat="sy in stats_pos"><td>{{sy.symbol}}</td><td>{{sy.total_volumn |number: 2}}</td></tr></tbody></table></div><div class="table-responsive" ng-show="seedsc"><h3 style="text-align:center; margin-bottom: 20px;">Top Traded Symbols (by pnl/position)</h3><table class="table table-striped"><thead><tr><th class="hidden-xs">Symbol</th><th class="hidden-xs">Efficiency</th></tr></thead><tbody><tr ng-repeat="sy in stats_pnl"><td ng-class="sy.total_eff<0?\'table-danger\' : \'\'">{{sy.symbol}}</td><td ng-class="sy.total_eff<0?\'table-danger\' : \'\'">{{sy.total_eff | number : 6}}</td></tr></tbody></table></div></div><div class="col-md-8"><div class="row"><div ng-class="beta?\'col-md-6\' :\'col-md-12\'"><highchart config="chartRadarFDTScoreConfig" ng-hide="seedsc"></highchart><highchart config="chartSeedSCScoreConfig" ng-show="seedsc"></highchart></div><div class="col-md-6" ng-if="beta"><highchart config="chartRadarActivityConfig" ng-hide="seedsc"></highchart><highchart config="chartSeedStyleScoreConfig" ng-show="seedsc"></highchart></div><div class="col-md-6" ng-show="beta&&!seedsc"><highchart config="chartRadarProfitConfig"></highchart></div><div class="col-md-6" ng-show="beta&&!seedsc"><br><highchart config="chartRadarConfig"></highchart></div></div><div class="row"><highchart config="chartConfig" class="user-trade-chart"></highchart></div><div class="row"><highchart config="chartTradesConfig" class="user-trade-chart"></highchart></div><div class="row"><div ng-include="\'components/user/user_closed_list.html\'"></div></div><div class="col-md-6"><highchart config="chartPieConfig"></highchart></div><div class="col-md-6" ng-hide="region==\'SEED\' || region==\'INC\' || region==\'SEEDSC\'"><div class="table-responsive"><table class="table table-striped"><thead><tr><th class="hidden-xs">Joined Contests</th><th class="hidden-xs">ROI</th><th class="hidden-xs">FDT Score</th></tr></thead><tbody><tr ng-repeat="contest in contestScoresList"><td><a href="#/index/profile/{{contest.contestId}}_1_*1_*1_{{user.USERID}}/{{db}}/{{app}}/beta">{{contests[contest.contestId].name}}</a></td><td>{{(contest.ft_up.raw -1) *100|number :2}}%</td><td>{{contest.fdt.score|number :3}}</td></tr></tbody></table></div></div></div></div></div>'),e.put("components/user/user_score.html",'<div class="row" ng-controller="UserScoreCtrl"><div class="wrapper wrapper-content animated fadeInRight"><div class="row filterBar" ng-init="initProd()"><div class="col-md-3"><ui-select style="width:100%" ng-model="contestSelected" on-select="changeFt($item)" theme="select2" title="Choose a Region"><ui-select-match placeholder="Select or search Region ...">{{$select.selected.name}}</ui-select-match><ui-select-choices repeat="contest in contests | filter: $select.search"><div><img width="50" ng-if="contest.icon_image" src="{{contest.icon_image}}"> <span ng-bind-html="contest.name | highlight: $select.search"></span></div></ui-select-choices></ui-select></div><div class="col-md-2"><select class="input-sm form-control input-s-sm inline product-option" ng-options="wt for wt in weightFiles" ng-model="weightSelected" ng-change="changeFt()"></select></div><div class="col-md-1"><input ng-model="limitList" value="10" ng-model-options="{debounce: 1000}" class="userScorelimit" ng-change="changeFt()"> Limit</div><div class="col-md-2"><input style="margin-top:15px" type="checkbox" ng-model="incubatee" ng-change="changeFt()"> {{contestSelected.region == "SEEDSC"? "Live Trader" : "Incu Candidate"}}</div><div class="col-md-3" style="margin-top: 10px;"><a href="{{downLoadUrl}}" type="button" class="btn btn-success dim ng-click-active" style="width: 40px;height: 25px;padding: 1px 0 5px 0;font-size: 15px; margin-right: 5px;"><i class="fa fa-cloud-download"></i></a> <a ng-hide=\'contestSelected.region == "SEEDSC"\' ng-click="distShow=!distShow;changeFt()" type="button" class="btn btn-primary dim ng-click-active" style="width: 40px;height: 25px;padding: 1px 0 5px 0;font-size: 15px; margin-right: 5px;"><i ng-class="distShow?\'fa-th-list\':\'fa-bar-chart\'" class="fa"></i></a> <span style="font-size: 10px;color: #aaa;">Score update @ {{userList[0].ts| date:"yyyy-MM-dd h:mma" : \'UTC\' }}</span></div></div><div class="row"><div class="col-lg-9" ng-include="\'components/user/user_score_list.html\'" style="margin-top: -15px;" ng-hide="distShow"></div><div class="col-lg-9" style="margin-top: -15px;" ng-show="distShow"><div class="col-lg-6" ng-repeat="chart in fts"><highchart config="chart.chartObj" class="user-roi-chart"></highchart></div></div><div class="col-lg-3" ng-hide="distShow"><highchart config="chartScoreDistConfig" class="user-roi-chart"></highchart><highchart config="chartProfDistConfig" class="user-roi-chart" ng-hide="contestSelected.region == \'SEEDSC\'"></highchart><highchart config="chartRiskDistConfig" class="user-roi-chart" ng-hide="contestSelected.region == \'SEEDSC\'"></highchart><highchart config="chartConsiDistConfig" class="user-roi-chart" ng-hide="contestSelected.region == \'SEEDSC\'"></highchart><highchart config="chartActDistConfig" class="user-roi-chart" ng-hide="contestSelected.region == \'SEEDSC\'"></highchart></div></div></div></div>'),e.put("components/user/user_score_list.html",'<div class="col-lg-3" ng-repeat="user in userList" style="height: 280px; margin-top: 40px;"><div class="contact-box center-version"><a target="_blank" href="#/index/profile/{{contestSelected.contestID? contestSelected.contestID + \'_1_*1_*1_\' + user.user_id : user.user_id}}/{{contestSelected.region}}/{{user.prod| uppercase}}/beta"><img alt="image" class="img-circle" src="{{usersMap[user.user_id].serving_url ||\'http://www.hkfdt.cn/favicon.ico\'}}"><h3 class="m-b-xs"><strong>{{usersMap[user.user_id].USERNAME}}</strong></h3><div class="row"><strong>{{usersMap[user.user_id].school_name}}</strong><br><img ng-show="usersMap[user.user_id].COUNTRY" src="http://lipis.github.io/flag-icon-css/flags/4x3/{{usersMap[user.user_id].COUNTRY| lowercase}}.svg" style="width: 25px;height: 20px;padding: 0px;margin: 5px 0 0 0;"><h2>{{user[featureSelected].score |number:2 }}</h2><div class="col-lg-4" style="border-right: 1px solid #eee;">{{ (user.ft_up.raw - 1) * 100 |number :2}} %<br><span class="visible-lg-block" style="font-size: 8px; color: #aaa;">ROI</span></div><div class="col-lg-4" style="border-right: 1px solid #eee;">{{user.ft_shp_rt.raw |number :2}}<br><span class="visible-lg-block" style="font-size: 8px; color: #aaa;">Sharp Ratio</span></div><div class="col-lg-4" title="Max Drop Down">{{ (user.ft_mdd.raw) * (-100) |number :2 }} %<br><span class="visible-lg-block" style="font-size: 8px; color: #aaa;">MDD</span></div></div><span ng-show="user.arena_tg==\'former_incubatee\'" class="former-incu">Former</span> <span class="ranking-number">{{$index+1}}</span></a></div></div>')
}]);